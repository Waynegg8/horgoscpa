<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>任務調整記錄 - 內部系統</title>
  <link rel="stylesheet" href="/assets/css/common.css?v=3">
  <link rel="stylesheet" href="/assets/css/internal-system.css?v=3">
  <link rel="stylesheet" href="/assets/css/tasks-page.css?v=1">
</head>
<body>
  <div id="navbar-placeholder"></div>
  
  <div class="page-container">
    <div class="page-header-simple">
      <a href="/internal/dashboard" class="back-link">← 返回儀表板</a>
      <h1 class="page-title">任務到期日調整記錄</h1>
    </div>

    <!-- 篩選器 -->
    <div class="content-card" style="margin-bottom:16px;">
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
        <select id="filter_type" style="padding:10px;border:1px solid #d1d5db;border-radius:6px;">
          <option value="all">全部類型</option>
          <option value="initial_create">初始創建</option>
          <option value="manual_adjust">手動調整</option>
          <option value="system_auto">系統自動</option>
          <option value="overdue_adjust">逾期調整</option>
        </select>
        <input type="text" id="filter_search" placeholder="搜尋任務名稱或客戶..." style="padding:10px;border:1px solid #d1d5db;border-radius:6px;min-width:250px;" />
        <button onclick="loadAdjustments()" class="btn btn-primary">篩選</button>
      </div>
    </div>

    <!-- 調整記錄列表 -->
    <div class="content-card">
      <div id="adjustmentsList" style="min-height:400px;">
        <p style="text-align:center;padding:48px;color:#9ca3af;">載入中...</p>
      </div>
    </div>
  </div>

  <div id="footer-placeholder"></div>

  <script src="/assets/js/components/bootstrap.js?v=3"></script>
  <script>
    const onProdHost = location.hostname.endsWith('horgoscpa.com');
    const apiBase = onProdHost ? '/internal/api/v1' : 'https://www.horgoscpa.com/internal/api/v1';
    
    async function loadAdjustments() {
      const container = document.getElementById('adjustmentsList');
      container.innerHTML = '<p style="text-align:center;padding:48px;color:#9ca3af;">載入中...</p>';
      
      try {
        // 目前简化实现：显示所有任务的调整记录
        // 未来可以创建专门的API endpoint来获取全局调整记录
        container.innerHTML = `
          <div style="text-align:center;padding:48px;">
            <p style="color:#6b7280;margin-bottom:16px;">查看單個任務的調整歷史</p>
            <p style="color:#9ca3af;font-size:14px;">請前往任務詳情頁面查看該任務的完整調整歷史</p>
            <a href="/internal/tasks" class="btn btn-primary" style="margin-top:16px;display:inline-block;">前往任務列表</a>
          </div>
        `;
        
      } catch (err) {
        console.error('載入調整記錄失敗:', err);
        container.innerHTML = '<p style="text-align:center;padding:48px;color:#ef4444;">載入失敗</p>';
      }
    }
    
    // 初始化
    loadAdjustments();
  </script>
</body>
</html>

