# 數據表清單

**系統所有資料表一覽**

---

## 📊 資料表總覽（45個）

### 核心業務（6個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `Users` | 員工 | 存儲員工帳號、姓名、角色 |
| `Clients` | 客戶 | 存儲客戶公司資料 |
| `TimeLogs` | 工時記錄 | 記錄每天的工作時間 |
| `LeaveApplications` | 假期記錄 | 記錄請假申請 |
| `CustomerTags` | 客戶標籤 | 標籤名稱（VIP、長期合作等）|
| `ClientTagAssignments` | 標籤關聯 | 客戶與標籤的關聯 |

### 服務與任務（6個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `Services` | 服務項目 | 定義服務類型（記帳、工商登記等）|
| `ClientServices` | 客戶服務 | 記錄客戶訂閱的服務 |
| `TaskTemplates` | 任務模板 | 定義可重複使用的任務流程 |
| `TaskStageTemplates` | 任務階段模板 | 定義任務模板中的階段 |
| `ActiveTasks` | 執行中任務 | 當前正在執行的任務 |
| `ActiveTaskStages` | 任務階段 | 任務的各個階段進度 |

### 假期規則（6個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `LeaveTypes` | 假別類型 | 定義假別（特休、病假等）|
| `AnnualLeaveRules` | 特休規則 | 年資與特休天數對應 |
| `AnnualLeaveBalance` | 特休餘額 | 員工特休餘額（累積制）|
| `OtherLeaveRules` | 其他假期規則 | 婚假、喪假等規則 |
| `LifeEventLeaveGrants` | 生活事件假期額度 | 追蹤婚假、喪假等的餘額和有效期 ⭐ |
| `Holidays` | 國定假日 | 每年的國定假日 |

### 加班規則（2個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `WorkTypes` | 工作類型 | 正常工時、加班等 |
| `OvertimeRates` | 加班費率 | 不同工作類型的費率倍數 |

### 知識與內容（7個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `SOPDocuments` | SOP文件 | 標準作業流程文件 |
| `ClientSOPLinks` | 客戶SOP關聯 | 客戶專屬SOP |
| `KnowledgeArticles` | 知識庫 | 內部知識文章 |
| `ExternalArticles` | 外部文章 | 公開網站文章 |
| `ExternalFAQ` | 外部FAQ | 公開網站常見問題 |
| `ResourceCenter` | 資源中心 | 可下載的文件 |
| `ExternalImages` | 外部圖片 | 公開網站圖片資源 |

### 系統設定（7個）
| 表名 | 中文名稱 | 用途 |
|------|---------|------|
| `ServiceFrequencyTypes` | 週期類型 | 每月、雙月、每季等 |
| `CompensatoryLeave` | 補休餘額 | 員工的補休時數 |
| `CompensatoryLeaveUsage` | 補休使用記錄 | 記錄補休使用歷史（FIFO）|
| `CronJobExecutions` | 定時任務執行記錄 | 記錄自動任務執行狀態 |
| `Notifications` | 系統通知 | 儀表板提醒（工時缺填等）⭐ |
| `Settings` | 系統設定 | 各種系統參數（⚠️ 需初始化預設值）|
| `AuditLogs` | 操作日誌 | 記錄誰做了什麼 |

**⚠️ Settings 表必須初始化的預設資料：**
```sql
INSERT INTO Settings (setting_key, setting_value, description, is_dangerous) VALUES
('comp_leave_expiry_rule', 'current_month', '補休有效期規則（current_month/next_month/3_months/6_months）', 1),
('daily_work_hours_limit', '12', '每日工時上限（勞基法規定，不可修改）', 1),
('hourly_wage_base', '240', '月薪制換算時數（勞基法規定，不可修改）', 1),
('company_name', '霍爾果斯會計師事務所', '公司名稱', 0),
('contact_email', 'contact@horgoscpa.com', '聯絡信箱', 0);
```

說明：
- `is_dangerous = 1`：危險設定，修改前需管理員確認（如：補休有效期）
- `is_dangerous = 1` 且勞基法規定：僅供查看，UI 應禁止修改（如：工時上限12小時、時薪換算240小時）

---

## 🔗 關聯關係

```
Users (員工)
  ├─→ TimeLogs (工時記錄)
  ├─→ LeaveApplications (假期記錄)
  ├─→ Clients (負責的客戶)
  └─→ ActiveTasks (負責的任務)

Clients (客戶)
  ├─→ ClientServices (訂閱的服務)
  ├─→ ClientTagAssignments (客戶標籤)
  └─→ ClientSOPLinks (專屬SOP)

ClientServices (客戶服務)
  └─→ ActiveTasks (自動生成的任務)

ActiveTasks (任務)
  └─→ ActiveTaskStages (任務階段)
```

---

## 💡 快速查找

**想知道某個數據存在哪裡？**

- **員工資料** → Users
- **客戶資料** → Clients
- **工時記錄** → TimeLogs
- **請假記錄** → LeaveApplications
- **假期餘額** → 即時計算（不儲存）
- **補休餘額** → CompensatoryLeave
- **任務** → ActiveTasks
- **客戶標籤** → CustomerTags + ClientTagAssignments

---

**詳細資料表結構請見各開發指南中的完整規格文檔。**

