# ä¸€è‡´æ€§éªŒè¯æ–¹æ³•

**ç›®çš„ï¼š** ç¡®ä¿æ‰€æœ‰æ–‡æ¡£çš„ä¸€è‡´æ€§ï¼Œä¸ä¾èµ–ç¡¬ç¼–ç æ•°å­—

**æ ¸å¿ƒåŸåˆ™ï¼šå•ä¸€çœŸç›¸æºï¼ˆSSOT - Single Source of Truthï¼‰**

---

## ğŸ“Œ å•ä¸€çœŸç›¸æºï¼ˆSSOTï¼‰

### å®šä¹‰
**åªåœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰çœŸç›¸ï¼Œå…¶ä»–æ‰€æœ‰åœ°æ–¹éƒ½å¿…é¡»ä¸å®ƒä¸€è‡´ã€‚**

### çœŸç›¸æºæ–‡ä»¶

| æ•°æ®ç±»å‹ | çœŸç›¸æºæ–‡ä»¶ | è¯´æ˜ |
|---------|----------|------|
| èµ„æ–™è¡¨æ€»æ•° | `ç³»çµ±è³‡æ–™/æ•¸æ“šè¡¨æ¸…å–®.md` | å”¯ä¸€å®šä¹‰èµ„æ–™è¡¨æ•°é‡çš„åœ°æ–¹ |
| APIæ€»æ•° | `ç³»çµ±è³‡æ–™/APIæ¸…å–®.md` | å”¯ä¸€å®šä¹‰APIæ•°é‡çš„åœ°æ–¹ |
| åŠŸèƒ½åˆ—è¡¨ | `å®Œæ•´åŠŸèƒ½æ¸…å–®.md` | æ‰€æœ‰åŠŸèƒ½çš„å®Œæ•´åˆ—è¡¨ |

### éªŒè¯åŸåˆ™

**å½“ä½ ä¿®æ”¹æ•°å­—æ—¶ï¼š**
1. âœ… **åªåœ¨SSOTæ–‡ä»¶ä¸­ä¿®æ”¹**
2. âœ… **æ£€æŸ¥æ‰€æœ‰å…¶ä»–æ–‡æ¡£æ˜¯å¦ä¸SSOTä¸€è‡´**
3. âœ… **å¦‚æœä¸ä¸€è‡´ï¼Œæ›´æ–°å®ƒä»¬**

**ç¤ºä¾‹ï¼šæ–°å¢ä¸€ä¸ªèµ„æ–™è¡¨**
```
1. åœ¨ æ•¸æ“šè¡¨æ¸…å–®.md ä¸­ï¼š
   - æ·»åŠ æ–°è¡¨çš„å®šä¹‰
   - æ›´æ–°æ€»æ•°ï¼š28å€‹ â†’ 29å€‹

2. æ£€æŸ¥ä»¥ä¸‹æ–‡ä»¶ï¼Œç¡®ä¿æ•°å­—ä¸€è‡´ï¼š
   - docs/README.md
   - é–‹ç™¼æŒ‡å—/README.md  
   - å®Œæ•´åŠŸèƒ½æ¸…å–®.md
   - æ‰€æœ‰æåˆ°èµ„æ–™è¡¨æ•°é‡çš„æ–‡æ¡£

3. ä½¿ç”¨æœç´¢éªŒè¯ï¼š
   grep -r "28å€‹.*è¡¨" docs/
   â†’ ä¸åº”è¯¥æœ‰ä»»ä½•ç»“æœ
```

---

## ğŸ” éªŒè¯æ–¹æ³•

### æ–¹æ³•1ï¼šæ£€æŸ¥æ•°å­—ç»Ÿè®¡æ˜¯å¦ä¸€è‡´

```bash
# Windows PowerShell
$tables = @()
$apis = @()

# æå–æ‰€æœ‰æåˆ°"è¡¨"çš„æ•°å­—
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | ForEach-Object {
    $content = Get-Content $_.FullName -Raw
    if ($content -match '(\d+)\s*å€‹.*?è¡¨') {
        $tables += @{File=$_.Name; Count=$matches[1]}
    }
    if ($content -match '(\d+)\s*å€‹.*?API') {
        $apis += @{File=$_.Name; Count=$matches[1]}
    }
}

# æ£€æŸ¥æ˜¯å¦æ‰€æœ‰æ•°å­—ä¸€è‡´
$tableCount = $tables | Select-Object -ExpandProperty Count -Unique
$apiCount = $apis | Select-Object -ExpandProperty Count -Unique

if ($tableCount.Count -gt 1) {
    Write-Host "âŒ èµ„æ–™è¡¨æ•°å­—ä¸ä¸€è‡´ï¼" -ForegroundColor Red
    $tables | Format-Table
} else {
    Write-Host "âœ… èµ„æ–™è¡¨æ•°å­—ä¸€è‡´ï¼š$tableCount å€‹" -ForegroundColor Green
}

if ($apiCount.Count -gt 1) {
    Write-Host "âŒ APIæ•°å­—ä¸ä¸€è‡´ï¼" -ForegroundColor Red
    $apis | Format-Table
} else {
    Write-Host "âœ… APIæ•°å­—ä¸€è‡´ï¼š$apiCount å€‹" -ForegroundColor Green
}
```

---

### æ–¹æ³•2ï¼šéªŒè¯å•ä¸€çœŸç›¸æºï¼ˆSSOTï¼‰

**åŸåˆ™ï¼š** åªåœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰çœŸç›¸ï¼Œå…¶ä»–åœ°æ–¹éƒ½å¼•ç”¨å®ƒ

**å•ä¸€çœŸç›¸æºæ–‡ä»¶ï¼š**
- `ç³»çµ±è³‡æ–™/æ•¸æ“šè¡¨æ¸…å–®.md` - å”¯ä¸€å®šä¹‰èµ„æ–™è¡¨æ€»æ•°çš„åœ°æ–¹
- `ç³»çµ±è³‡æ–™/APIæ¸…å–®.md` - å”¯ä¸€å®šä¹‰APIæ€»æ•°çš„åœ°æ–¹

**éªŒè¯è„šæœ¬ï¼š**
```bash
# 1. ä»SSOTæ–‡ä»¶ä¸­æå–çœŸç›¸
$tableFile = Get-Content "docs\ç³»çµ±è³‡æ–™\æ•¸æ“šè¡¨æ¸…å–®.md" -Raw
$apiFile = Get-Content "docs\ç³»çµ±è³‡æ–™\APIæ¸…å–®.md" -Raw

$tableFile -match 'è³‡æ–™è¡¨ç¸½è¦½[ï¼ˆ(](\d+)å€‹[ï¼‰)]'
$truthTables = $matches[1]

$apiFile -match 'ç¸½è¨ˆ[ï¼š:]\s*ç´„?\s*(\d+)\s*å€‹'
$truthAPIs = $matches[1]

Write-Host "å–®ä¸€çœŸç›¸æºï¼š"
Write-Host "  è³‡æ–™è¡¨ï¼š$truthTables å€‹" -ForegroundColor Cyan
Write-Host "  APIï¼š$truthAPIs å€‹" -ForegroundColor Cyan

# 2. æ£€æŸ¥å…¶ä»–æ–‡ä»¶æ˜¯å¦ä¸SSOTä¸€è‡´
$errors = @()

Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | ForEach-Object {
    if ($_.Name -notlike "*æ•¸æ“šè¡¨æ¸…å–®.md" -and $_.Name -notlike "*APIæ¸…å–®.md") {
        $content = Get-Content $_.FullName -Raw
        
        # æ£€æŸ¥è¡¨çš„æ•°å­—
        if ($content -match '(\d+)\s*å€‹.*?è¡¨') {
            if ($matches[1] -ne $truthTables) {
                $errors += "$($_.Name): è¡¨æ•°å­— $($matches[1]) â‰  $truthTables"
            }
        }
        
        # æ£€æŸ¥APIçš„æ•°å­—
        if ($content -match '(\d+)\s*å€‹.*?API') {
            if ($matches[1] -ne $truthAPIs) {
                $errors += "$($_.Name): APIæ•°å­— $($matches[1]) â‰  $truthAPIs"
            }
        }
    }
}

if ($errors.Count -eq 0) {
    Write-Host "`nâœ… æ‰€æœ‰æ–‡æ¡£ä¸å•ä¸€çœŸç›¸æºä¸€è‡´ï¼" -ForegroundColor Green
} else {
    Write-Host "`nâŒ å‘ç° $($errors.Count) ä¸ªä¸ä¸€è‡´ï¼š" -ForegroundColor Red
    $errors | ForEach-Object { Write-Host "  $_" -ForegroundColor Yellow }
}
```

---

### æ–¹æ³•3ï¼šéªŒè¯äº¤å‰å¼•ç”¨å¯¹ç§°æ€§

```bash
# æ£€æŸ¥æ‰€æœ‰"ç›¸é—œåŠŸèƒ½"çš„åŒå‘å¼•ç”¨
$files = Get-ChildItem -Path "docs\ä½¿ç”¨æ‰‹å†Š" -Filter "*.md"
$references = @{}

foreach ($file in $files) {
    $content = Get-Content $file.FullName -Raw
    $name = $file.BaseName
    
    # æå–æ‰€æœ‰å¼•ç”¨
    $matches = [regex]::Matches($content, '\[([^\]]+)\]\(\./([^\)]+)\.md\)')
    $refs = $matches | ForEach-Object { $_.Groups[2].Value }
    
    $references[$name] = $refs
}

# æ£€æŸ¥å¯¹ç§°æ€§
$asymmetric = @()
foreach ($source in $references.Keys) {
    foreach ($target in $references[$source]) {
        # å¦‚æœAå¼•ç”¨Bï¼Œæ£€æŸ¥Bæ˜¯å¦å¼•ç”¨A
        if ($references.ContainsKey($target)) {
            if ($references[$target] -notcontains $source) {
                $asymmetric += "$source â†’ $target (ä½† $target æ²¡æœ‰å¼•ç”¨ $source)"
            }
        }
    }
}

if ($asymmetric.Count -eq 0) {
    Write-Host "âœ… æ‰€æœ‰äº¤å‰å¼•ç”¨éƒ½æ˜¯å¯¹ç§°çš„ï¼" -ForegroundColor Green
} else {
    Write-Host "âŒ å‘ç° $($asymmetric.Count) ä¸ªä¸å¯¹ç§°å¼•ç”¨ï¼š" -ForegroundColor Red
    $asymmetric | ForEach-Object { Write-Host "  $_" -ForegroundColor Yellow }
}
```

---

### æ–¹æ³•4ï¼šéªŒè¯æ ¼å¼ä¸€è‡´æ€§

```bash
# æ£€æŸ¥åŒç±»æ–‡æ¡£æ˜¯å¦ä½¿ç”¨ç›¸åŒçš„ç« èŠ‚ç»“æ„
$specs = Get-ChildItem -Path "docs\é–‹ç™¼æŒ‡å—" -Filter "*-å®Œæ•´è¦æ ¼.md"
$structures = @{}

foreach ($spec in $specs) {
    $content = Get-Content $spec.FullName
    $headers = $content | Where-Object { $_ -match '^##\s+' } | ForEach-Object { $_ -replace '^##\s+', '' }
    $structures[$spec.Name] = $headers -join "|"
}

# æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å®Œæ•´è§„æ ¼éƒ½æœ‰ç›¸åŒçš„ç»“æ„
$uniqueStructures = $structures.Values | Select-Object -Unique

if ($uniqueStructures.Count -eq 1) {
    Write-Host "âœ… æ‰€æœ‰å®Œæ•´è§„æ ¼æ–‡æ¡£ç»“æ„ä¸€è‡´ï¼" -ForegroundColor Green
} else {
    Write-Host "âŒ å®Œæ•´è§„æ ¼æ–‡æ¡£ç»“æ„ä¸ä¸€è‡´ï¼š" -ForegroundColor Red
    $structures.GetEnumerator() | ForEach-Object {
        Write-Host "  $($_.Key): $($_.Value)" -ForegroundColor Yellow
    }
}
```

---

## ğŸ§ª æ‰‹åŠ¨éªŒè¯æ­¥éª¤ï¼ˆAIå¿…é¡»æ‰§è¡Œï¼‰

### æ­¥éª¤1ï¼šæå–SSOTçœŸç›¸

```powershell
# 1. æŸ¥çœ‹èµ„æ–™è¡¨çœŸç›¸æº
Get-Content "docs\ç³»çµ±è³‡æ–™\æ•¸æ“šè¡¨æ¸…å–®.md" | Select-String "è³‡æ–™è¡¨ç¸½è¦½"
# è¾“å‡ºï¼š## ğŸ“Š è³‡æ–™è¡¨ç¸½è¦½ï¼ˆ49å€‹ï¼‰
# â†’ çœŸç›¸ï¼š49å€‹

# 2. æŸ¥çœ‹APIçœŸç›¸æº  
Get-Content "docs\ç³»çµ±è³‡æ–™\APIæ¸…å–®.md" | Select-String "ç¸½è¨ˆ"
# è¾“å‡ºï¼š**ç¸½è¨ˆï¼šç´„ 147 å€‹ API ç«¯é»**
# â†’ çœŸç›¸ï¼š147å€‹
```

### æ­¥éª¤2ï¼šæœç´¢æ‰€æœ‰æåˆ°çš„æ•°å­—

```powershell
# æœç´¢æ‰€æœ‰æåˆ°"è¡¨"æ•°å­—çš„åœ°æ–¹
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | Select-String "å€‹.*è¡¨" | Where-Object { $_.Line -match '\d+å€‹' }

# æœç´¢æ‰€æœ‰æåˆ°"API"æ•°å­—çš„åœ°æ–¹
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | Select-String "å€‹.*API" | Where-Object { $_.Line -match '\d+å€‹' }
```

### æ­¥éª¤3ï¼šæ£€æŸ¥ä¸€è‡´æ€§

**æ‰€æœ‰ç»“æœéƒ½å¿…é¡»ä¸SSOTä¸€è‡´ï¼**
- å¦‚æœçœ‹åˆ°ä¸åŒçš„æ•°å­—ï¼ˆå¦‚ï¼š45å€‹è¡¨ã€98å€‹APIï¼‰ï¼Œç«‹å³ä¿®å¤
- ç›´åˆ°æ‰€æœ‰æ•°å­—éƒ½ä¸€è‡´ï¼ˆ49å€‹è¡¨ã€147å€‹APIï¼‰

### æ­¥éª¤4ï¼šéªŒè¯äº¤å‰å¼•ç”¨

```powershell
# æ£€æŸ¥ä½¿ç”¨æ‰‹å†Šä¸­çš„äº¤å‰å¼•ç”¨
Get-ChildItem "docs\ä½¿ç”¨æ‰‹å†Š" -Filter "*.md" | ForEach-Object {
    $name = $_.BaseName
    Write-Host "`n=== $name ===" -ForegroundColor Cyan
    Get-Content $_.FullName | Select-String "ç›¸é—œåŠŸèƒ½" -Context 0,10
}
```

**æ£€æŸ¥è§„åˆ™ï¼š**
- å¦‚æœAå¼•ç”¨Bï¼ŒBä¹Ÿå¿…é¡»å¼•ç”¨Aï¼ˆå¯¹ç§°æ€§ï¼‰
- æ‰€æœ‰åŠŸèƒ½æ–‡æ¡£éƒ½å¿…é¡»æœ‰"ç›¸é—œåŠŸèƒ½"éƒ¨åˆ†ï¼ˆé™¤äº†READMEå’Œå¿«é€Ÿå¼€å§‹ï¼‰

---

## ğŸ“ ä¸€è‡´æ€§æ£€æŸ¥æ¸…å•ï¼ˆAIå¿…é¡»é€é¡¹ç¡®è®¤ï¼‰

å®Œæˆå¼€å‘åï¼Œé€é¡¹æ£€æŸ¥ï¼š

### âœ… æ•°å­—ç»Ÿè®¡ä¸€è‡´æ€§
- [ ] ä»SSOTæå–çœŸå®æ•°å­—ï¼ˆè³‡æ–™è¡¨ã€APIï¼‰
- [ ] æœç´¢æ‰€æœ‰æ–‡æ¡£ä¸­çš„ç›¸å…³æ•°å­—
- [ ] ç¡®è®¤æ‰€æœ‰æ•°å­—ä¸SSOTä¸€è‡´
- [ ] å¦‚æœ‰ä¸ä¸€è‡´ï¼Œç«‹å³ä¿®å¤

### âœ… äº¤å‰å¼•ç”¨å¯¹ç§°æ€§  
- [ ] åˆ—å‡ºæ‰€æœ‰ä¿®æ”¹/æ–°å¢çš„æ–‡æ¡£
- [ ] æ£€æŸ¥å®ƒä»¬çš„"ç›¸é—œåŠŸèƒ½"éƒ¨åˆ†
- [ ] ç¡®è®¤åŒå‘å¼•ç”¨ï¼ˆAâ†’B ä¸” Bâ†’Aï¼‰
- [ ] è¡¥å……ç¼ºå¤±çš„å¼•ç”¨

### âœ… æ ¼å¼è§„èŒƒä¸€è‡´æ€§
- [ ] æ£€æŸ¥åŒç±»æ–‡æ¡£çš„ç« èŠ‚ç»“æ„
- [ ] æ£€æŸ¥å®Œæ•´è§„æ ¼çš„ç»“å°¾æ ¼å¼
- [ ] ç¡®ä¿ç»Ÿä¸€çš„æ ¼å¼è§„èŒƒ

### âœ… å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ‰€æœ‰ä½¿ç”¨æ‰‹å†Œéƒ½æœ‰"ç›¸é—œåŠŸèƒ½"
- [ ] æ‰€æœ‰å®Œæ•´è§„æ ¼éƒ½æœ‰å¿…è¦ç« èŠ‚
- [ ] æ‰€æœ‰æ–°å¢åŠŸèƒ½éƒ½æœ‰å¯¹åº”æ–‡æ¡£

---

## ğŸ¯ ç®€åŒ–éªŒè¯å‘½ä»¤ï¼ˆæ¨èï¼‰

```powershell
# å¿«é€Ÿæ£€æŸ¥ï¼šæŸ¥æ‰¾å¯èƒ½çš„ä¸ä¸€è‡´
cd docs

# æŸ¥æ‰¾æ‰€æœ‰æ•°å­—ç»Ÿè®¡
Get-ChildItem -Filter "*.md" -Recurse | Select-String "å€‹.*[è¡¨API]" | ForEach-Object {
    if ($_.Line -match '(\d+)å€‹') {
        "$($_.FileName): $($matches[1])å€‹"
    }
} | Sort-Object | Get-Unique

# å¦‚æœçœ‹åˆ°å¤šä¸ªä¸åŒçš„æ•°å­—ï¼Œè¯´æ˜ä¸ä¸€è‡´ï¼
```

---

**AIå¼€å‘å®Œæˆåå¿…é¡»æ‰‹åŠ¨æ‰§è¡Œè¿™äº›æ£€æŸ¥ï¼Œä¸èƒ½è·³è¿‡ï¼**

