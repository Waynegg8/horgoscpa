# ä¸€è‡´æ€§é©—è­‰æ–¹æ³•

**ç›®çš„ï¼š** ç¢ºä¿æ‰€æœ‰æ–‡ä»¶çš„ä¸€è‡´æ€§ï¼Œä¸ä¾è³´ç¡¬ç·¨ç¢¼æ•¸å­—

**æ ¸å¿ƒåŸå‰‡ï¼šå–®ä¸€çœŸç›¸æºï¼ˆSSOT - Single Source of Truthï¼‰**

---

## ğŸ“Œ å–®ä¸€çœŸç›¸æºï¼ˆSSOTï¼‰

### å®šç¾©
**åªåœ¨ä¸€å€‹åœ°æ–¹å®šç¾©çœŸç›¸ï¼Œå…¶ä»–æ‰€æœ‰åœ°æ–¹éƒ½å¿…é ˆèˆ‡å®ƒä¸€è‡´ã€‚**

### çœŸç›¸æºæ–‡ä»¶

| è³‡æ–™é¡å‹ | çœŸç›¸æºæ–‡ä»¶ | èªªæ˜ |
|---------|----------|------|
| è³‡æ–™è¡¨ç¸½æ•¸ | `ç³»çµ±è³‡æ–™/æ•¸æ“šè¡¨æ¸…å–®.md` | å”¯ä¸€å®šç¾©è³‡æ–™è¡¨æ•¸é‡çš„åœ°æ–¹ |
| APIç¸½æ•¸ | `ç³»çµ±è³‡æ–™/APIæ¸…å–®.md` | å”¯ä¸€å®šç¾© API æ•¸é‡çš„åœ°æ–¹ |

### é©—è­‰åŸå‰‡

**ç•¶ä½ ä¿®æ”¹æ•¸å­—æ™‚ï¼š**
1. âœ… **åªåœ¨ SSOT æ–‡ä»¶ä¸­ä¿®æ”¹**
2. âœ… **æª¢æŸ¥æ‰€æœ‰å…¶ä»–æ–‡ä»¶æ˜¯å¦èˆ‡ SSOT ä¸€è‡´**
3. âœ… **å¦‚æœä¸ä¸€è‡´ï¼Œæ›´æ–°å®ƒå€‘**

**ç¯„ä¾‹ï¼šæ–°å¢ä¸€å€‹è³‡æ–™è¡¨**
```
1. åœ¨ æ•¸æ“šè¡¨æ¸…å–®.md ä¸­ï¼š
   - æ–°å¢è©²è¡¨çš„å®šç¾©
   - æ›´æ–°ç¸½æ•¸ï¼š28å€‹ â†’ 29å€‹

2. æª¢æŸ¥ä»¥ä¸‹æ–‡ä»¶ï¼Œç¢ºä¿æ•¸å­—ä¸€è‡´ï¼š
   - é–‹ç™¼æŒ‡å—/README.md
   - ä½¿ç”¨æ‰‹å†Š/README.md
   - æ‰€æœ‰æåˆ°è³‡æ–™è¡¨æ•¸é‡çš„æ–‡ä»¶

3. ä½¿ç”¨æœå°‹é©—è­‰ï¼š
   grep -r "\\d+å€‹.*è¡¨" docs/
   â†’ ä¸æ‡‰è©²æœ‰ä»»ä½•çµæœ
```

---

## ğŸ” é©—è­‰æ–¹æ³•

### æ–¹æ³•1ï¼šæª¢æŸ¥æ•¸å­—çµ±è¨ˆæ˜¯å¦ä¸€è‡´

```bash
# Windows PowerShell
$tables = @()
$apis = @()

# æå–æ‰€æœ‰æåˆ°ã€Œè¡¨ã€çš„æ•¸å­—
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | ForEach-Object {
    $content = Get-Content $_.FullName -Raw
    if ($content -match '(\d+)\s*å€‹.*?è¡¨') {
        $tables += @{File=$_.Name; Count=$matches[1]}
    }
    if ($content -match '(\d+)\s*å€‹.*?API') {
        $apis += @{File=$_.Name; Count=$matches[1]}
    }
}

# æª¢æŸ¥æ˜¯å¦æ‰€æœ‰æ•¸å­—ä¸€è‡´
$tableCount = $tables | Select-Object -ExpandProperty Count -Unique
$apiCount = $apis | Select-Object -ExpandProperty Count -Unique

if ($tableCount.Count -gt 1) {
    Write-Host "âŒ è³‡æ–™è¡¨æ•¸å­—ä¸ä¸€è‡´ï¼" -ForegroundColor Red
    $tables | Format-Table
} else {
    Write-Host "âœ… è³‡æ–™è¡¨æ•¸å­—ä¸€è‡´ï¼š$tableCount å€‹" -ForegroundColor Green
}

if ($apiCount.Count -gt 1) {
    Write-Host "âŒ API æ•¸å­—ä¸ä¸€è‡´ï¼" -ForegroundColor Red
    $apis | Format-Table
} else {
    Write-Host "âœ… API æ•¸å­—ä¸€è‡´ï¼š$apiCount å€‹" -ForegroundColor Green
}
```

---

### æ–¹æ³•2ï¼šé©—è­‰å–®ä¸€çœŸç›¸æºï¼ˆSSOTï¼‰

**åŸå‰‡ï¼š** åªåœ¨ä¸€å€‹åœ°æ–¹å®šç¾©çœŸç›¸ï¼Œå…¶ä»–åœ°æ–¹éƒ½å¼•ç”¨å®ƒ

**å–®ä¸€çœŸç›¸æºæ–‡ä»¶ï¼š**
- `ç³»çµ±è³‡æ–™/æ•¸æ“šè¡¨æ¸…å–®.md` - å”¯ä¸€å®šç¾©è³‡æ–™è¡¨ç¸½æ•¸çš„åœ°æ–¹
- `ç³»çµ±è³‡æ–™/APIæ¸…å–®.md` - å”¯ä¸€å®šç¾© API ç¸½æ•¸çš„åœ°æ–¹

**é©—è­‰è…³æœ¬ï¼š**
```bash
# 1. å¾ SSOT æ–‡ä»¶ä¸­æå–çœŸç›¸
$tableFile = Get-Content "docs\ç³»çµ±è³‡æ–™\æ•¸æ“šè¡¨æ¸…å–®.md" -Raw
$apiFile = Get-Content "docs\ç³»çµ±è³‡æ–™\APIæ¸…å–®.md" -Raw

$tableFile -match 'è³‡æ–™è¡¨ç¸½è¦½[ï¼ˆ(](\d+)å€‹[ï¼‰)]'
$truthTables = $matches[1]

$apiFile -match 'ç¸½è¨ˆ[ï¼š:]\s*ç´„?\s*(\d+)\s*å€‹'
$truthAPIs = $matches[1]

Write-Host "å–®ä¸€çœŸç›¸æºï¼š" 
Write-Host "  è³‡æ–™è¡¨ï¼š$truthTables å€‹" -ForegroundColor Cyan
Write-Host "  APIï¼š$truthAPIs å€‹" -ForegroundColor Cyan

# 2. æª¢æŸ¥å…¶ä»–æ–‡ä»¶æ˜¯å¦èˆ‡ SSOT ä¸€è‡´
$errors = @()

Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | ForEach-Object {
    if ($_.Name -notlike "*æ•¸æ“šè¡¨æ¸…å–®.md" -and $_.Name -notlike "*APIæ¸…å–®.md") {
        $content = Get-Content $_.FullName -Raw
        
        # æª¢æŸ¥è¡¨çš„æ•¸å­—
        if ($content -match '(\d+)\s*å€‹.*?è¡¨') {
            if ($matches[1] -ne $truthTables) {
                $errors += "$($_.Name): è¡¨æ•¸å­— $($matches[1]) â‰  $truthTables"
            }
        }
        
        # æª¢æŸ¥ API çš„æ•¸å­—
        if ($content -match '(\d+)\s*å€‹.*?API') {
            if ($matches[1] -ne $truthAPIs) {
                $errors += "$($_.Name): API æ•¸å­— $($matches[1]) â‰  $truthAPIs"
            }
        }
    }
}

if ($errors.Count -eq 0) {
    Write-Host "`nâœ… æ‰€æœ‰æ–‡ä»¶èˆ‡å–®ä¸€çœŸç›¸æºä¸€è‡´ï¼" -ForegroundColor Green
} else {
    Write-Host "`nâŒ ç™¼ç¾ $($errors.Count) å€‹ä¸ä¸€è‡´ï¼š" -ForegroundColor Red
    $errors | ForEach-Object { Write-Host "  $_" -ForegroundColor Yellow }
}
```

---

### æ–¹æ³•3ï¼šé©—è­‰äº¤å‰å¼•ç”¨å°ç¨±æ€§

```bash
# æª¢æŸ¥æ‰€æœ‰ã€Œç›¸é—œåŠŸèƒ½ã€çš„é›™å‘å¼•ç”¨
$files = Get-ChildItem -Path "docs\ä½¿ç”¨æ‰‹å†Š" -Filter "*.md"
$references = @{}

foreach ($file in $files) {
    $content = Get-Content $file.FullName -Raw
    $name = $file.BaseName
    
    # æå–æ‰€æœ‰å¼•ç”¨
    $matches = [regex]::Matches($content, '\\[([^\\]]+)\\]\\(\\./([^\\)]+)\\.md\\)')
    $refs = $matches | ForEach-Object { $_.Groups[2].Value }
    
    $references[$name] = $refs
}

# æª¢æŸ¥å°ç¨±æ€§
$asymmetric = @()
foreach ($source in $references.Keys) {
    foreach ($target in $references[$source]) {
        # å¦‚æœ A å¼•ç”¨ Bï¼Œæª¢æŸ¥ B æ˜¯å¦å¼•ç”¨ A
        if ($references.ContainsKey($target)) {
            if ($references[$target] -notcontains $source) {
                $asymmetric += "$source â†’ $target (ä½† $target æ²’æœ‰å¼•ç”¨ $source)"
            }
        }
    }
}

if ($asymmetric.Count -eq 0) {
    Write-Host "âœ… æ‰€æœ‰äº¤å‰å¼•ç”¨éƒ½æ˜¯å°ç¨±çš„ï¼" -ForegroundColor Green
} else {
    Write-Host "âŒ ç™¼ç¾ $($asymmetric.Count) å€‹ä¸å°ç¨±å¼•ç”¨ï¼š" -ForegroundColor Red
    $asymmetric | ForEach-Object { Write-Host "  $_" -ForegroundColor Yellow }
}
```

---

### æ–¹æ³•4ï¼šé©—è­‰æ ¼å¼ä¸€è‡´æ€§

```bash
# æª¢æŸ¥åŒé¡æ–‡ä»¶æ˜¯å¦ä½¿ç”¨ç›¸åŒçš„ç« ç¯€çµæ§‹
$specs = Get-ChildItem -Path "docs\é–‹ç™¼æŒ‡å—" -Filter "*-å®Œæ•´è¦æ ¼.md"
$structures = @{}

foreach ($spec in $specs) {
    $content = Get-Content $spec.FullName
    $headers = $content | Where-Object { $_ -match '^##\s+' } | ForEach-Object { $_ -replace '^##\s+', '' }
    $structures[$spec.Name] = $headers -join "|"
}

# æª¢æŸ¥æ˜¯å¦æ‰€æœ‰å®Œæ•´è¦æ ¼éƒ½æœ‰ç›¸åŒçš„çµæ§‹
$uniqueStructures = $structures.Values | Select-Object -Unique

if ($uniqueStructures.Count -eq 1) {
    Write-Host "âœ… æ‰€æœ‰å®Œæ•´è¦æ ¼æ–‡ä»¶çµæ§‹ä¸€è‡´ï¼" -ForegroundColor Green
} else {
    Write-Host "âŒ å®Œæ•´è¦æ ¼æ–‡ä»¶çµæ§‹ä¸ä¸€è‡´ï¼š" -ForegroundColor Red
    $structures.GetEnumerator() | ForEach-Object {
        Write-Host "  $($_.Key): $($_.Value)" -ForegroundColor Yellow
    }
}
```

---

## ğŸ§ª æ‰‹å‹•é©—è­‰æ­¥é©Ÿï¼ˆAI å¿…é ˆåŸ·è¡Œï¼‰

### æ­¥é©Ÿ1ï¼šæå– SSOT çœŸç›¸

```powershell
# 1. æŸ¥çœ‹è³‡æ–™è¡¨çœŸç›¸æº
Get-Content "docs\ç³»çµ±è³‡æ–™\æ•¸æ“šè¡¨æ¸…å–®.md" | Select-String "è³‡æ–™è¡¨ç¸½è¦½"
# è¼¸å‡ºç¯„ä¾‹ï¼š## ğŸ“Š è³‡æ–™è¡¨ç¸½è¦½ï¼ˆNå€‹ï¼‰
# â†’ ä»¥æ“·å–åˆ°çš„æ•¸å­—ç‚ºæº–ï¼ˆSSOTï¼‰

# 2. æŸ¥çœ‹ API çœŸç›¸æº  
Get-Content "docs\ç³»çµ±è³‡æ–™\APIæ¸…å–®.md" | Select-String "ç¸½è¨ˆ"
# è¼¸å‡ºç¯„ä¾‹ï¼š**ç¸½è¨ˆï¼šç´„ N å€‹ API ç«¯é»**
# â†’ ä»¥æ“·å–åˆ°çš„æ•¸å­—ç‚ºæº–ï¼ˆSSOTï¼‰
```

### æ­¥é©Ÿ2ï¼šæœå°‹æ‰€æœ‰æåˆ°çš„æ•¸å­—

```powershell
# æœå°‹æ‰€æœ‰æåˆ°ã€Œè¡¨ã€æ•¸å­—çš„åœ°æ–¹
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | Select-String "å€‹.*è¡¨" | Where-Object { $_.Line -match '\\d+å€‹' }

# æœå°‹æ‰€æœ‰æåˆ°ã€ŒAPIã€æ•¸å­—çš„åœ°æ–¹
Get-ChildItem -Path "docs" -Filter "*.md" -Recurse | Select-String "å€‹.*API" | Where-Object { $_.Line -match '\\d+å€‹' }
```

### æ­¥é©Ÿ3ï¼šæª¢æŸ¥ä¸€è‡´æ€§

**æ‰€æœ‰çµæœéƒ½å¿…é ˆèˆ‡ SSOT ä¸€è‡´ï¼**
â€“ å¦‚æœçœ‹åˆ°ä¸åŒçš„æ•¸å­—ï¼ˆå¦‚ï¼šX å€‹è¡¨ã€Y å€‹ APIï¼‰ï¼Œç«‹å³ä¿®å¾©
- ç›´åˆ°æ‰€æœ‰æ•¸å­—éƒ½ä¸€è‡´ï¼ˆä»¥ SSOT æ•¸å­—ç‚ºæº–ï¼‰

### æ­¥é©Ÿ4ï¼šé©—è­‰äº¤å‰å¼•ç”¨

```powershell
# æª¢æŸ¥ä½¿ç”¨æ‰‹å†Šä¸­çš„äº¤å‰å¼•ç”¨
Get-ChildItem "docs\ä½¿ç”¨æ‰‹å†Š" -Filter "*.md" | ForEach-Object {
    $name = $_.BaseName
    Write-Host "`n=== $name ===" -ForegroundColor Cyan
    Get-Content $_.FullName | Select-String "ç›¸é—œåŠŸèƒ½" -Context 0,10
}
```

**æª¢æŸ¥è¦å‰‡ï¼š**
- å¦‚æœ A å¼•ç”¨ Bï¼ŒB ä¹Ÿå¿…é ˆå¼•ç”¨ Aï¼ˆå°ç¨±æ€§ï¼‰
- æ‰€æœ‰åŠŸèƒ½æ–‡ä»¶éƒ½å¿…é ˆæœ‰ã€Œç›¸é—œåŠŸèƒ½ã€éƒ¨åˆ†ï¼ˆé™¤äº† README å’Œå¿«é€Ÿé–‹å§‹ï¼‰

---

## ğŸ“ ä¸€è‡´æ€§æª¢æŸ¥æ¸…å–®ï¼ˆAI å¿…é ˆé€é …ç¢ºèªï¼‰

å®Œæˆé–‹ç™¼å¾Œï¼Œé€é …æª¢æŸ¥ï¼š

### âœ… æ•¸å­—çµ±è¨ˆä¸€è‡´æ€§
- [ ] å¾ SSOT æå–çœŸå¯¦æ•¸å­—ï¼ˆè³‡æ–™è¡¨ã€APIï¼‰
- [ ] æœå°‹æ‰€æœ‰æ–‡ä»¶ä¸­çš„ç›¸é—œæ•¸å­—
- [ ] ç¢ºèªæ‰€æœ‰æ•¸å­—èˆ‡ SSOT ä¸€è‡´
- [ ] å¦‚æœ‰ä¸ä¸€è‡´ï¼Œç«‹å³ä¿®å¾©

### âœ… äº¤å‰å¼•ç”¨å°ç¨±æ€§  
- [ ] åˆ—å‡ºæ‰€æœ‰ä¿®æ”¹/æ–°å¢çš„æ–‡ä»¶
- [ ] æª¢æŸ¥å®ƒå€‘çš„ã€Œç›¸é—œåŠŸèƒ½ã€éƒ¨åˆ†
- [ ] ç¢ºèªé›™å‘å¼•ç”¨ï¼ˆAâ†’B ä¸” Bâ†’Aï¼‰
- [ ] è£œå……ç¼ºå¤±çš„å¼•ç”¨

### âœ… æ ¼å¼è¦ç¯„ä¸€è‡´æ€§
- [ ] æª¢æŸ¥åŒé¡æ–‡ä»¶çš„ç« ç¯€çµæ§‹
- [ ] æª¢æŸ¥å®Œæ•´è¦æ ¼çš„çµå°¾æ ¼å¼
- [ ] ç¢ºä¿çµ±ä¸€çš„æ ¼å¼è¦ç¯„

### âœ… å®Œæ•´æ€§æª¢æŸ¥
- [ ] æ‰€æœ‰ä½¿ç”¨æ‰‹å†Šéƒ½æœ‰ã€Œç›¸é—œåŠŸèƒ½ã€
- [ ] æ‰€æœ‰å®Œæ•´è¦æ ¼éƒ½æœ‰å¿…è¦ç« ç¯€
- [ ] æ‰€æœ‰æ–°å¢åŠŸèƒ½éƒ½æœ‰å°æ‡‰æ–‡ä»¶

---

## ğŸ¯ ç°¡åŒ–é©—è­‰å‘½ä»¤ï¼ˆæ¨è–¦ï¼‰

```powershell
# å¿«é€Ÿæª¢æŸ¥ï¼šå°‹æ‰¾å¯èƒ½çš„ä¸ä¸€è‡´
cd docs

# æŸ¥æ‰¾æ‰€æœ‰æ•¸å­—çµ±è¨ˆ
Get-ChildItem -Filter "*.md" -Recurse | Select-String "å€‹.*[è¡¨API]" | ForEach-Object {
    if ($_.Line -match '(\d+)å€‹') {
        "$($_.FileName): $($matches[1])å€‹"
    }
} | Sort-Object | Get-Unique

# å¦‚æœçœ‹åˆ°å¤šå€‹ä¸åŒçš„æ•¸å­—ï¼Œä»£è¡¨ä¸ä¸€è‡´ï¼
```

---

**AI é–‹ç™¼å®Œæˆå¾Œå¿…é ˆæ‰‹å‹•åŸ·è¡Œé€™äº›æª¢æŸ¥ï¼Œä¸å¯è·³éï¼**


