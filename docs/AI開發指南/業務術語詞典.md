# 业务术语词典

**供 AI 理解业务术语使用，用户永远不需要看**

---

## 🎯 使用方式

当用户说业务需求时，AI 查阅本词典，将业务术语转换为技术实现。

---

## 会计事务所业务术语

### 1. "最赚钱的客户"

**业务含义：** 收费高于成本的客户

**技术实现：**
```sql
SELECT 
  c.client_id,
  c.name,
  cs.monthly_fee as revenue,
  SUM(t.weighted_hours) * @hourly_rate as cost,
  (cs.monthly_fee - SUM(t.weighted_hours) * @hourly_rate) as profit,
  (cs.monthly_fee / (SUM(t.weighted_hours) * @hourly_rate)) as profit_ratio
FROM Clients c
JOIN ClientServices cs ON c.client_id = cs.client_id
JOIN TimeLogs t ON c.client_id = t.client_id
GROUP BY c.client_id
ORDER BY profit DESC
```

**确认话术：**
```
我理解您需要"客户获利分析报表"，会显示：
- 每个客户的收费（revenue）
- 投入成本（工时 × 时薪）
- 净利润（收费 - 成本）
- 获利率（收费 / 成本）
按获利率排序，对吗？
```

---

### 2. "效率高的员工"

**业务含义：** 完成任务快、质量好的员工

**技术实现：**
```typescript
// 综合指标计算效率分数
const efficiencyScore = 
  taskCount * 0.3 +           // 完成任务数（30%）
  (1 / avgCompletionTime) * 0.3 +  // 完成速度（30%）
  avgClientRating * 0.3 +     // 客户评分（30%）
  (1 - reworkRate) * 0.1;     // 返工率（10%）
```

**确认话术：**
```
我理解您需要"员工效率分析报表"，基于：
- 完成任务数量（30%权重）
- 平均完成时间（30%）
- 客户评分（30%）
- 返工率（10%）
计算综合效率分数，对吗？或需要调整权重？
```

---

### 3. "工时超标"

**业务含义：** 实际投入工时超过预估工时

**技术实现：**
```sql
SELECT 
  t.task_id,
  t.task_name,
  t.estimated_hours,
  SUM(tl.hours) as actual_hours,
  (SUM(tl.hours) - t.estimated_hours) as overtime_hours,
  ((SUM(tl.hours) - t.estimated_hours) / t.estimated_hours * 100) as overtime_percentage
FROM ActiveTasks t
JOIN TimeLogs tl ON t.task_id = tl.task_id
GROUP BY t.task_id
HAVING SUM(tl.hours) > t.estimated_hours
ORDER BY overtime_percentage DESC
```

**确认话术：**
```
我理解您需要查看"工时超标报表"，显示：
- 任务名称
- 预估工时 vs 实际工时
- 超标时数和百分比
按超标比例排序，对吗？
```

---

### 4. "任务延期"

**业务含义：** 实际完成日期晚于预计完成日期

**技术实现：**
```sql
SELECT 
  task_id,
  task_name,
  expected_due_date,
  actual_completion_date,
  julianday(actual_completion_date) - julianday(expected_due_date) as delay_days
FROM ActiveTasks
WHERE actual_completion_date > expected_due_date
  OR (actual_completion_date IS NULL AND date('now') > expected_due_date)
ORDER BY delay_days DESC
```

**确认话术：**
```
我理解您需要"任务延期报表"，显示：
- 已延期完成的任务
- 当前延期中的任务
- 延期天数
对吗？
```

---

### 5. "客户流失风险"

**业务含义：** 可能流失的客户（评分低、服务少、沟通少）

**技术实现：**
```typescript
// 综合风险评分
const churnRisk = 
  (5 - avgRating) * 0.4 +           // 评分低（40%）
  (1 / activeServicesCount) * 0.3 + // 服务少（30%）
  (1 / recentContactCount) * 0.3;   // 沟通少（30%）
  
// 风险等级
const riskLevel = 
  churnRisk > 3 ? 'high' :
  churnRisk > 2 ? 'medium' : 'low';
```

**确认话术：**
```
我理解您需要"客户流失风险分析"，基于：
- 客户评分（低 = 高风险）
- 服务数量（少 = 高风险）
- 近期联系次数（少 = 高风险）
标注高/中/低风险客户，对吗？
```

---

### 6. "服务利润率"

**业务含义：** 某类服务的平均利润率

**技术实现：**
```sql
SELECT 
  s.service_name,
  COUNT(cs.client_service_id) as client_count,
  AVG(cs.monthly_fee) as avg_fee,
  AVG(SUM(tl.weighted_hours) * @hourly_rate) as avg_cost,
  AVG(cs.monthly_fee - SUM(tl.weighted_hours) * @hourly_rate) as avg_profit,
  AVG((cs.monthly_fee - SUM(tl.weighted_hours) * @hourly_rate) / cs.monthly_fee * 100) as profit_margin_pct
FROM Services s
JOIN ClientServices cs ON s.service_id = cs.service_id
JOIN TimeLogs tl ON cs.client_service_id = tl.client_service_id
GROUP BY s.service_id
ORDER BY profit_margin_pct DESC
```

**确认话术：**
```
我理解您需要"服务利润率分析"，显示：
- 各服务类型（记帐、税务等）
- 客户数量
- 平均收费和成本
- 平均利润率
对吗？
```

---

### 7. "月度业务量"

**业务含义：** 每月完成的任务数、工时数

**技术实现：**
```sql
SELECT 
  strftime('%Y-%m', work_date) as month,
  COUNT(DISTINCT task_id) as task_count,
  SUM(hours) as total_hours,
  SUM(weighted_hours) as total_weighted_hours,
  COUNT(DISTINCT user_id) as active_employees
FROM TimeLogs
WHERE work_date >= date('now', '-12 months')
GROUP BY strftime('%Y-%m', work_date)
ORDER BY month
```

**确认话术：**
```
我理解您需要"月度业务量报表"，显示过去12个月的：
- 完成任务数
- 总工时（原始+加权）
- 活跃员工数
对吗？
```

---

### 8. "加班统计"

**业务含义：** 员工的加班时数和费用

**技术实现：**
```sql
SELECT 
  u.name,
  SUM(CASE WHEN tl.work_type = '正常工时' THEN tl.hours ELSE 0 END) as normal_hours,
  SUM(CASE WHEN tl.work_type LIKE '%加班%' THEN tl.hours ELSE 0 END) as overtime_hours,
  SUM(CASE WHEN tl.work_type LIKE '%加班%' THEN tl.weighted_hours ELSE 0 END) as overtime_weighted_hours,
  (SUM(CASE WHEN tl.work_type LIKE '%加班%' THEN tl.weighted_hours ELSE 0 END) * @hourly_rate) as overtime_cost
FROM Users u
JOIN TimeLogs tl ON u.user_id = tl.user_id
WHERE strftime('%Y-%m', tl.work_date) = @month
GROUP BY u.user_id
ORDER BY overtime_hours DESC
```

**确认话术：**
```
我理解您需要"加班统计报表"，显示每位员工：
- 正常工时 vs 加班工时
- 加班加权工时
- 预估加班费用
对吗？
```

---

### 9. "假期使用率"

**业务含义：** 员工使用假期的比例

**技术实现：**
```sql
SELECT 
  u.name,
  lt.leave_type_name,
  lb.entitled_hours,
  lb.used_hours,
  (lb.used_hours * 100.0 / lb.entitled_hours) as usage_rate,
  (lb.entitled_hours - lb.used_hours) as remaining_hours
FROM Users u
JOIN LeaveBalances lb ON u.user_id = lb.user_id
JOIN LeaveTypes lt ON lb.leave_type_id = lt.leave_type_id
WHERE lb.year = @year
ORDER BY u.name, lt.sort_order
```

**确认话术：**
```
我理解您需要"假期使用率报表"，显示每位员工：
- 各类假别（特休、病假等）
- 可用额度 vs 已使用
- 使用率和剩余额度
对吗？
```

---

### 10. "新客户转化率"

**业务含义：** 潜在客户变成正式客户的比例

**技术实现：**
```typescript
// 假设有 PotentialClients 和 Clients 表
const conversionRate = 
  (activeClientsCount / potentialClientsCount) * 100;

// 按来源渠道分析
const byChannel = channels.map(channel => ({
  channel,
  potential: potentialClients.filter(c => c.source === channel).length,
  converted: activeClients.filter(c => c.source === channel).length,
  rate: (converted / potential * 100)
}));
```

**确认话术：**
```
我理解您需要"客户转化率分析"，显示：
- 总体转化率
- 各来源渠道的转化率
- 转化周期
对吗？
```

---

## 时间相关术语

### "本月" / "当月"
```sql
strftime('%Y-%m', date('now'))
```

### "上月"
```sql
strftime('%Y-%m', date('now', '-1 month'))
```

### "本季"
```sql
-- Q1: 01-03, Q2: 04-06, Q3: 07-09, Q4: 10-12
CASE 
  WHEN CAST(strftime('%m', date('now')) AS INTEGER) BETWEEN 1 AND 3 THEN '1'
  WHEN CAST(strftime('%m', date('now')) AS INTEGER) BETWEEN 4 AND 6 THEN '2'
  WHEN CAST(strftime('%m', date('now')) AS INTEGER) BETWEEN 7 AND 9 THEN '3'
  ELSE '4'
END
```

### "本年"
```sql
strftime('%Y', date('now'))
```

### "最近7天"
```sql
date('now', '-7 days')
```

### "最近30天"
```sql
date('now', '-30 days')
```

---

## 状态相关术语

### "进行中" / "处理中"
```sql
status IN ('pending', 'in_progress')
```

### "已完成"
```sql
status = 'completed'
```

### "逾期" / "延期"
```sql
expected_due_date < date('now') AND status != 'completed'
```

### "即将到期"
```sql
expected_due_date BETWEEN date('now') AND date('now', '+3 days')
AND status != 'completed'
```

---

## 使用流程

### 步骤1：识别术语

```
用户: "我想知道哪些客户最赚钱"
          ^^^^^^^^ 业务术语
```

### 步骤2：查阅词典

```
查找: "最赚钱的客户"
找到: 收费 > 成本，按利润率排序
```

### 步骤3：转换为技术需求

```
技术需求：
- 查询 Clients + ClientServices + TimeLogs
- 计算：revenue, cost, profit, profit_ratio
- 排序：按 profit_ratio DESC
- 显示：前20名
```

### 步骤4：确认理解

```
AI: 我理解您需要"客户获利分析报表"...
    正确吗？
```

---

## 持续更新

每次遇到新的业务术语，记录到本词典：
1. 业务含义
2. 技术实现（SQL/代码）
3. 确认话术

---

**AI 使用原则：**
- 先查词典，理解业务含义
- 转换为技术实现
- 向用户确认理解正确
- 不问技术问题

