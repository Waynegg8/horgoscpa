# å…§å®¹ç®¡ç†ç³»çµ± (CMS) è¨­è¨ˆ

**ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025-10-26

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å…§å®¹ç®¡ç†ç³»çµ±ç”¨æ–¼ç®¡ç†å°å¤–ç¶²ç«™çš„éƒ¨è½æ ¼æ–‡ç« ã€è³‡æºæ–‡ä»¶å’Œåª’é«”æª”æ¡ˆã€‚

### æ ¸å¿ƒåŠŸèƒ½
- éƒ¨è½æ ¼æ–‡ç« ç®¡ç†
- è³‡æºæ–‡ä»¶ç®¡ç†
- åª’é«”åº«ï¼ˆåœ–ç‰‡ä¸Šå‚³ï¼‰
- Markdown ç·¨è¼¯å™¨
- æ–‡ç« ç™¼å¸ƒ/è‰ç¨¿
- SEO è¨­å®š

---

## ğŸ—„ï¸ è³‡æ–™è¡¨çµæ§‹

### posts (æ–‡ç« )
```sql
CREATE TABLE posts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,               -- æ–‡ç« æ¨™é¡Œ
  slug TEXT UNIQUE NOT NULL,         -- URL slug
  excerpt TEXT,                      -- æ‘˜è¦
  content TEXT NOT NULL,             -- æ–‡ç« å…§å®¹ï¼ˆMarkdownï¼‰
  featured_image TEXT,               -- ç‰¹è‰²åœ–ç‰‡ URL
  post_type TEXT DEFAULT 'blog',     -- blog, resource
  status TEXT DEFAULT 'draft',       -- draft, published, archived
  author_id INTEGER,                 -- ä½œè€…
  published_at DATETIME,
  views INTEGER DEFAULT 0,
  meta_title TEXT,                   -- SEO æ¨™é¡Œ
  meta_description TEXT,             -- SEO æè¿°
  meta_keywords TEXT,                -- SEO é—œéµå­—
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (author_id) REFERENCES users(id)
);
```

### media_library (åª’é«”åº«)
```sql
CREATE TABLE media_library (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  filename TEXT NOT NULL,            -- æª”æ¡ˆåç¨±
  original_filename TEXT,            -- åŸå§‹æª”æ¡ˆå
  file_path TEXT NOT NULL,           -- æª”æ¡ˆè·¯å¾‘/URL
  file_type TEXT,                    -- image/jpeg, image/png, etc.
  file_size INTEGER,                 -- æª”æ¡ˆå¤§å°ï¼ˆbytesï¼‰
  width INTEGER,                     -- åœ–ç‰‡å¯¬åº¦
  height INTEGER,                    -- åœ–ç‰‡é«˜åº¦
  alt_text TEXT,                     -- æ›¿ä»£æ–‡å­—ï¼ˆSEOï¼‰
  uploaded_by INTEGER,               -- ä¸Šå‚³è€…
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (uploaded_by) REFERENCES users(id)
);
```

---

## ğŸ”„ æ¥­å‹™æµç¨‹

### æ–‡ç« ç™¼å¸ƒæµç¨‹
```
1. å»ºç«‹æ–‡ç« è‰ç¨¿
   - è¼¸å…¥æ¨™é¡Œ
   - ç·¨å¯«å…§å®¹ï¼ˆMarkdownï¼‰
   - é¸æ“‡ç‰¹è‰²åœ–ç‰‡
   â†“
2. è¨­å®š SEO
   - Meta æ¨™é¡Œ
   - Meta æè¿°
   - é—œéµå­—
   â†“
3. é è¦½æ–‡ç« 
   - æŸ¥çœ‹æ¸²æŸ“æ•ˆæœ
   - æª¢æŸ¥æ’ç‰ˆ
   â†“
4. ç™¼å¸ƒæ–‡ç« 
   - UPDATE status = 'published'
   - published_at = NOW()
   - è‡ªå‹•ç”¢ç”Ÿ slug
   â†“
5. æ›´æ–°ç¶²ç«™åœ°åœ–
   - è§¸ç™¼ sitemap.xml æ›´æ–°
```

### åª’é«”ä¸Šå‚³æµç¨‹
```
1. é¸æ“‡æª”æ¡ˆ
   - æ”¯æ´æ ¼å¼ï¼šjpg, png, webp
   - å¤§å°é™åˆ¶ï¼š5MB
   â†“
2. ä¸Šå‚³åˆ° Cloudflare R2
   - å£“ç¸®åœ–ç‰‡ï¼ˆå¦‚éœ€è¦ï¼‰
   - ç”¢ç”Ÿå”¯ä¸€æª”å
   â†“
3. è¨˜éŒ„åˆ°è³‡æ–™åº«
   - INSERT INTO media_library
   - è¨˜éŒ„æª”æ¡ˆè³‡è¨Š
   â†“
4. è¿”å›åœ–ç‰‡ URL
   - ä¾›æ–‡ç« ç·¨è¼¯å™¨æ’å…¥
```

---

## ğŸ”Œ API è¨­è¨ˆ

### å–å¾—æ–‡ç« åˆ—è¡¨
```
GET /api/posts?status=published&post_type=blog&limit=10

Response:
{
  "success": true,
  "posts": [
    {
      "id": 1,
      "title": "å‰µæ¥­å…¬å¸è¨­ç«‹æŒ‡å—",
      "slug": "startup-company-setup-guide",
      "excerpt": "å®Œæ•´çš„å…¬å¸è¨­ç«‹æµç¨‹...",
      "featured_image": "https://...",
      "author": "admin",
      "published_at": "2025-10-20",
      "views": 156
    }
  ],
  "total": 25,
  "page": 1
}
```

### å–å¾—å–®ç¯‡æ–‡ç« ï¼ˆå…¬é–‹ APIï¼‰
```
GET /api/public/posts/{slug}

Response:
{
  "success": true,
  "post": {
    "title": "å‰µæ¥­å…¬å¸è¨­ç«‹æŒ‡å—",
    "content": "# å…§å®¹...",
    "published_at": "2025-10-20",
    "author": "éœçˆ¾æœæ–¯æœƒè¨ˆå¸«",
    "views": 156
  }
}
```

### å»ºç«‹æ–‡ç« 
```
POST /api/posts

Request:
{
  "title": "æ–°æ–‡ç« æ¨™é¡Œ",
  "content": "# Markdown å…§å®¹...",
  "excerpt": "æ–‡ç« æ‘˜è¦",
  "post_type": "blog",
  "status": "draft",
  "meta_title": "SEO æ¨™é¡Œ",
  "meta_description": "SEO æè¿°"
}

Response:
{
  "success": true,
  "post_id": 2,
  "slug": "new-article-title"
}
```

### ä¸Šå‚³åª’é«”
```
POST /api/media/upload

Request: multipart/form-data
- file: åœ–ç‰‡æª”æ¡ˆ
- alt_text: æ›¿ä»£æ–‡å­—

Response:
{
  "success": true,
  "media": {
    "id": 10,
    "filename": "abc123.jpg",
    "url": "https://r2.../abc123.jpg",
    "width": 1200,
    "height": 800
  }
}
```

### å–å¾—åª’é«”åº«
```
GET /api/media?limit=20&page=1

Response:
{
  "success": true,
  "media": [
    {
      "id": 10,
      "filename": "hero-image.jpg",
      "url": "https://...",
      "file_size": 245678,
      "uploaded_by": "admin",
      "created_at": "2025-10-20"
    }
  ],
  "total": 45
}
```

---

## ğŸ’» å‰ç«¯è¨­è¨ˆ

### é é¢ï¼šcontent-editor.html

#### æ–‡ç« ç·¨è¼¯å™¨
```
[æ¨™é¡Œè¼¸å…¥æ¡†]

[Markdown ç·¨è¼¯å™¨]           [å³æ™‚é è¦½]
# å…§å®¹...                   æ¸²æŸ“å¾Œçš„ HTML

[ç‰¹è‰²åœ–ç‰‡é¸æ“‡]
[å¾åª’é«”åº«é¸æ“‡] [ä¸Šå‚³æ–°åœ–ç‰‡]

SEO è¨­å®š:
Meta æ¨™é¡Œ: [...]
Meta æè¿°: [...]
é—œéµå­—: [...]

[å„²å­˜è‰ç¨¿] [ç™¼å¸ƒ] [é è¦½]
```

#### åª’é«”åº«ç®¡ç†
```
[ä¸Šå‚³åœ–ç‰‡] [æ‰¹æ¬¡ä¸Šå‚³]

æœå°‹: [æœå°‹åª’é«”...]

ç¶²æ ¼è¦–åœ–:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ ğŸ“· â”‚ ğŸ“· â”‚ ğŸ“· â”‚ ğŸ“· â”‚
â”‚img1â”‚img2â”‚img3â”‚img4â”‚
â”‚ âœ“  â”‚    â”‚    â”‚    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

[é¸å–] [åˆªé™¤] [æŸ¥çœ‹è©³æƒ…]
```

### é é¢ï¼šblog.html (å…¬é–‹)

å‰å°éƒ¨è½æ ¼æ–‡ç« åˆ—è¡¨é é¢ã€‚

### é é¢ï¼šresources.html (å…¬é–‹)

å‰å°è³‡æºæ–‡ä»¶åˆ—è¡¨é é¢ã€‚

---

## ğŸ”§ å¯¦æ–½ç´°ç¯€

### Slug è‡ªå‹•ç”Ÿæˆ
```javascript
function generateSlug(title) {
  return title
    .toLowerCase()
    .replace(/[\u4e00-\u9fa5]/g, '')  // ç§»é™¤ä¸­æ–‡
    .replace(/[^a-z0-9]+/g, '-')      // æ›¿æ›ç‰¹æ®Šå­—å…ƒç‚º -
    .replace(/^-+|-+$/g, '');         // ç§»é™¤å‰å¾Œçš„ -
}

// ç¯„ä¾‹
generateSlug("å‰µæ¥­å…¬å¸è¨­ç«‹æŒ‡å— 2025")
// çµæœ: "2025"
// æ‡‰æ”¹é€²ç‚ºæ‹¼éŸ³æˆ–æ‰‹å‹•è¨­å®š
```

### Markdown æ¸²æŸ“
```javascript
// ä½¿ç”¨ marked.js
import { marked } from 'marked';

const htmlContent = marked.parse(markdownContent);
```

### åœ–ç‰‡ä¸Šå‚³è™•ç†
```javascript
async function uploadImage(file) {
  // 1. é©—è­‰æª”æ¡ˆ
  if (!file.type.startsWith('image/')) {
    throw new Error('åªæ”¯æ´åœ–ç‰‡æª”æ¡ˆ');
  }
  
  if (file.size > 5 * 1024 * 1024) {
    throw new Error('æª”æ¡ˆå¤§å°ä¸å¯è¶…é 5MB');
  }
  
  // 2. å£“ç¸®åœ–ç‰‡ï¼ˆå¦‚éœ€è¦ï¼‰
  const compressed = await compressImage(file);
  
  // 3. ä¸Šå‚³åˆ° R2
  const filename = `${Date.now()}_${file.name}`;
  const url = await uploadToR2(compressed, filename);
  
  // 4. è¨˜éŒ„åˆ°è³‡æ–™åº«
  await saveToMediaLibrary({
    filename,
    original_filename: file.name,
    file_path: url,
    file_type: file.type,
    file_size: compressed.size
  });
  
  return url;
}
```

---

## ğŸš€ æœªä¾†æ“´å±•

### è¨ˆåŠƒåŠŸèƒ½
- [ ] æ–‡ç« åˆ†é¡èˆ‡æ¨™ç±¤
- [ ] æ–‡ç« è©•è«–ç³»çµ±
- [ ] æ–‡ç« æ’ç¨‹ç™¼å¸ƒ
- [ ] å¤šä½œè€…å”ä½œ
- [ ] æ–‡ç« ç‰ˆæœ¬æ§åˆ¶
- [ ] æ–‡ç« æœå°‹ï¼ˆå…¨æ–‡æª¢ç´¢ï¼‰
- [ ] ç›¸é—œæ–‡ç« æ¨è–¦
- [ ] é–±è®€æ™‚é–“ä¼°ç®—
- [ ] ç¤¾ç¾¤åˆ†äº«åŠŸèƒ½
- [ ] RSS Feed ç”Ÿæˆ

---

**ç›¸é—œæ–‡æª”**ï¼š
- [ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md](./ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md) - æ•´é«”æ¶æ§‹
- [SEOéƒ¨ç½²æŒ‡å—.md](./SEOéƒ¨ç½²æŒ‡å—.md) - SEO å„ªåŒ–
- [APIç«¯é»æ–‡æª”.md](./APIç«¯é»æ–‡æª”.md) - API åƒè€ƒ

