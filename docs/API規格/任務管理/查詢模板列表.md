# 查詢任務模板列表

**端點：** `GET /api/v1/task-templates`  
**權限：** 管理員

---

## 請求

### 查詢參數
| 參數 | 類型 | 必填 | 說明 |
|-----|------|------|------|
| `include_inactive` | boolean | ❌ | 是否包含停用的模板（預設：false）|

---

## 成功回應

**HTTP 狀態碼：** 200

```json
{
  "success": true,
  "data": [
    {
      "task_template_id": 1,
      "name": "記帳標準流程（雙月）",
      "service_template_id": 3,
      "service_name": "記帳服務 - 收集憑證",
      "description": "雙月記帳服務的標準作業流程",
      "total_days": 8,
      "stage_count": 4,
      "is_active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ]
}
```

---

## 範例程式碼

```typescript
app.get('/api/v1/task-templates', 
  authMiddleware,
  adminOnly,
  async (c) => {
    const { include_inactive = 'false' } = c.req.query();
    
    let sql = `
      SELECT 
        tt.*,
        s.service_name,
        COUNT(tst.stage_template_id) as stage_count
      FROM TaskTemplates tt
      LEFT JOIN Services s ON tt.service_template_id = s.service_id
      LEFT JOIN TaskStageTemplates tst ON tt.task_template_id = tst.task_template_id
      WHERE tt.is_deleted = 0
    `;
    
    if (include_inactive !== 'true') {
      sql += ' AND tt.is_active = 1';
    }
    
    sql += ' GROUP BY tt.task_template_id ORDER BY tt.name';
    
    const templates = await c.env.DB.prepare(sql).all();
    
    return c.json(successResponse(templates.results));
  }
);
```





