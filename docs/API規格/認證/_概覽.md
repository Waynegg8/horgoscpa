# 認證 API 概覽

**API 前綴：** `/api/v1/auth`  
**最後更新：** 2025年10月27日

---

## 端點總覽

| 端點 | 方法 | 權限 | 說明 |
|------|------|------|------|
| `/login` | POST | 公開 | 使用者登入 |
| `/logout` | POST | 需登入 | 使用者登出 |
| `/me` | GET | 需登入 | 驗證當前會話 |
| `/change-password` | POST | 需登入 | 修改密碼 |

---

## 認證機制

### Token 類型
- **JWT Token**（HttpOnly Cookie）
- **有效期限：** 24小時
- **自動續期：** 否（需重新登入）

### Cookie 設定
```javascript
{
  httpOnly: true,      // 防止 XSS
  secure: true,        // 僅 HTTPS
  sameSite: 'strict',  // 防止 CSRF
  maxAge: 86400        // 24小時
}
```

---

## JWT Payload 結構

```typescript
interface JWTPayload {
  user_id: number;     // 使用者ID
  is_admin: boolean;   // 是否為管理員
  iat: number;         // 發行時間
  exp: number;         // 過期時間
}
```

---

## 通用錯誤碼

| 錯誤碼 | HTTP 狀態碼 | 說明 |
|--------|-------------|------|
| `UNAUTHORIZED` | 401 | 未登入或 Token 過期 |
| `INVALID_CREDENTIALS` | 401 | 帳號或密碼錯誤 |
| `ACCOUNT_LOCKED` | 403 | 帳號已被鎖定 |
| `WEAK_PASSWORD` | 422 | 密碼強度不足 |

---

## 安全機制

### F001 - 密碼雜湊
- **演算法：** Argon2id
- **參數：** memoryCost: 65536, timeCost: 3, parallelism: 4

### F007 - 登入失敗鎖定
- **觸發條件：** 連續失敗 5 次
- **鎖定時間：** 15 分鐘

---

## 詳細端點規格

- [登入](./登入.md)
- [登出](./登出.md)
- [驗證當前會話](./驗證當前會話.md)
- [修改密碼](./修改密碼.md)

---

## 相關文檔

- [功能模塊 - 認證系統](../../功能模塊/認證系統.md)（若有）
- [資料庫設計 - Users](../../資料庫設計/核心業務/Users.md)


