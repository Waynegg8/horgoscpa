# 標籤管理 API

**版本：** v1  
**Base URL：** `/api/v1/customer-tags`  
**最後更新：** 2025年10月27日

---

## 查詢列表

**端點：** `GET /customer-tags`  
**權限：** 所有員工

### 查詢參數

| 參數 | 類型 | 必填 | 說明 |
|-----|------|------|------|
| `search` | string | ❌ | 標籤名稱（模糊搜尋）|

### 回應範例

```json
{
  "success": true,
  "data": [
    {
      "tag_id": 1,
      "tag_name": "VIP客戶",
      "tag_color": "#FF5733",
      "tag_description": "重要客戶，優先處理",
      "sort_order": 0,
      "usage_count": 15,
      "created_at": "2025-01-01T00:00:00Z"
    }
  ]
}
```

---

## 新增標籤

**端點：** `POST /customer-tags`  
**權限：** 僅管理員

### 請求 Body

```json
{
  "tag_name": "新標籤",
  "tag_color": "#33A1FF",
  "tag_description": "標籤說明",
  "sort_order": 10
}
```

### 必填欄位
- `tag_name` ✅

### 回應範例

```json
{
  "success": true,
  "data": {
    "tag_id": 7,
    "message": "標籤新增成功"
  }
}
```

### 錯誤回應

```json
{
  "success": false,
  "error": {
    "code": "DUPLICATE_TAG_NAME",
    "message": "標籤名稱已存在"
  }
}
```

---

## 更新標籤

**端點：** `PUT /customer-tags/:tag_id`  
**權限：** 僅管理員

### 請求 Body

```json
{
  "tag_name": "更新後的標籤名稱",
  "tag_color": "#FF33F6",
  "tag_description": "更新後的說明"
}
```

### 回應範例

```json
{
  "success": true,
  "data": {
    "message": "標籤更新成功"
  }
}
```

---

## 刪除標籤

**端點：** `DELETE /customer-tags/:tag_id`  
**權限：** 僅管理員

### 回應範例

```json
{
  "success": true,
  "data": {
    "message": "標籤刪除成功"
  }
}
```

**說明：**
- 使用軟刪除（`is_deleted = 1`）
- 相關的 ClientTagAssignments 會自動移除

---

**相關文檔：**
- [API 概覽](./_概覽.md)
- [客戶 CRUD API](./客戶CRUD.md)


