# 更新客戶

**端點：** `PUT /api/v1/clients/:client_id`  
**權限：** 管理員、會計師（只能更新自己負責的）

---

## 路徑參數

| 參數 | 類型 | 必填 | 說明 |
|-----|------|------|------|
| `client_id` | string | ✅ | 客戶統一編號 |

---

## 請求 Body

```json
{
  "company_name": "冠群資訊股份有限公司",
  "phone": "04-9876-5432",
  "payment_collection_timing": "每月10日",
  "tag_ids": [1, 3]
}
```

**說明：**
- 只需傳送要更新的欄位
- `client_id` 不可更新
- `tag_ids` 會替換所有標籤（非增量）

---

## 成功回應

**HTTP 狀態碼：** 200

```json
{
  "success": true,
  "data": {
    "message": "客戶更新成功"
  }
}
```

---

## 錯誤回應

### 客戶不存在
**HTTP 狀態碼：** 404
```json
{
  "success": false,
  "error": {
    "code": "CLIENT_NOT_FOUND",
    "message": "客戶不存在"
  }
}
```

### 無權限更新
**HTTP 狀態碼：** 403
```json
{
  "success": false,
  "error": {
    "code": "FORBIDDEN",
    "message": "您無權更新此客戶"
  }
}
```

---

## 業務邏輯

### 權限檢查
1. 管理員：可更新所有客戶
2. 會計師：只能更新自己負責的客戶（`assignee_user_id` 匹配）

### 處理流程
1. 驗證客戶是否存在
2. 檢查權限
3. 更新 `Clients` 表（只更新提供的欄位）
4. 若提供 `tag_ids`：
   - 刪除舊的標籤關聯
   - 插入新的標籤關聯
5. 更新 `updated_at` 時間戳

### 不可更新欄位
- `client_id`（主鍵）
- `created_at`
- `is_deleted`


