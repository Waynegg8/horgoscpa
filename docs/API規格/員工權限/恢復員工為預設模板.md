# 恢復員工為預設模板

**端點：** `DELETE /api/v1/settings/module-permissions/users/:user_id`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

刪除員工的所有個別權限設定，讓該員工恢復使用預設模板。

---

## 請求

### 路徑參數

- `user_id` (必填, integer): 員工 ID

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已恢復為預設模板",
  "data": {
    "user_id": 123,
    "is_customized": false
  }
}
```

---

### 錯誤回應

**404 Not Found - 員工不存在：**
```json
{
  "success": false,
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "找不到員工"
  }
}
```

**403 Forbidden - 無權限：**
```json
{
  "success": false,
  "error": {
    "code": "ADMIN_PERMISSION_REQUIRED",
    "message": "需要管理員權限"
  }
}
```

---

## 後端邏輯

```typescript
async function resetUserPermissions(userId: number) {
  // 1. 驗證員工存在
  const user = await getUserById(userId);
  if (!user) {
    throw new Error('USER_NOT_FOUND');
  }
  
  // 2. 刪除所有個別權限設定
  await db.run(`
    DELETE FROM ModulePermissions
    WHERE user_id = ?
  `, [userId]);
  
  // 3. 員工現在使用預設模板
  return {
    user_id: userId,
    is_customized: false
  };
}
```

---

## 使用場景

### 場景：取消員工的所有個別調整

前端「個別調整」Tab 有「恢復為預設」按鈕：
1. 管理員點擊按鈕
2. 系統彈出確認對話框
3. 確認後呼叫此 API
4. 該員工的所有個別設定被清除

---

## 相關端點

- [獲取特定員工的權限](./獲取特定員工的權限.md)
- [更新特定員工的權限](./更新特定員工的權限.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



**端點：** `DELETE /api/v1/settings/module-permissions/users/:user_id`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

刪除員工的所有個別權限設定，讓該員工恢復使用預設模板。

---

## 請求

### 路徑參數

- `user_id` (必填, integer): 員工 ID

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已恢復為預設模板",
  "data": {
    "user_id": 123,
    "is_customized": false
  }
}
```

---

### 錯誤回應

**404 Not Found - 員工不存在：**
```json
{
  "success": false,
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "找不到員工"
  }
}
```

**403 Forbidden - 無權限：**
```json
{
  "success": false,
  "error": {
    "code": "ADMIN_PERMISSION_REQUIRED",
    "message": "需要管理員權限"
  }
}
```

---

## 後端邏輯

```typescript
async function resetUserPermissions(userId: number) {
  // 1. 驗證員工存在
  const user = await getUserById(userId);
  if (!user) {
    throw new Error('USER_NOT_FOUND');
  }
  
  // 2. 刪除所有個別權限設定
  await db.run(`
    DELETE FROM ModulePermissions
    WHERE user_id = ?
  `, [userId]);
  
  // 3. 員工現在使用預設模板
  return {
    user_id: userId,
    is_customized: false
  };
}
```

---

## 使用場景

### 場景：取消員工的所有個別調整

前端「個別調整」Tab 有「恢復為預設」按鈕：
1. 管理員點擊按鈕
2. 系統彈出確認對話框
3. 確認後呼叫此 API
4. 該員工的所有個別設定被清除

---

## 相關端點

- [獲取特定員工的權限](./獲取特定員工的權限.md)
- [更新特定員工的權限](./更新特定員工的權限.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



