# 恢復員工為預設模板

**端點：** `DELETE /api/v1/settings/module-permissions/users/:user_id`  
**權限：** 管理員

---

## 請求

### 路徑參數
- `user_id`: 員工ID（整數）

---

## 成功回應

**HTTP 狀態碼：** 200

```json
{
  "success": true,
  "message": "已恢復為預設模板"
}
```

---

## 業務邏輯

### 步驟
1. 驗證員工是否存在
2. 刪除該員工的所有個別權限設定
3. 員工自動使用預設模板
4. `is_customized` 狀態變為 `false`

### SQL 操作
```sql
DELETE FROM ModulePermissions 
WHERE user_id = ?
```

### 效果
- 清除所有自訂權限
- 員工恢復為預設模板
- 立即生效

---

## 範例程式碼

```typescript
app.delete('/api/v1/settings/module-permissions/users/:user_id', adminOnly, async (c) => {
  const userId = parseInt(c.req.param('user_id'));
  
  // 驗證員工是否存在
  const user = await c.env.DB.prepare(
    'SELECT user_id FROM Users WHERE user_id = ?'
  ).bind(userId).first();
  
  if (!user) {
    return c.json(errorResponse('USER_NOT_FOUND', '員工不存在'), 404);
  }
  
  // 刪除所有個別設定
  await c.env.DB.prepare(`
    DELETE FROM ModulePermissions 
    WHERE user_id = ?
  `).bind(userId).run();
  
  return c.json(successResponse({ message: '已恢復為預設模板' }));
});
```

---

## 前端使用範例

```javascript
async function resetUserPermissions(userId) {
  if (!confirm('確定要恢復為預設模板？')) return;
  
  const response = await fetch(`/api/v1/settings/module-permissions/users/${userId}`, {
    method: 'DELETE',
    credentials: 'include'
  });
  
  if (response.ok) {
    alert('已恢復為預設模板');
    // 重新載入員工權限
    await fetchUserPermissions(userId);
  }
}
```

---

## 使用場景

### 場景 1：批量重置
管理員更新預設模板後，想讓部分員工使用新模板：
1. 呼叫此端點清除自訂權限
2. 員工自動套用最新預設模板

### 場景 2：取消個人化
員工要求取消個人化權限設定，恢復標準配置。


