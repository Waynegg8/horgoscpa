# 新增特休規則

**端點：** `POST /api/v1/settings/annual-leave-rules`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

新增一條特休規則。需確保年資範圍不與現有規則重疊。

---

## 請求

### 請求 Body

```json
{
  "years_of_service_start": 12,
  "years_of_service_end": 23,
  "annual_leave_days": 7,
  "description": "滿1年未滿2年",
  "sort_order": 3
}
```

---

## 驗證規則

- `years_of_service_start`: 必填，非負整數
- `years_of_service_end`: 可選，非負整數或 `null`（表示無上限）
- `annual_leave_days`: 必填，0-30之間的整數
- `description`: 可選，最長 200 字元
- `sort_order`: 可選，整數，預設 0

---

## 回應

### 成功回應（HTTP 201）

```json
{
  "success": true,
  "message": "特休規則已新增，正在重新計算所有員工的特休額度",
  "data": {
    "rule_id": 27,
    "years_of_service_start": 12,
    "years_of_service_end": 23,
    "annual_leave_days": 7,
    "recalculated_employees": 50
  }
}
```

---

### 錯誤回應

**409 Conflict - 年資範圍重疊：**
```json
{
  "success": false,
  "error": {
    "code": "YEARS_RANGE_OVERLAPPING",
    "message": "年資範圍與現有規則重疊"
  }
}
```

---

## 重算邏輯

新增規則後，系統會：
1. 插入新規則
2. 查找所有員工
3. 重新計算每位員工的年資
4. 更新特休額度

---

## 相關端點

- [獲取特休規則列表](./獲取特休規則列表.md)
- [編輯特休規則](./編輯特休規則.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



**端點：** `POST /api/v1/settings/annual-leave-rules`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

新增一條特休規則。需確保年資範圍不與現有規則重疊。

---

## 請求

### 請求 Body

```json
{
  "years_of_service_start": 12,
  "years_of_service_end": 23,
  "annual_leave_days": 7,
  "description": "滿1年未滿2年",
  "sort_order": 3
}
```

---

## 驗證規則

- `years_of_service_start`: 必填，非負整數
- `years_of_service_end`: 可選，非負整數或 `null`（表示無上限）
- `annual_leave_days`: 必填，0-30之間的整數
- `description`: 可選，最長 200 字元
- `sort_order`: 可選，整數，預設 0

---

## 回應

### 成功回應（HTTP 201）

```json
{
  "success": true,
  "message": "特休規則已新增，正在重新計算所有員工的特休額度",
  "data": {
    "rule_id": 27,
    "years_of_service_start": 12,
    "years_of_service_end": 23,
    "annual_leave_days": 7,
    "recalculated_employees": 50
  }
}
```

---

### 錯誤回應

**409 Conflict - 年資範圍重疊：**
```json
{
  "success": false,
  "error": {
    "code": "YEARS_RANGE_OVERLAPPING",
    "message": "年資範圍與現有規則重疊"
  }
}
```

---

## 重算邏輯

新增規則後，系統會：
1. 插入新規則
2. 查找所有員工
3. 重新計算每位員工的年資
4. 更新特休額度

---

## 相關端點

- [獲取特休規則列表](./獲取特休規則列表.md)
- [編輯特休規則](./編輯特休規則.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



