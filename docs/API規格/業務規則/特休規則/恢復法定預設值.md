# 恢復法定預設值

**端點：** `POST /api/v1/settings/annual-leave-rules/reset-defaults`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

將所有特休規則恢復為台灣勞基法規定的法定預設值（26條規則）。會刪除所有現有規則並重新插入法定規則，然後自動重新計算所有員工的特休額度。

---

## 請求

無需參數。

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已恢復為法定預設值，正在重新計算所有員工的特休額度",
  "data": {
    "deleted_count": 5,
    "created_count": 26,
    "recalculated_employees": 100,
    "rules_summary": [
      { "range": "0-5月", "days": 0 },
      { "range": "6-11月", "days": 3 },
      { "range": "12-23月", "days": 7 },
      { "range": "24-35月", "days": 10 },
      { "range": "36-47月", "days": 14 },
      { "range": "48-59月", "days": 14 },
      { "range": "60-71月", "days": 15 },
      { "range": "...", "days": "..." },
      { "range": "288月+", "days": 30 }
    ]
  }
}
```

---

## 法定預設值（26條完整規則）

| 年資範圍（月） | 特休天數 | 說明 |
|--------------|---------|------|
| 0-5 | 0 | 未滿6個月 |
| 6-11 | 3 | 滿6個月未滿1年 |
| 12-23 | 7 | 滿1年未滿2年 |
| 24-35 | 10 | 滿2年未滿3年 |
| 36-47 | 14 | 滿3年未滿4年 |
| 48-59 | 14 | 滿4年未滿5年 |
| 60-71 | 15 | 滿5年未滿6年 |
| 72-83 | 15 | 滿6年未滿7年 |
| ... | ... | ... |
| 120-131 | 16 | 滿10年未滿11年 |
| 132-143 | 17 | 滿11年未滿12年 |
| ... | ... | 每年+1天 |
| 276-287 | 29 | 滿23年未滿24年 |
| 288+ | 30 | 滿24年以上（上限） |

完整規則見：[資料庫設計 - AnnualLeaveRules](../../../../資料庫設計/業務規則/AnnualLeaveRules.md)

---

## 操作邏輯

```typescript
async function resetToDefaults() {
  // 1. 刪除所有現有規則
  await db.run(`DELETE FROM AnnualLeaveRules`);
  
  // 2. 插入26條法定規則
  const defaultRules = [
    { start: 0, end: 5, days: 0, desc: '未滿6個月' },
    { start: 6, end: 11, days: 3, desc: '滿6個月未滿1年' },
    // ... 共26條
  ];
  
  for (const rule of defaultRules) {
    await db.run(`INSERT INTO AnnualLeaveRules (...) VALUES (...)`, rule);
  }
  
  // 3. 重新計算所有員工特休額度
  await recalculateAllEmployeesAnnualLeave();
}
```

---

## 使用場景

### 場景 1：初始設定

新事務所首次設定系統時恢復法定預設值。

---

### 場景 2：規則設定錯誤

管理員設定錯誤後快速恢復。

---

### 場景 3：法規更新

勞基法修訂後批量更新所有規則。

---

## 注意事項

### ⚠️ 重要警告

執行此操作會：
- 刪除所有自訂規則
- 重新計算所有員工特休額度
- 可能影響員工的請假額度

**建議：**
1. 執行前先備份現有規則
2. 通知所有員工
3. 在非工作時間執行

---

## 相關端點

- [獲取特休規則列表](./獲取特休規則列表.md)
- [新增特休規則](./新增特休規則.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



**端點：** `POST /api/v1/settings/annual-leave-rules/reset-defaults`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

將所有特休規則恢復為台灣勞基法規定的法定預設值（26條規則）。會刪除所有現有規則並重新插入法定規則，然後自動重新計算所有員工的特休額度。

---

## 請求

無需參數。

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已恢復為法定預設值，正在重新計算所有員工的特休額度",
  "data": {
    "deleted_count": 5,
    "created_count": 26,
    "recalculated_employees": 100,
    "rules_summary": [
      { "range": "0-5月", "days": 0 },
      { "range": "6-11月", "days": 3 },
      { "range": "12-23月", "days": 7 },
      { "range": "24-35月", "days": 10 },
      { "range": "36-47月", "days": 14 },
      { "range": "48-59月", "days": 14 },
      { "range": "60-71月", "days": 15 },
      { "range": "...", "days": "..." },
      { "range": "288月+", "days": 30 }
    ]
  }
}
```

---

## 法定預設值（26條完整規則）

| 年資範圍（月） | 特休天數 | 說明 |
|--------------|---------|------|
| 0-5 | 0 | 未滿6個月 |
| 6-11 | 3 | 滿6個月未滿1年 |
| 12-23 | 7 | 滿1年未滿2年 |
| 24-35 | 10 | 滿2年未滿3年 |
| 36-47 | 14 | 滿3年未滿4年 |
| 48-59 | 14 | 滿4年未滿5年 |
| 60-71 | 15 | 滿5年未滿6年 |
| 72-83 | 15 | 滿6年未滿7年 |
| ... | ... | ... |
| 120-131 | 16 | 滿10年未滿11年 |
| 132-143 | 17 | 滿11年未滿12年 |
| ... | ... | 每年+1天 |
| 276-287 | 29 | 滿23年未滿24年 |
| 288+ | 30 | 滿24年以上（上限） |

完整規則見：[資料庫設計 - AnnualLeaveRules](../../../../資料庫設計/業務規則/AnnualLeaveRules.md)

---

## 操作邏輯

```typescript
async function resetToDefaults() {
  // 1. 刪除所有現有規則
  await db.run(`DELETE FROM AnnualLeaveRules`);
  
  // 2. 插入26條法定規則
  const defaultRules = [
    { start: 0, end: 5, days: 0, desc: '未滿6個月' },
    { start: 6, end: 11, days: 3, desc: '滿6個月未滿1年' },
    // ... 共26條
  ];
  
  for (const rule of defaultRules) {
    await db.run(`INSERT INTO AnnualLeaveRules (...) VALUES (...)`, rule);
  }
  
  // 3. 重新計算所有員工特休額度
  await recalculateAllEmployeesAnnualLeave();
}
```

---

## 使用場景

### 場景 1：初始設定

新事務所首次設定系統時恢復法定預設值。

---

### 場景 2：規則設定錯誤

管理員設定錯誤後快速恢復。

---

### 場景 3：法規更新

勞基法修訂後批量更新所有規則。

---

## 注意事項

### ⚠️ 重要警告

執行此操作會：
- 刪除所有自訂規則
- 重新計算所有員工特休額度
- 可能影響員工的請假額度

**建議：**
1. 執行前先備份現有規則
2. 通知所有員工
3. 在非工作時間執行

---

## 相關端點

- [獲取特休規則列表](./獲取特休規則列表.md)
- [新增特休規則](./新增特休規則.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



