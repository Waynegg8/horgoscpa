# 標記為歷史費率

**端點：** `DELETE /api/v1/settings/overtime-rates/:id`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

將加班費率標記為歷史費率（軟刪除）。歷史費率不再用於新的工時計算，但保留用於歷史記錄查詢。

---

## 請求

### 路徑參數

- `id` (必填, integer): 費率 ID

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已標記為歷史費率",
  "data": {
    "rate_id": 1,
    "work_day_type": "weekday",
    "rate_multiplier": 1.34,
    "is_active": false,
    "updated_at": "2025-10-27T10:00:00Z"
  }
}
```

---

### 錯誤回應

**404 Not Found：**
```json
{
  "success": false,
  "error": {
    "code": "OVERTIME_RATE_NOT_FOUND",
    "message": "找不到指定的加班費率"
  }
}
```

---

## 軟刪除機制

### 為什麼使用軟刪除？

```
情境：平日加班費率已被使用於 1000 筆工時記錄

如果硬刪除：
❌ 歷史工時記錄失去費率資訊
❌ 無法正確計算歷史加班費
❌ 報表無法顯示費率

使用軟刪除（is_active = false）：
✅ 歷史記錄完整保留
✅ 可正確計算歷史加班費
✅ 新工時計算不使用此費率
✅ 報表正常顯示
```

---

## 標記後的影響

### 工時計算
- ❌ 新的工時記錄不使用此費率
- ✅ 歷史工時記錄仍保留此費率資訊

### 補休結算
- ✅ 月底結算時仍使用原始費率計算加班費
- ✅ 補休異動記錄保留原始費率

---

## 使用場景

### 場景：勞基法費率調整

```
2025年1月1日：勞基法修訂，平日加班第1-2H費率從1.34調整為1.40

操作步驟：
1. 標記舊費率（1.34）為歷史費率
2. 新增新費率（1.40）
3. 2025年1月1日後的工時使用新費率
4. 2024年的工時記錄仍保留舊費率資訊
```

---

## 相關端點

- [恢復法定預設值](./恢復法定預設值.md)
- [查詢使用情況](./查詢使用情況.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



**端點：** `DELETE /api/v1/settings/overtime-rates/:id`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

將加班費率標記為歷史費率（軟刪除）。歷史費率不再用於新的工時計算，但保留用於歷史記錄查詢。

---

## 請求

### 路徑參數

- `id` (必填, integer): 費率 ID

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "已標記為歷史費率",
  "data": {
    "rate_id": 1,
    "work_day_type": "weekday",
    "rate_multiplier": 1.34,
    "is_active": false,
    "updated_at": "2025-10-27T10:00:00Z"
  }
}
```

---

### 錯誤回應

**404 Not Found：**
```json
{
  "success": false,
  "error": {
    "code": "OVERTIME_RATE_NOT_FOUND",
    "message": "找不到指定的加班費率"
  }
}
```

---

## 軟刪除機制

### 為什麼使用軟刪除？

```
情境：平日加班費率已被使用於 1000 筆工時記錄

如果硬刪除：
❌ 歷史工時記錄失去費率資訊
❌ 無法正確計算歷史加班費
❌ 報表無法顯示費率

使用軟刪除（is_active = false）：
✅ 歷史記錄完整保留
✅ 可正確計算歷史加班費
✅ 新工時計算不使用此費率
✅ 報表正常顯示
```

---

## 標記後的影響

### 工時計算
- ❌ 新的工時記錄不使用此費率
- ✅ 歷史工時記錄仍保留此費率資訊

### 補休結算
- ✅ 月底結算時仍使用原始費率計算加班費
- ✅ 補休異動記錄保留原始費率

---

## 使用場景

### 場景：勞基法費率調整

```
2025年1月1日：勞基法修訂，平日加班第1-2H費率從1.34調整為1.40

操作步驟：
1. 標記舊費率（1.34）為歷史費率
2. 新增新費率（1.40）
3. 2025年1月1日後的工時使用新費率
4. 2024年的工時記錄仍保留舊費率資訊
```

---

## 相關端點

- [恢復法定預設值](./恢復法定預設值.md)
- [查詢使用情況](./查詢使用情況.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



