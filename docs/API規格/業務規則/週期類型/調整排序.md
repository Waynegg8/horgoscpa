# 調整排序

**端點：** `PUT /api/v1/settings/service-frequency-types/reorder`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

批量調整服務週期類型的顯示順序。

---

## 請求

### 請求 Body

```json
{
  "ordered_ids": [3, 1, 2, 4, 5]
}
```

**說明：** 陣列中的順序即為新的排序，第一個 ID 的 `sort_order` 為 1，第二個為 2，以此類推。

---

## 驗證規則

- `ordered_ids`: 必填，整數陣列
- 陣列中的 ID 必須全部存在
- 不需要包含所有 ID（未包含的保持原排序）

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "排序已更新",
  "data": {
    "updated_count": 5,
    "new_order": [
      { "frequency_type_id": 3, "name": "季結", "sort_order": 1 },
      { "frequency_type_id": 1, "name": "月結", "sort_order": 2 },
      { "frequency_type_id": 2, "name": "雙月結", "sort_order": 3 },
      { "frequency_type_id": 4, "name": "年結", "sort_order": 4 },
      { "frequency_type_id": 5, "name": "一次性", "sort_order": 5 }
    ]
  }
}
```

---

### 錯誤回應

**400 Bad Request - 包含不存在的 ID：**
```json
{
  "success": false,
  "error": {
    "code": "INVALID_FREQUENCY_TYPE_IDS",
    "message": "包含不存在的週期類型 ID"
  }
}
```

---

## 使用場景

### 場景：調整最常用的週期類型到前面

管理員發現「季結」最常用，希望調整到第一位：

**請求：**
```json
{
  "ordered_ids": [3, 1, 2, 4, 5]
}
```

**結果：** 季結顯示在第一位，方便選擇

---

## 前端實現建議

```typescript
// 使用拖放排序
async function handleDragEnd(result) {
  const newOrder = reorderArray(frequencyTypes, result.source.index, result.destination.index);
  const ordered_ids = newOrder.map(item => item.frequency_type_id);
  
  await api.put('/api/v1/settings/service-frequency-types/reorder', { ordered_ids });
}
```

---

## 相關端點

- [獲取週期類型列表](./獲取週期類型列表.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



**端點：** `PUT /api/v1/settings/service-frequency-types/reorder`  
**權限：** 管理員  
**最後更新：** 2025年10月27日

---

## 概述

批量調整服務週期類型的顯示順序。

---

## 請求

### 請求 Body

```json
{
  "ordered_ids": [3, 1, 2, 4, 5]
}
```

**說明：** 陣列中的順序即為新的排序，第一個 ID 的 `sort_order` 為 1，第二個為 2，以此類推。

---

## 驗證規則

- `ordered_ids`: 必填，整數陣列
- 陣列中的 ID 必須全部存在
- 不需要包含所有 ID（未包含的保持原排序）

---

## 回應

### 成功回應（HTTP 200）

```json
{
  "success": true,
  "message": "排序已更新",
  "data": {
    "updated_count": 5,
    "new_order": [
      { "frequency_type_id": 3, "name": "季結", "sort_order": 1 },
      { "frequency_type_id": 1, "name": "月結", "sort_order": 2 },
      { "frequency_type_id": 2, "name": "雙月結", "sort_order": 3 },
      { "frequency_type_id": 4, "name": "年結", "sort_order": 4 },
      { "frequency_type_id": 5, "name": "一次性", "sort_order": 5 }
    ]
  }
}
```

---

### 錯誤回應

**400 Bad Request - 包含不存在的 ID：**
```json
{
  "success": false,
  "error": {
    "code": "INVALID_FREQUENCY_TYPE_IDS",
    "message": "包含不存在的週期類型 ID"
  }
}
```

---

## 使用場景

### 場景：調整最常用的週期類型到前面

管理員發現「季結」最常用，希望調整到第一位：

**請求：**
```json
{
  "ordered_ids": [3, 1, 2, 4, 5]
}
```

**結果：** 季結顯示在第一位，方便選擇

---

## 前端實現建議

```typescript
// 使用拖放排序
async function handleDragEnd(result) {
  const newOrder = reorderArray(frequencyTypes, result.source.index, result.destination.index);
  const ordered_ids = newOrder.map(item => item.frequency_type_id);
  
  await api.put('/api/v1/settings/service-frequency-types/reorder', { ordered_ids });
}
```

---

## 相關端點

- [獲取週期類型列表](./獲取週期類型列表.md)
- [API 概覽](./_概覽.md)

---

**最後更新：** 2025年10月27日



