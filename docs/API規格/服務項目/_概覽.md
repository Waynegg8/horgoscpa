# 服務項目 API 概覽

**API 前綴：** `/api/v1/services`  
**最後更新：** 2025年10月27日

---

## 端點總覽

| 端點 | 方法 | 權限 | 說明 |
|------|------|------|------|
| `/services` | GET | 需權限 | 查詢服務列表（含層級結構）|
| `/services/:id` | GET | 需權限 | 查詢特定服務詳情 |
| `/services` | POST | 管理員/有權限員工 | 新增服務項目 |
| `/services/:id` | PUT | 管理員/有權限員工 | 更新服務項目 |
| `/services/:id` | DELETE | 管理員/有權限員工 | 刪除服務項目 |

---

## 認證

所有 API 需要 JWT 認證：
```
Cookie: auth_token=<JWT_TOKEN>
```

---

## 標準回應格式

### 成功
```json
{
  "success": true,
  "data": { ... }
}
```

### 錯誤
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "錯誤訊息"
  }
}
```

---

## 錯誤代碼

| 代碼 | HTTP狀態 | 說明 |
|-----|---------|------|
| `SERVICE_NOT_FOUND` | 404 | 服務項目不存在 |
| `DUPLICATE_SERVICE_NAME` | 409 | 服務名稱已存在 |
| `INVALID_HIERARCHY` | 400 | 不允許三層結構 |
| `SERVICE_IN_USE` | 409 | 服務項目已被使用，無法刪除 |
| `PERMISSION_DENIED` | 403 | 無權限 |
| `VALIDATION_ERROR` | 422 | 驗證錯誤 |

---

## 資料模型

### Service
```typescript
interface Service {
  service_id: number;
  parent_service_id: number | null;
  service_name: string;
  description: string | null;
  sort_order: number;
  is_active: boolean;
  created_by: number;
  created_by_name: string;
  created_at: string;
  updated_at: string;
  children?: Service[];  // 子項目陣列（僅查詢列表時）
}
```

---

## 詳細端點規格

- [查詢服務列表](./查詢服務列表.md)
- [查詢服務詳情](./查詢服務詳情.md)
- [新增服務項目](./新增服務項目.md)
- [更新服務項目](./更新服務項目.md)
- [刪除服務項目](./刪除服務項目.md)

---

## 相關文檔

- [功能模塊 - 服務項目管理](../../功能模塊/03-服務項目管理.md)
- [技術規格 - UI設計](../../技術規格/服務項目/UI設計.md)
- [技術規格 - 業務邏輯](../../技術規格/服務項目/業務邏輯.md)
- [資料庫設計 - Services](../../資料庫設計/服務項目/Services.md)





