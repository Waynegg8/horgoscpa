# 查詢儀表板數據

**端點：** `GET /api/v1/dashboard`  
**權限：** 所有員工

---

## 成功回應

**HTTP 狀態碼：** 200

```json
{
  "success": true,
  "data": {
    "tasks": [
      {
        "task_id": 1,
        "client_id": "12345678",
        "client_name": "冠群資訊",
        "task_name": "記帳 - 11月",
        "progress": 50,
        "expected_due_date": "2025-11-15",
        "status": "in_progress"
      }
    ],
    "stages": [
      {
        "active_stage_id": 5,
        "task_name": "記帳 - 11月",
        "stage_name": "營業稅過帳",
        "expected_due_date": "2025-11-06",
        "status": "in_progress"
      }
    ],
    "monthlyHours": {
      "normal": 120,
      "weighted": 135.5
    },
    "leaveBalances": [
      {
        "leave_type_id": 1,
        "leave_type_name": "特休",
        "balance": 80,
        "used": 16
      },
      {
        "leave_type_id": 2,
        "leave_type_name": "病假",
        "balance": 30,
        "used": 8
      }
    ]
  }
}
```

---

## 業務邏輯

### 數據來源
- **我的任務**：來自 `ActiveTasks` 表，狀態為 pending 或 in_progress，按到期日排序，限制5筆
- **待辦階段**：來自 `ActiveTaskStages` 表，狀態為 in_progress，按到期日排序
- **本月工時**：來自 `TimeLogs` 表，查詢當月數據並統計
- **假期餘額**：來自 `LeaveBalances` 表，查詢當年數據

### 權限
- 員工只能查看自己的儀表板數據
- 管理員可以查看所有員工的數據（透過 `user_id` 參數）





