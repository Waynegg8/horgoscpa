# 🧪 測試服務項目與任務模板管理

> **快速測試指南** - 確保新功能正常運作

---

## 🎯 測試前準備

1. **確保已登入** 並具有管理員權限
2. **訪問系統設定頁面**：`https://www.horgoscpa.com/internal/settings`
3. **打開瀏覽器開發者工具**（F12）查看Console日誌

---

## ✅ 測試清單

### 1. 測試Tab切換功能

- [ ] 點擊「服務項目」tab，應該顯示服務項目管理界面
- [ ] 點擊「任務模板」tab，應該顯示任務模板管理界面
- [ ] 其他tab應該隱藏
- [ ] Console沒有錯誤訊息

**預期結果：** 只有當前tab的內容顯示，其他內容隱藏

---

### 2. 測試服務項目列表

切換到「服務項目」tab

**應該看到：**
- [ ] 表格顯示5個預設服務項目：
  1. 記帳服務（ACCOUNTING）
  2. 稅務申報（TAX_FILING）
  3. 顧問諮詢（CONSULTING）
  4. 工商登記（BUSINESS_REG）
  5. 審計服務（AUDIT）

**每行包含：**
- [ ] 服務ID
- [ ] 服務名稱（粗體）
- [ ] 服務代碼
- [ ] 說明
- [ ] 排序
- [ ] 狀態徽章（綠色「啟用」）
- [ ] 編輯、刪除按鈕

---

### 3. 測試點擊查看子項目

**步驟：**
1. 點擊「記帳服務」這一行（任意位置）
2. 觀察頁面下方

**預期結果：**
- [ ] 下方出現「記帳服務 - 子項目列表」卡片
- [ ] 顯示4個子項目：
  - 收集憑證（ACC_COLLECT）
  - 輸入帳務（ACC_INPUT）
  - 月結對帳（ACC_RECONCILE）
  - 報表產製（ACC_REPORT）

**再次測試：**
1. 點擊「稅務申報」
2. 確認子項目更新為稅務申報的4個子項目

---

### 4. 測試刪除服務子項目

**⚠️ 注意：** 這是實際刪除操作，請小心測試

**步驟：**
1. 點擊任一服務（例如「記帳服務」）
2. 在子項目列表中，點擊最後一個子項目的「刪除」按鈕
3. 確認刪除對話框
4. 點擊「確定」

**預期結果：**
- [ ] 顯示成功訊息
- [ ] 該子項目從列表中消失
- [ ] 可以通過重新點擊服務來刷新列表

**恢復數據（如需要）：**
- 可以通過執行migration重新初始化數據

---

### 5. 測試編輯按鈕（佔位符）

**步驟：**
1. 點擊任一服務的「編輯」按鈕

**預期結果：**
- [ ] 出現Alert提示：「編輯服務項目功能開發中...」
- [ ] 顯示服務ID
- [ ] 提示需要Modal對話框

---

### 6. 測試任務模板列表

切換到「任務模板」tab

**應該看到：**
- [ ] 表格載入中提示消失
- [ ] 顯示任務模板列表（可能為空或有既有模板）

**檢查篩選器：**
- [ ] 下拉選單顯示「所有服務」
- [ ] 下拉選單包含5個服務選項
- [ ] 可以選擇不同服務進行篩選

---

### 7. 測試任務模板篩選

**步驟：**
1. 在下拉選單中選擇「記帳服務」
2. 點擊「篩選」按鈕
3. 觀察表格變化

**預期結果：**
- [ ] 只顯示service_id=1的模板
- [ ] 或顯示「暫無任務模板」

**恢復：**
- 選擇「所有服務」並篩選，恢復顯示所有模板

---

### 8. 測試API響應（開發者工具）

打開Network tab，刷新頁面

**檢查API調用：**
- [ ] `GET /internal/api/v1/services` - 狀態碼200
- [ ] `GET /internal/api/v1/task-templates` - 狀態碼200

點擊一個服務：
- [ ] `GET /internal/api/v1/services/:id/items` - 狀態碼200

**檢查響應格式：**
```json
{
  "ok": true,
  "code": "SUCCESS",
  "message": "查询成功",
  "data": [...]
}
```

---

### 9. 測試響應式設計

**桌面（1920x1080）：**
- [ ] Tab導航完整顯示
- [ ] 表格所有列都可見
- [ ] 按鈕正常顯示

**平板（768x1024）：**
- [ ] Tab導航可能需要滾動
- [ ] 表格仍可讀

**手機（375x667）：**
- [ ] Tab導航適配小螢幕
- [ ] 表格可橫向滾動
- [ ] 按鈕大小適中

---

### 10. 測試錯誤處理

**測試未登入狀態：**
1. 清除cookies
2. 訪問settings頁面
3. **預期：** 重定向到登入頁面

**測試非管理員：**
1. 使用非管理員帳號登入
2. 嘗試訪問settings
3. **預期：** 顯示權限不足提示

---

## 🐛 常見問題排查

### 問題1：點擊Tab沒有反應

**檢查：**
1. 打開Console，查看是否有JavaScript錯誤
2. 檢查是否看到「找到 17 個tab按鈕」日誌
3. 檢查是否看到「點擊tab: services」日誌

**解決：**
- 強制刷新頁面（Ctrl+Shift+R）
- 清除瀏覽器緩存

### 問題2：服務項目列表顯示「載入失敗」

**檢查：**
1. Network tab中查看API調用狀態
2. 檢查是否返回401（未登入）或403（無權限）

**解決：**
- 重新登入
- 確認具有管理員權限

### 問題3：子項目列表不顯示

**檢查：**
1. 確認是否點擊了服務行
2. Console是否有「selectService」日誌
3. API調用是否成功

**解決：**
- 重新點擊服務項目
- 檢查Network tab中的API響應

### 問題4：刪除後列表沒有更新

**原因：** 這是正常的，需要手動刷新

**解決：**
- 重新點擊服務項目查看子項目
- 刷新整個頁面

---

## 📊 測試數據參考

### 預設服務項目（5個）

| ID | 名稱 | 代碼 | 子項目數量 |
|----|------|------|-----------|
| 1 | 記帳服務 | ACCOUNTING | 4 |
| 2 | 稅務申報 | TAX_FILING | 4 |
| 3 | 顧問諮詢 | CONSULTING | 4 |
| 4 | 工商登記 | BUSINESS_REG | 4 |
| 5 | 審計服務 | AUDIT | 4 |

**總計：** 5個服務，20個子項目

---

## ✅ 測試完成檢查表

完成所有測試後，確認：

- [ ] 所有Tab可以正常切換
- [ ] 服務項目列表正確顯示
- [ ] 點擊服務可以查看子項目
- [ ] 刪除功能正常運作
- [ ] 編輯按鈕顯示開發中提示
- [ ] 任務模板列表正確顯示
- [ ] 篩選功能正常運作
- [ ] API調用都返回200
- [ ] Console沒有錯誤訊息
- [ ] 響應式設計適配不同螢幕

---

## 📝 回報問題

如果發現問題，請記錄：

1. **問題描述**
2. **重現步驟**
3. **預期行為**
4. **實際行為**
5. **Console錯誤訊息**
6. **Network請求詳情**
7. **瀏覽器和版本**
8. **螢幕截圖**

---

**測試日期：** ________________  
**測試人員：** ________________  
**測試結果：** □ 通過  □ 部分通過  □ 未通過  
**備註：** _______________________________________________

