# ç³»çµ±è¨­å®šèˆ‡å·¥ä½œå°è¨­è¨ˆ

**ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025-10-26

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

### ç³»çµ±è¨­å®š (settings.html)
çµ±ä¸€ç®¡ç†ç³»çµ±å„é …è¨­å®šï¼ŒåŒ…å«å“¡å·¥ç®¡ç†ã€å®¢æˆ¶ç®¡ç†ã€ç³»çµ±åƒæ•¸ç­‰ã€‚

**æ ¸å¿ƒå„ªåŒ–** - âœ… å·²å¯¦æ–½ï¼š
- âœ… **ç¶²é åŒ–é…ç½®ç®¡ç†**ï¼šæ‰€æœ‰ç³»çµ±åƒæ•¸éƒ½èƒ½åœ¨ç¶²é ä¸­ä¿®æ”¹ï¼Œç„¡éœ€ç·¨è¼¯ä»£ç¢¼ï¼ˆâœ… å·²å¯¦æ–½ 2025-10-26ï¼‰
- âœ… **è¦–è¦ºåŒ–ç·¨è¼¯å™¨**ï¼šæä¾›å¤šç¨®ç·¨è¼¯å™¨é¡å‹ï¼ˆæ•¸å­—ã€é–‹é—œã€ä¸‹æ‹‰é¸å–®ç­‰ï¼‰ï¼ˆâœ… å·²å¯¦æ–½ 2025-10-26ï¼‰
- âœ… **å³æ™‚é©—è­‰**ï¼šè¼¸å…¥æ™‚å³æ™‚æª¢æŸ¥æœ‰æ•ˆæ€§ï¼ˆâœ… è³‡æ–™è¡¨æ”¯æ´ï¼Œå‰ç«¯éƒ¨åˆ†å¯¦æ–½ï¼‰
- âœ… **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æ´æ‰¹é‡ä¿®æ”¹å’Œé‡ç½®ï¼ˆâœ… APIå·²å¯¦æ–½ 2025-10-26ï¼‰

### å·¥ä½œå° (dashboard.html)
æä¾›å€‹äººåŒ–çš„å·¥ä½œå„€è¡¨æ¿ï¼Œé¡¯ç¤ºå¾…è¾¦ä»»å‹™ã€å·¥æ™‚çµ±è¨ˆç­‰ã€‚

---

## ğŸ—„ï¸ è³‡æ–™è¡¨çµæ§‹

### employees (å“¡å·¥è³‡æ–™)
```sql
CREATE TABLE employees (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,                -- å“¡å·¥å§“å
  employee_id TEXT UNIQUE,           -- å“¡å·¥ç·¨è™Ÿ
  department TEXT,                   -- éƒ¨é–€
  position TEXT,                     -- è·ä½
  hire_date DATE,                    -- åˆ°è·æ—¥æœŸ
  birth_date DATE,                   -- ç”Ÿæ—¥
  phone TEXT,
  email TEXT,
  address TEXT,
  emergency_contact TEXT,            -- ç·Šæ€¥è¯çµ¡äºº
  emergency_phone TEXT,              -- ç·Šæ€¥è¯çµ¡é›»è©±
  status TEXT DEFAULT 'active',      -- active, resigned, on_leave
  resignation_date DATE,             -- é›¢è·æ—¥æœŸ
  notes TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### system_parameters (ç³»çµ±åƒæ•¸) - å·²å„ªåŒ–
```sql
CREATE TABLE system_parameters (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  param_key TEXT NOT NULL UNIQUE,    -- åƒæ•¸éµå€¼
  param_value TEXT,                  -- åƒæ•¸å€¼
  param_type TEXT,                   -- string, number, boolean, json
  editor_type TEXT DEFAULT 'text',   -- ç·¨è¼¯å™¨é¡å‹ï¼ˆæ–°å¢ï¼‰
  description TEXT,                  -- åƒæ•¸èªªæ˜
  category TEXT,                     -- åƒæ•¸åˆ†é¡
  validation_rule TEXT,              -- é©—è­‰è¦å‰‡ JSONï¼ˆæ–°å¢ï¼‰
  help_text TEXT,                    -- å¹«åŠ©æç¤ºï¼ˆæ–°å¢ï¼‰
  display_order INTEGER DEFAULT 0,   -- é¡¯ç¤ºé †åºï¼ˆæ–°å¢ï¼‰
  is_editable BOOLEAN DEFAULT 1,     -- æ˜¯å¦å¯ç·¨è¼¯
  is_visible BOOLEAN DEFAULT 1,      -- æ˜¯å¦åœ¨è¨­å®šé é¢é¡¯ç¤ºï¼ˆæ–°å¢ï¼‰
  updated_by TEXT,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

**æ”¯æ´çš„ç·¨è¼¯å™¨é¡å‹**ï¼š
- `text` - æ–‡å­—è¼¸å…¥æ¡†
- `number` - æ•¸å­—è¼¸å…¥æ¡†
- `boolean` - é–‹é—œæŒ‰éˆ•
- `select` - ä¸‹æ‹‰é¸å–®
- `textarea` - å¤šè¡Œæ–‡å­—
- `time` - æ™‚é–“é¸æ“‡å™¨
- `date` - æ—¥æœŸé¸æ“‡å™¨
- `email` - Email è¼¸å…¥æ¡†
- `password` - å¯†ç¢¼è¼¸å…¥æ¡†

**ç³»çµ±åƒæ•¸ç¯„ä¾‹**ï¼š
```sql
INSERT INTO system_parameters (param_key, param_value, param_type, description, category) VALUES
  ('company_name', 'éœçˆ¾æœæ–¯æœƒè¨ˆå¸«äº‹å‹™æ‰€', 'string', 'å…¬å¸åç¨±', 'general'),
  ('work_hours_per_day', '8', 'number', 'æ¯æ—¥æ¨™æº–å·¥æ™‚', 'timesheet'),
  ('annual_leave_enabled', 'true', 'boolean', 'å•Ÿç”¨å¹´å‡ç®¡ç†', 'leave'),
  ('overtime_rates', '{"weekday": 1.34, "weekend": 1.67}', 'json', 'åŠ ç­è²»ç‡', 'timesheet');
```

### user_reminders (ç”¨æˆ¶æé†’) - ç°¡åŒ–ç‰ˆ
```sql
-- ç°¡åŒ–çš„æé†’è¡¨ï¼Œç›´æ¥åœ¨å·¥ä½œå°é¡¯ç¤º
CREATE TABLE user_reminders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  reminder_type TEXT NOT NULL,       -- annual_leave_expiry, task_due, timesheet_reminder
  message TEXT NOT NULL,             -- æé†’è¨Šæ¯
  related_id INTEGER,                -- ç›¸é—œä»»å‹™æˆ–è¨˜éŒ„ ID
  is_read BOOLEAN DEFAULT 0,
  priority TEXT DEFAULT 'normal',    -- low, normal, high
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  expires_at DATETIME,               -- æé†’éæœŸæ™‚é–“
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

**æé†’é¡å‹**ï¼š
- `annual_leave_expiry` - å¹´å‡å³å°‡åˆ°æœŸ
- `task_due` - ä»»å‹™å³å°‡åˆ°æœŸ
- `timesheet_reminder` - å·¥æ™‚æœªå¡«å¯«æé†’
- `overtime_alert` - åŠ ç­æ™‚æ•¸æé†’

---

## ğŸ’» ç³»çµ±è¨­å®šé é¢è¨­è¨ˆ

### settings.html æ¨™ç±¤çµæ§‹ï¼ˆå·²å„ªåŒ–ï¼‰

```
[å“¡å·¥ç®¡ç†] [å®¢æˆ¶ç®¡ç†] [ç³»çµ±åƒæ•¸] [ä»»å‹™ç¯„æœ¬] [æ¥­å‹™é¡å‹] [é…ç½®ç®¡ç†]
```

**æ–°å¢ï¼šé…ç½®ç®¡ç†æ¨™ç±¤**
- å·¥æ™‚è¦å‰‡ï¼ˆæ¯æ—¥å·¥æ™‚ã€åŠ ç­è²»ç‡ï¼‰
- å¹´å‡è¦å‰‡ï¼ˆå¹´å‡å¤©æ•¸ã€çµè½‰è¦å‰‡ï¼‰
- è‡ªå‹•åŒ–è¨­å®šï¼ˆä»»å‹™ç”Ÿæˆæ™‚é–“ã€æå‰å¤©æ•¸ï¼‰

#### æ¨™ç±¤ 1: å“¡å·¥ç®¡ç†
```
å“¡å·¥åˆ—è¡¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[+ æ–°å¢å“¡å·¥]  æœå°‹: [æœå°‹å“¡å·¥...]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¼µç´œè“                              â”‚
â”‚ æœƒè¨ˆéƒ¨ | æœƒè¨ˆå¸« | 2020-01-15 åˆ°è·  â”‚
â”‚ user1@example.com                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ç·¨è¼¯] [åœç”¨] [æŸ¥çœ‹å·¥æ™‚]
```

#### æ¨™ç±¤ 2: å®¢æˆ¶ç®¡ç†
```
å®¢æˆ¶åˆ—è¡¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[+ æ–°å¢å®¢æˆ¶]  æœå°‹: [æœå°‹å®¢æˆ¶...]  ç‹€æ…‹: [å…¨éƒ¨â–¾]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ABCç§‘æŠ€å…¬å¸                         â”‚
â”‚ çµ±ç·¨: 12345678 | è¯çµ¡äºº: ç‹å°æ˜     â”‚
â”‚ æœå‹™: è¨˜å¸³(æœˆ)ã€ç‡Ÿæ¥­ç¨…(é›™æœˆ)        â”‚
â”‚ è² è²¬: ç´œè“                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[æŸ¥çœ‹è©³æƒ…] [ç·¨è¼¯] [æœå‹™é…ç½®]
```

#### æ¨™ç±¤ 3: ç³»çµ±åƒæ•¸ï¼ˆå·²å„ªåŒ–ç‚ºå‹•æ…‹è¡¨å–®ï¼‰
```
ç³»çµ±åƒæ•¸è¨­å®š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[å·¥æ™‚è¦å‰‡] [å¹´å‡è¦å‰‡] [è‡ªå‹•åŒ–è¨­å®š] å­æ¨™ç±¤åˆ‡æ›

=== å·¥æ™‚è¦å‰‡ ===
âœï¸ æ¨™æº–å·¥æ™‚
â”œâ”€ æ¯æ—¥æ¨™æº–å·¥æ™‚: [8] å°æ™‚ (ç¯„åœ: 1-24)
â”œâ”€ æ¯é€±å·¥ä½œå¤©æ•¸: [5] å¤©
â””â”€ åˆä¼‘æ™‚é–“: [12:00] è‡³ [13:00]

âœï¸ åŠ ç­è²»ç‡
â”œâ”€ å¹³æ—¥å»¶é•·: [1.34] å€ ğŸ’¡ å‹åŸºæ³•è¦å®š
â”œâ”€ ä¼‘æ¯æ—¥: [1.67] å€
â””â”€ åœ‹å®šå‡æ—¥: [2.00] å€

=== å¹´å‡è¦å‰‡ ===
âœï¸ å¹´å‡è¨ˆç®—
â”œâ”€ å•Ÿç”¨å¹´å‡ç®¡ç†: â˜‘
â”œâ”€ å…è¨±çµè½‰: â˜‘
â”œâ”€ æœ€å¤šçµè½‰å¤©æ•¸: [5] å¤© (ç¯„åœ: 0-30)
â””â”€ çµè½‰æœŸé™: [æ¬¡å¹´ 12 æœˆ 31 æ—¥]

=== è‡ªå‹•åŒ–è¨­å®š ===
âœï¸ ä»»å‹™è‡ªå‹•ç”Ÿæˆ
â”œâ”€ å•Ÿç”¨è‡ªå‹•ç”Ÿæˆ: â˜‘
â”œâ”€ åŸ·è¡Œæ™‚é–“: [00:00] (å°åŒ—æ™‚é–“)
â”œâ”€ é è¨­æå‰å¤©æ•¸: [7] å¤©
â”œâ”€ é è¨­ä»»å‹™æœŸé™: [15] å¤©
â””â”€ é‡å‡æ—¥è™•ç†: [æå‰è‡³å‡æ—¥å‰ â–¾]

ğŸ’¾ [å„²å­˜æ‰€æœ‰è¨­å®š] [é‡ç½®ç‚ºé è¨­å€¼]

æç¤ºï¼šæ‰€æœ‰åƒæ•¸éƒ½æœ‰å³æ™‚é©—è­‰å’Œå¹«åŠ©èªªæ˜
```

#### æ¨™ç±¤ 4: ä»»å‹™ç¯„æœ¬
```
ä»»å‹™ç¯„æœ¬ç®¡ç†
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[+ æ–°å¢ç¯„æœ¬]  åˆ†é¡: [å…¨éƒ¨â–¾]

å¤šéšæ®µä»»å‹™ç¯„æœ¬:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‡Ÿæ¥­ç¨…ç”³å ±æµç¨‹                      â”‚
â”‚ 8 å€‹éšæ®µ | ä½¿ç”¨æ¬¡æ•¸: 45            â”‚
â”‚ é ä¼°å·¥æ™‚: 7.5 å°æ™‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ç·¨è¼¯] [è¤‡è£½] [åˆªé™¤] [æŸ¥çœ‹çµ±è¨ˆ]
```

#### æ¨™ç±¤ 5: æ¥­å‹™é¡å‹
```
æ¥­å‹™é¡å‹ç®¡ç†
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[+ æ–°å¢æ¥­å‹™é¡å‹]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœƒè¨ˆæœå‹™                            â”‚
â”‚ ä»£ç¢¼: accounting                    â”‚
â”‚ å®¢æˆ¶æ•¸: 25 | SOP æ•¸: 8             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ç·¨è¼¯] [æŸ¥çœ‹å®¢æˆ¶] [æŸ¥çœ‹ SOP]
```

---

## ğŸ’» å·¥ä½œå°é é¢è¨­è¨ˆ

### dashboard.html ä½ˆå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ­¡è¿å›ä¾†ï¼Œå¼µç´œè“                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ‘çš„ä»»å‹™     â”‚ â”‚ æœ¬æœˆå·¥æ™‚     â”‚ â”‚ å¹´å‡é¤˜é¡     â”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚   5 å€‹       â”‚ â”‚  168 å°æ™‚    â”‚ â”‚   10 å¤©      â”‚
â”‚   å¾…è™•ç†     â”‚ â”‚  +15 åŠ ç­    â”‚ â”‚   /15 å¤©     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ä»Šæ—¥å¾…è¾¦ (3)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ ABCå…¬å¸ - 10æœˆç‡Ÿæ¥­ç¨…ç”³å ± (ä»Šå¤©æˆªæ­¢)          â”‚
â”‚ â–¡ XYZå…¬å¸ - è¨˜å¸³æœå‹™ (æ˜å¤©æˆªæ­¢)                â”‚
â”‚ â–¡ å¯©æ ¸æå››çš„è«‹å‡ç”³è«‹                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š æœ¬é€±å·¥æ™‚åˆ†æ      â”‚ â”‚ ğŸ“… è¿‘æœŸæ’ç¨‹         â”‚
â”‚                      â”‚ â”‚                     â”‚
â”‚ [å·¥æ™‚è¶¨å‹¢åœ–]         â”‚ â”‚ 10/28 - 2å€‹ä»»å‹™     â”‚
â”‚                      â”‚ â”‚ 10/29 - 1å€‹ä»»å‹™     â”‚
â”‚                      â”‚ â”‚ 10/30 - 3å€‹ä»»å‹™     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ é‡è¦æé†’                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ å¹´å‡å°‡æ–¼ 2025-12-31 åˆ°æœŸï¼Œå‰©é¤˜ 10 å¤©æœªä¼‘     â”‚
â”‚ â€¢ ABCå…¬å¸ä»»å‹™å³å°‡æ–¼ä»Šå¤©æˆªæ­¢                     â”‚
â”‚ â€¢ æœ¬æœˆå·¥æ™‚å·²é” 168 å°æ™‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ å·¥ä½œå° API è¨­è¨ˆ

### å–å¾—å·¥ä½œå°è³‡æ–™ï¼ˆå«æé†’ï¼‰
```
GET /api/dashboard/summary

Response:
{
  "success": true,
  "summary": {
    "my_tasks": {
      "total": 5,
      "pending": 3,
      "in_progress": 2,
      "due_today": 1
    },
    "timesheet": {
      "current_month": {
        "regular_hours": 168,
        "overtime_hours": 15,
        "work_days": 21
      }
    },
    "annual_leave": {
      "remaining_days": 10,
      "total_days": 15,
      "expiry_date": "2025-12-31",
      "days_until_expiry": 65
    },
    "upcoming_tasks": [
      {
        "task_id": 123,
        "title": "ABCå…¬å¸ - ç‡Ÿæ¥­ç¨…ç”³å ±",
        "due_date": "2025-10-28",
        "priority": "high"
      }
    ],
    "reminders": [
      {
        "id": 1,
        "type": "annual_leave_expiry",
        "message": "å¹´å‡å°‡æ–¼ 2025-12-31 åˆ°æœŸï¼Œå‰©é¤˜ 10 å¤©æœªä¼‘",
        "priority": "high",
        "is_read": false
      },
      {
        "id": 2,
        "type": "task_due",
        "message": "ABCå…¬å¸ä»»å‹™å³å°‡æ–¼ä»Šå¤©æˆªæ­¢",
        "priority": "high",
        "is_read": false,
        "related_id": 123
      }
    ]
  }
}
```

---

## ğŸ“Š å·¥ä½œå°çµ±è¨ˆ

### å€‹äººæ•ˆèƒ½çµ±è¨ˆ
```sql
-- æœ¬æœˆä»»å‹™å®Œæˆæ•¸
SELECT 
  COUNT(*) as completed_tasks,
  SUM(actual_hours) as total_hours
FROM tasks t
JOIN task_stages ts ON t.id = ts.multi_stage_task_id
WHERE ts.completed_by = ?
  AND strftime('%Y-%m', ts.completed_at) = strftime('%Y-%m', 'now');
```

### å¾…è¾¦æé†’
```sql
-- å³å°‡åˆ°æœŸçš„ä»»å‹™
SELECT 
  t.id,
  t.title,
  t.due_date,
  t.priority,
  julianday(t.due_date) - julianday('now') as days_until_due
FROM tasks t
WHERE t.assigned_user = ?
  AND t.status IN ('pending', 'in_progress')
  AND t.due_date >= date('now')
  AND t.due_date <= date('now', '+7 days')
ORDER BY t.due_date;
```

---

## ğŸ”§ å¯¦æ–½ç´°ç¯€

### ç³»çµ±åƒæ•¸è®€å–
```javascript
async function getSystemParameter(key) {
  const param = await db.get(
    'SELECT param_value, param_type FROM system_parameters WHERE param_key = ?',
    [key]
  );
  
  if (!param) return null;
  
  // æ ¹æ“šé¡å‹è½‰æ›å€¼
  switch (param.param_type) {
    case 'number':
      return parseFloat(param.param_value);
    case 'boolean':
      return param.param_value === 'true';
    case 'json':
      return JSON.parse(param.param_value);
    default:
      return param.param_value;
  }
}
```

### å·¥ä½œå°æ•¸æ“šèšåˆ
```javascript
async function getDashboardData(userId) {
  // ä¸¦è¡ŒæŸ¥è©¢å¤šå€‹æ•¸æ“šæº
  const [myTasks, timesheet, annualLeave, notifications] = await Promise.all([
    getMyTasksSummary(userId),
    getCurrentMonthTimesheet(userId),
    getAnnualLeaveSummary(userId),
    getUnreadNotifications(userId)
  ]);
  
  return {
    my_tasks: myTasks,
    timesheet: timesheet,
    annual_leave: annualLeave,
    notifications: notifications,
    updated_at: new Date().toISOString()
  };
}
```

---

## ğŸ’» å‰ç«¯è¨­è¨ˆ

### å·¥ä½œå°å°éƒ¨ä»¶ (Widgets)

#### ä»»å‹™çµ±è¨ˆå°éƒ¨ä»¶
```javascript
class TaskStatsWidget {
  async render() {
    const stats = await fetchTaskStats();
    return `
      <div class="widget">
        <h3>æˆ‘çš„ä»»å‹™</h3>
        <div class="stat-number">${stats.total}</div>
        <div class="stat-detail">
          å¾…è™•ç†: ${stats.pending} | 
          é€²è¡Œä¸­: ${stats.in_progress}
        </div>
      </div>
    `;
  }
}
```

#### å·¥æ™‚çµ±è¨ˆå°éƒ¨ä»¶
```javascript
class TimesheetWidget {
  async render() {
    const timesheet = await fetchMonthlyTimesheet();
    return `
      <div class="widget">
        <h3>æœ¬æœˆå·¥æ™‚</h3>
        <div class="stat-number">${timesheet.regular_hours}h</div>
        <div class="stat-detail">
          åŠ ç­: ${timesheet.overtime_hours}h
        </div>
        <canvas id="timesheetChart"></canvas>
      </div>
    `;
  }
}
```

#### å¹´å‡å°éƒ¨ä»¶
```javascript
class AnnualLeaveWidget {
  async render() {
    const leave = await fetchAnnualLeave();
    const percentage = (leave.remaining / leave.total) * 100;
    
    return `
      <div class="widget">
        <h3>å¹´å‡é¤˜é¡</h3>
        <div class="stat-number">${leave.remaining}å¤©</div>
        <div class="progress-ring" data-progress="${percentage}">
          <svg>...</svg>
        </div>
      </div>
    `;
  }
}
```

---

---

## ğŸ“Š å·¥ä½œå°çµ±è¨ˆ

### å€‹äººå·¥ä½œé‡è¦–åœ–
```sql
-- æœ¬é€±ä»»å‹™åˆ†å¸ƒ
SELECT 
  date(due_date) as date,
  COUNT(*) as task_count,
  SUM(estimated_hours) as estimated_hours
FROM tasks
WHERE assigned_user = ?
  AND due_date >= date('now', 'weekday 0', '-6 days')
  AND due_date <= date('now', 'weekday 0')
GROUP BY date
ORDER BY date;
```

### åœ˜éšŠå·¥ä½œé‡å¹³è¡¡
```sql
-- å„å“¡å·¥ç•¶å‰ä»»å‹™æ•¸èˆ‡å·¥æ™‚
SELECT 
  u.employee_name,
  COUNT(DISTINCT t.id) as task_count,
  SUM(CASE WHEN t.status = 'pending' THEN 1 ELSE 0 END) as pending_tasks,
  SUM(ts.estimated_hours - COALESCE(ts.actual_hours, 0)) as remaining_hours
FROM users u
LEFT JOIN tasks t ON u.id = t.assigned_user
LEFT JOIN task_stages ts ON t.id = ts.task_id AND ts.status != 'completed'
WHERE u.role IN ('employee', 'accountant')
  AND t.status IN ('pending', 'in_progress')
GROUP BY u.id
ORDER BY remaining_hours DESC;
```

---

## ğŸ”Œ API è¨­è¨ˆï¼ˆå·²å„ªåŒ–ï¼‰

### é…ç½®ç®¡ç† API

#### å–å¾—é…ç½®åˆ†é¡
```
GET /api/system-config/categories

Response:
{
  "success": true,
  "categories": [
    {"category": "timesheet", "param_count": 5},
    {"category": "annual_leave", "param_count": 4},
    {"category": "automation", "param_count": 6}
  ]
}
```

#### å–å¾—ç‰¹å®šåˆ†é¡é…ç½®
```
GET /api/system-config/:category

Response:
{
  "success": true,
  "category": "timesheet",
  "parameters": [
    {
      "param_key": "work_hours_per_day",
      "param_value": "8",
      "param_type": "number",
      "editor_type": "number",
      "description": "æ¯æ—¥æ¨™æº–å·¥æ™‚",
      "validation_rule": {"min": 1, "max": 24},
      "help_text": "å“¡å·¥æ¯æ—¥æ‡‰å·¥ä½œæ™‚æ•¸",
      "is_editable": true
    }
  ]
}
```

#### æ›´æ–°å–®å€‹é…ç½®
```
PUT /api/system-config/:key

Request:
{
  "param_value": "8.5"
}

Response:
{
  "success": true,
  "message": "åƒæ•¸å·²æ›´æ–°",
  "param_key": "work_hours_per_day",
  "new_value": "8.5"
}
```

#### æ‰¹é‡æ›´æ–°é…ç½®
```
PUT /api/system-config/batch

Request:
{
  "updates": [
    {"param_key": "work_hours_per_day", "param_value": "8"},
    {"param_key": "overtime_rate_weekday", "param_value": "1.34"}
  ]
}

Response:
{
  "success": true,
  "total": 2,
  "success_count": 2,
  "fail_count": 0
}
```

#### é‡ç½®ç‚ºé è¨­å€¼
```
POST /api/system-config/:key/reset

Response:
{
  "success": true,
  "message": "å·²é‡ç½®ç‚ºé è¨­å€¼"
}
```

---

## ğŸ¨ å·¥ä½œå°è¦–è¦ºåŒ–

### å·¥æ™‚è¶¨å‹¢åœ–
```javascript
// ä½¿ç”¨ Chart.js ç¹ªè£½å·¥æ™‚è¶¨å‹¢
new Chart(ctx, {
  type: 'bar',
  data: {
    labels: ['é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”'],
    datasets: [{
      label: 'æ­£å¸¸å·¥æ™‚',
      data: [8, 8, 8, 8, 8],
      backgroundColor: 'rgba(75, 192, 192, 0.5)'
    }, {
      label: 'åŠ ç­å·¥æ™‚',
      data: [0, 2, 1, 0, 3],
      backgroundColor: 'rgba(255, 99, 132, 0.5)'
    }]
  }
});
```

### ä»»å‹™å®Œæˆç‡ç’°å½¢åœ–
```javascript
new Chart(ctx, {
  type: 'doughnut',
  data: {
    labels: ['å·²å®Œæˆ', 'é€²è¡Œä¸­', 'æœªé–‹å§‹'],
    datasets: [{
      data: [12, 5, 3],
      backgroundColor: [
        'rgba(75, 192, 192, 0.8)',
        'rgba(54, 162, 235, 0.8)',
        'rgba(201, 203, 207, 0.8)'
      ]
    }]
  }
});
```

---

## ğŸš€ æœªä¾†æ“´å±•

### ç³»çµ±è¨­å®šæ“´å±•
- [ ] æ¬Šé™ç´°éƒ¨æ§åˆ¶ï¼ˆæ¬„ä½ç´šåˆ¥æ¬Šé™ï¼‰
- [ ] ä¸»é¡Œè‰²å½©è‡ªè¨‚
- [ ] è³‡æ–™åŒ¯å…¥/åŒ¯å‡ºè¨­å®š
- [ ] ç¨½æ ¸æ—¥èªŒï¼ˆè¿½è¹¤é…ç½®è®Šæ›´ï¼‰

### å·¥ä½œå°æ“´å±•
- [ ] å¯è‡ªè¨‚å°éƒ¨ä»¶é…ç½®
- [ ] æ‹–æ›³æ’ç‰ˆ
- [ ] æ•ˆèƒ½åˆ†æï¼ˆæœ¬æœˆ vs ä¸Šæœˆï¼‰

---

**ç›¸é—œæ–‡æª”**ï¼š
- [ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md](./ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md) - æ•´é«”æ¶æ§‹
- [å·¥æ™‚ç®¡ç†ç³»çµ±è¨­è¨ˆ.md](./å·¥æ™‚ç®¡ç†ç³»çµ±è¨­è¨ˆ.md) - å·¥æ™‚è³‡æ–™
- [APIç«¯é»æ–‡æª”.md](./APIç«¯é»æ–‡æª”.md) - API åƒè€ƒ

