# 08 - 工時表填寫

**所屬模塊：** 工時表與報表  
**頁面路徑：** `/timesheet`  
**權限：** 所有使用者  
**最後更新：** 2025年10月27日

---

## 功能概述

類似 Excel 的網頁格狀介面，員工填寫每日工時。

---

## UI 設計

```
工時表 - 2025年11月   [◀上月] [下月▶]  [儲存]
─────────────────────────────────────────────
|日期  |客戶  |業務類型|工時類型    |時數|加權|假別|
|11/01 |仟鑽  |記帳    |正常工時    |8.0 |8.0 |    |
|11/02 |     |        |            |    |    |    |
|11/05 |     |        |            |    |    |病假|8|
─────────────────────────────────────────────
本月統計：正常 56h | 加權 64.5h | 請假 8h
```

---

## 核心特性

- 自動標註假日（背景變色）
- 下拉選單（客戶、業務類型）
- 自動計算加權工時
- 支援快捷鍵（Ctrl+S 儲存）

---

## 資料表

`TimeLogs`

---

## API

```
GET  /api/v1/timesheets?month=2025-11
POST /api/v1/timesheets
```

---

## 工時異常檢測

**功能：** 單日工時超過 12 小時時自動提示

**實際運作：**
```
員工填寫：2025-11-05
  仟鑽-記帳-正常工時 8h
  宏達-工商-正常工時 4h
  新創-記帳-平日加班 3h
  ────────────────────
  當日總計：15h

系統自動顯示：
⚠️ 2025-11-05 的工時為 15 小時，請確認是否正確
```

**前端檢查：**
```typescript
// 即時計算當日總工時
const dailyTotal = computed(() => {
  return timeLogs
    .filter(log => log.work_date === selectedDate.value)
    .reduce((sum, log) => sum + (log.hours || 0), 0);
});

// 顯示警告
const showWarning = computed(() => dailyTotal.value > 12);
```

**UI 提示：**
```vue
<div v-if="showWarning" class="mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded">
  ⚠️ {{ selectedDate }} 的工時為 {{ dailyTotal }}小時，請確認是否正確
</div>
```

---

## 快捷鍵支援

**Esc 關閉彈窗：**
```typescript
// 在 Modal 組件中
onMounted(() => {
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
});
```

---

**相關：** [工時API](../API設計/工時API.md), [加權工時計算](./09-加權工時計算.md), [報表中心](./10-報表中心.md)

