# 04 - 員工帳號管理

**所屬模塊：** 系統設定（僅管理員）  
**頁面路徑：** `/settings/users`  
**最後更新：** 2025年10月27日

---

## 功能概述

管理員工帳號（新增、編輯、重設密碼、停用/啟用）。

---

## 核心功能

### 4.1 新增員工
- 設定姓名、帳號、初始密碼
- 選擇角色（管理員/員工）
- 選擇性別（影響假期規則）

### 4.2 編輯員工資料
- 修改姓名、性別

### 4.3 重設密碼
- 管理員指定新密碼
- **使用 Argon2id 雜湊算法**（業界最安全標準）

### 4.4 停用/啟用帳號
- 軟停用，無法登入但保留歷史記錄

---

## 使用情境

| 情境 | 操作 |
|------|------|
| 新員工入職 | 新增帳號，預設為普通員工 |
| 員工忘記密碼 | 管理員重設密碼 |
| 員工離職 | 停用帳號（保留歷史資料） |
| 提升為管理員 | 編輯角色為管理員 |

---

## 技術規格

### 密碼雜湊實現

```typescript
// utils/password.util.ts
import argon2 from 'argon2';

export async function hashPassword(password: string): Promise<string> {
  return await argon2.hash(password, {
    type: argon2.argon2id,
    memoryCost: 65536,  // 64 MB
    timeCost: 3,        // 3 次迭代
    parallelism: 4      // 4 個執行緒
  });
}

export async function verifyPassword(
  password: string, 
  hash: string
): Promise<boolean> {
  return await argon2.verify(hash, password);
}
```

---

## 資料表

詳細說明請參閱 [Users 資料表](../資料庫設計/核心業務/Users.md)

---

## API 端點

```
GET    /api/v1/settings/users         - 獲取所有員工列表
POST   /api/v1/settings/users         - 新增員工
PUT    /api/v1/settings/users/:id     - 編輯員工資料
POST   /api/v1/settings/users/:id/reset-password  - 重設密碼
PUT    /api/v1/settings/users/:id/deactivate      - 停用帳號
PUT    /api/v1/settings/users/:id/activate        - 啟用帳號
```

---

## 整合關係

- **權限系統**：新增員工時自動創建預設權限記錄
- **假期系統**：性別影響可用假別（如生理假）
- **工時系統**：所有工時記錄關聯到員工帳號

---

## 相關文檔

- [認證 API](../API設計/認證API.md)
- [Users 資料表](../資料庫設計/核心業務/Users.md)
- [員工權限設定](./01-員工權限設定.md)

---

**最後更新：** 2025年10月27日

```

---

## 整合關係

- **權限系統**：新增員工時自動創建預設權限記錄
- **假期系統**：性別影響可用假別（如生理假）
- **工時系統**：所有工時記錄關聯到員工帳號

---

## 相關文檔

- [認證 API](../API設計/認證API.md)
- [Users 資料表](../資料庫設計/核心業務/Users.md)
- [員工權限設定](./01-員工權限設定.md)

---

**最後更新：** 2025年10月27日
