# 15 - 客戶服務設定

**所屬模塊：** 任務追蹤系統（管理員/會計師）  
**頁面路徑：** `/clients/:clientId/services`  
**權限：** 管理員、會計師（只能管理自己負責的客戶）  
**最後更新：** 2025年10月27日

---

## 功能概述

為客戶配置訂閱的服務項目，包含服務頻率、費用、難易度、關聯任務模板等。系統會根據設定自動建立週期性任務。

**核心特點：**
- ✓ 支援單次性和週期性服務
- ✓ 可設定觸發月份（如雙月：1,3,5,7,9,11）
- ✓ 自動關聯任務模板
- ✓ 記錄服務難易度和費用
- ✓ Cron Job 自動建立任務

---

## 使用場景

### 場景 1：為新客戶設定記帳服務

事務所簽訂新客戶，需設定雙月記帳服務。

**操作：**
1. 進入客戶詳情頁
2. 點擊「新增服務」
3. 選擇服務項目：「記帳服務 - 收集憑證」
4. 選擇頻率：「雙月」
5. 勾選觸發月份：1, 3, 5, 7, 9, 11
6. 輸入費用：15,000
7. 選擇任務模板：「記帳標準流程」
8. 選擇難易度：「中等」
9. 點擊「儲存」

**結果：**
- 系統建立 `ClientServices` 記錄
- 每個觸發月份1日，Cron Job 自動建立任務

---

### 場景 2：為客戶新增單次性服務

客戶需要公司設立服務（一次性）。

**操作：**
1. 新增服務：「工商登記服務 - 公司設立」
2. 選擇頻率：「單次」
3. 設定服務期間：2025-01-01 ~ 2025-01-31
4. 輸入費用：50,000
5. 選擇難易度：「困難」
6. 點擊「儲存」

**結果：**
- 不設定觸發月份（`trigger_months = NULL`）
- 手動建立任務
- 服務完成後設定 `end_date`

---

### 場景 3：暫停客戶的某項服務

客戶暫時不需要工商登記服務。

**操作：**
1. 找到該服務項目
2. 點擊「停用」
3. 確認停用

**結果：**
- `is_active = 0`
- Cron Job 不再為此服務建立任務
- 可隨時重新啟用

---

### 場景 4：查看客戶的服務總覽

會計師想查看客戶A訂閱了哪些服務。

**操作：**
1. 進入客戶A的詳情頁
2. 點擊「服務項目」頁籤

**顯示：**
```
✓ 記帳服務 - 收集憑證（雙月，1,3,5月...）- NT$ 15,000
✓ 工商登記服務 - 公司變更（每月）- NT$ 5,000
⊗ 稅務申報服務（已停用）
```

---

## 核心功能

### 服務配置
- 選擇服務項目（從 Services 表）
- 設定週期類型（從 ServiceFrequencyTypes 表）
- 設定觸發月份（JSON 陣列）
- 設定費用和難易度
- 關聯任務模板（可選）

### 服務管理
- 啟用/停用服務
- 修改服務設定
- 刪除服務（軟刪除）
- 查看服務歷史

### 自動化整合
- Cron Job 根據觸發月份自動建立任務
- 關聯任務模板自動套用流程
- 服務費用可用於報表統計

---

## 整合關聯

### 與客戶管理整合
- 在客戶詳情頁管理服務
- 顯示客戶的所有訂閱服務
- 統計客戶的服務總金額

### 與服務項目整合
- 從服務項目清單選擇
- 支援主項目和子項目
- 繼承服務項目的基本資訊

### 與任務管理整合
- 自動建立任務實例
- 套用任務模板流程
- 追蹤任務執行狀態

### 與工時管理整合
- 工時記錄可關聯服務
- 統計服務的實際工時
- 比較預估與實際工時

---

## 技術規格文檔索引

### 詳細設計
- [UI 設計](../../技術規格/客戶服務/UI設計.md) - 介面設計與互動
- [業務邏輯](../../技術規格/客戶服務/業務邏輯.md) - 核心邏輯與規則
- [測試案例](../../技術規格/客戶服務/測試案例.md) - 測試場景

---

## API 規格索引

- [客戶服務 API](../../API規格/客戶服務/_概覽.md) - API 端點總覽

---

## 資料表索引

- [ClientServices](../../資料庫設計/業務服務/ClientServices.md) - 客戶服務設定資料表

---

## 相關文檔

- [客戶管理](./23-客戶管理.md) - 管理客戶基本資料
- [服務項目管理](./03-服務項目管理.md) - 定義服務項目
- [任務模板管理](./14-任務模板管理.md) - 設定任務流程
- [業務規則 - 週期類型](./業務規則/2.6-週期類型管理.md) - 設定服務頻率

---

**最後更新：** 2025年10月27日  
**文檔版本：** 2.0（模塊化重組版）

