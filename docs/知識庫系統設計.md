# çŸ¥è­˜åº«ç³»çµ±è¨­è¨ˆ

**ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025-10-26

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

çµ±ä¸€çŸ¥è­˜ç®¡ç†å¹³å°ï¼ŒåŒ…å« SOP æ¨™æº–ä½œæ¥­ç¨‹åºã€å…§éƒ¨æ–‡æª”ã€å¸¸è¦‹å•ç­”ç­‰å…§å®¹ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- SOP æ¨™æº–ä½œæ¥­ç¨‹åºç®¡ç†
- å…§éƒ¨æ–‡æª”ç®¡ç†
- å¸¸è¦‹å•ç­” (FAQ)
- éšå±¤å¼åˆ†é¡ç³»çµ±
- å…¨æ–‡æœå°‹
- ç‰ˆæœ¬æ§åˆ¶
- Markdown ç·¨è¼¯å™¨

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### ä¸‰å¤§æ¨¡çµ„

| æ¨¡çµ„ | èªªæ˜ | è³‡æ–™è¡¨ | é é¢æ¨™ç±¤ |
|------|------|--------|----------|
| SOP æ–‡ä»¶ | æ¨™æº–ä½œæ¥­ç¨‹åº | sops, sop_categories, sop_versions | SOPæ–‡ä»¶ |
| å…§éƒ¨æ–‡æª” | å…¬å¸å…§éƒ¨æ–‡ä»¶ | ï¼ˆèˆ‡ SOP å…±ç”¨çµæ§‹ï¼‰ | å…§éƒ¨æ–‡æª” |
| å¸¸è¦‹å•ç­” | FAQ å•é¡Œé›† | ï¼ˆå‰ç«¯ JSON æˆ–è³‡æ–™è¡¨ï¼‰ | å¸¸è¦‹å•ç­” |

---

## ğŸ—„ï¸ è³‡æ–™è¡¨çµæ§‹

### sop_categories (åˆ†é¡)
```sql
CREATE TABLE sop_categories (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL UNIQUE,         -- åˆ†é¡åç¨±
  parent_id INTEGER,                 -- çˆ¶åˆ†é¡ï¼ˆéšå±¤å¼ï¼‰
  sort_order INTEGER DEFAULT 0,      -- æ’åº
  description TEXT,
  icon TEXT,                         -- Material Icons åœ–ç¤ºåç¨±
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (parent_id) REFERENCES sop_categories(id) ON DELETE CASCADE
);
```

**åˆ†é¡ç¯„ä¾‹**ï¼š
```
æœƒè¨ˆæœå‹™
â”œâ”€ è¨˜å¸³æœå‹™
â”œâ”€ ç‡Ÿæ¥­ç¨…ç”³å ±
â””â”€ ç‡Ÿæ‰€ç¨…ç”³å ±

å·¥å•†ç™»è¨˜
â”œâ”€ å…¬å¸è¨­ç«‹
â”œâ”€ è®Šæ›´ç™»è¨˜
â””â”€ è§£æ•£æ¸…ç®—

å…§éƒ¨ç®¡ç†
â”œâ”€ äººäº‹ç®¡ç†
â”œâ”€ è¡Œæ”¿æµç¨‹
â””â”€ è³‡è¨Šç³»çµ±æ“ä½œ

å¸¸è¦‹å•é¡Œ
â”œâ”€ ç¨…å‹™å•é¡Œ
â”œâ”€ å¸³å‹™å•é¡Œ
â””â”€ ç³»çµ±æ“ä½œ
```

### sops (æ–‡ä»¶ä¸»è¡¨)
```sql
CREATE TABLE sops (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,               -- æ–‡ä»¶æ¨™é¡Œ
  category_id INTEGER,               -- æ‰€å±¬åˆ†é¡
  content TEXT NOT NULL,             -- å…§å®¹ï¼ˆMarkdownï¼‰
  document_type TEXT DEFAULT 'sop',  -- sop, internal_doc, faq
  version INTEGER DEFAULT 1,         -- ç‰ˆæœ¬è™Ÿ
  status TEXT DEFAULT 'draft',       -- draft, published, archived
  author_id INTEGER,
  business_type TEXT,                -- é—œè¯æ¥­å‹™é¡å‹
  tags TEXT,                         -- æ¨™ç±¤ï¼ˆJSONï¼‰
  views INTEGER DEFAULT 0,           -- ç€è¦½æ¬¡æ•¸
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  published_at DATETIME,
  FOREIGN KEY (category_id) REFERENCES sop_categories(id) ON DELETE SET NULL,
  FOREIGN KEY (author_id) REFERENCES users(id)
);
```

### sop_versions (ç‰ˆæœ¬æ­·å²)
```sql
CREATE TABLE sop_versions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  sop_id INTEGER NOT NULL,
  version INTEGER NOT NULL,
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  author_id INTEGER,
  change_description TEXT,           -- è®Šæ›´èªªæ˜
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (sop_id) REFERENCES sops(id) ON DELETE CASCADE,
  FOREIGN KEY (author_id) REFERENCES users(id),
  UNIQUE(sop_id, version)
);
```

---

## ğŸ”„ æ¥­å‹™æµç¨‹

### SOP å»ºç«‹æµç¨‹
```
1. é¸æ“‡æ–‡ä»¶é¡å‹ï¼ˆSOP / å…§éƒ¨æ–‡æª” / FAQï¼‰
   â†“
2. é¸æ“‡åˆ†é¡
   â†“
3. æ’°å¯«å…§å®¹ï¼ˆMarkdown ç·¨è¼¯å™¨ï¼‰
   â†“
4. å„²å­˜è‰ç¨¿
   - INSERT INTO sops
   - document_type = 'sop'
   - status = 'draft'
   â†“
5. å¯©æ ¸èˆ‡ç™¼å¸ƒ
   - UPDATE status = 'published'
   - å»ºç«‹ç‰ˆæœ¬è¨˜éŒ„ï¼ˆINSERT INTO sop_versionsï¼‰
```

### æ–‡ä»¶ä¿®è¨‚æµç¨‹
```
1. è¼‰å…¥ç¾æœ‰æ–‡ä»¶
   â†“
2. ç·¨è¼¯å…§å®¹
   â†“
3. å„²å­˜æ–°ç‰ˆæœ¬
   - å‚™ä»½ç•¶å‰ç‰ˆæœ¬åˆ° sop_versions
   - UPDATE sops SET content = æ–°å…§å®¹, version = version + 1
   â†“
4. è¨˜éŒ„è®Šæ›´èªªæ˜
```

### æœå°‹æµç¨‹
```
1. è¼¸å…¥æœå°‹é—œéµå­—
   â†“
2. æœå°‹æ¨™é¡Œèˆ‡å…§å®¹
   - SELECT * FROM sops 
     WHERE (title LIKE ? OR content LIKE ?)
     AND document_type = ?
   â†“
3. é¡¯ç¤ºæœå°‹çµæœ
   - é«˜äº®é—œéµå­—
   - é¡¯ç¤ºæ‘˜è¦
```

---

## ğŸ”Œ API è¨­è¨ˆ

### å–å¾—åˆ†é¡æ¨¹
```
GET /api/sop-categories?type=sop

Response:
{
  "success": true,
  "categories": [
    {
      "id": 1,
      "name": "æœƒè¨ˆæœå‹™",
      "icon": "account_balance",
      "children": [
        { "id": 2, "name": "è¨˜å¸³æœå‹™", "doc_count": 5 }
      ]
    }
  ]
}
```

### å–å¾—æ–‡ä»¶åˆ—è¡¨
```
GET /api/sops?document_type=sop&category_id=2&status=published

Response:
{
  "success": true,
  "sops": [
    {
      "id": 1,
      "title": "æœˆåº¦è¨˜å¸³æ¨™æº–æµç¨‹",
      "category": "è¨˜å¸³æœå‹™",
      "version": 3,
      "views": 45,
      "updated_at": "2025-10-20"
    }
  ]
}
```

### å–å¾—æ–‡ä»¶è©³æƒ…
```
GET /api/sops/{id}

Response:
{
  "success": true,
  "sop": {
    "id": 1,
    "title": "æœˆåº¦è¨˜å¸³æ¨™æº–æµç¨‹",
    "content": "# æµç¨‹èªªæ˜\n\n...",
    "document_type": "sop",
    "version": 3,
    "category": "è¨˜å¸³æœå‹™",
    "tags": ["è¨˜å¸³", "æœˆçµ"]
  }
}
```

### æœå°‹æ–‡ä»¶
```
GET /api/sops/search?q=ç™¼ç¥¨&type=sop

Response:
{
  "success": true,
  "results": [
    {
      "id": 1,
      "title": "æœˆåº¦è¨˜å¸³æµç¨‹",
      "excerpt": "...æ”¶é›†é€²é …ç™¼ç¥¨å’ŒéŠ·é …ç™¼ç¥¨...",
      "category": "è¨˜å¸³æœå‹™",
      "document_type": "sop"
    }
  ]
}
```

---

## ğŸ’» å‰ç«¯è¨­è¨ˆ

### çµ±ä¸€é é¢ï¼šknowledge.html

#### æ¨™ç±¤çµæ§‹
```
[SOPæ–‡ä»¶] [å…§éƒ¨æ–‡æª”] [å¸¸è¦‹å•ç­”]
```

#### ä½ˆå±€ï¼ˆä¸‰æ¬„å¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚                â”‚                  â”‚
â”‚  åˆ†é¡æ¨¹  â”‚   æ–‡ä»¶åˆ—è¡¨     â”‚   æ–‡ä»¶å…§å®¹       â”‚
â”‚          â”‚                â”‚                  â”‚
â”‚ ğŸ“æœƒè¨ˆæœå‹™â”‚ æœˆåº¦è¨˜å¸³æµç¨‹   â”‚ # æœˆåº¦è¨˜å¸³æµç¨‹   â”‚
â”‚  ğŸ“„è¨˜å¸³   â”‚ è¨˜å¸³ | v3 | 45 â”‚                  â”‚
â”‚  ğŸ“„ç‡Ÿæ¥­ç¨… â”‚                â”‚ ## æ­¥é©Ÿ          â”‚
â”‚          â”‚ ç‡Ÿæ¥­ç¨…ç”³å ±æµç¨‹ â”‚ 1. æ”¶é›†æ†‘è­‰      â”‚
â”‚ ğŸ“å·¥å•†ç™»è¨˜â”‚ ç‡Ÿæ¥­ç¨… | v2    â”‚ 2. ...           â”‚
â”‚  ğŸ“„å…¬å¸è¨­ç«‹â”‚               â”‚                  â”‚
â”‚          â”‚ [+ æ–°å¢SOP]    â”‚ [ç·¨è¼¯][ç‰ˆæœ¬æ­·å²] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### SOP æ–‡ä»¶æ¨™ç±¤
- å·¦å´ï¼šSOP åˆ†é¡æ¨¹
- ä¸­é–“ï¼šSOP æ–‡ä»¶åˆ—è¡¨
- å³å´ï¼šSOP å…§å®¹é¡¯ç¤º

#### å…§éƒ¨æ–‡æª”æ¨™ç±¤
- é¡¯ç¤ºå…§éƒ¨æ–‡æª”ï¼ˆdocument_type = 'internal_doc'ï¼‰
- ä¾‹å¦‚ï¼šæœƒè­°è¨˜éŒ„ã€æ”¿ç­–æ–‡ä»¶ã€æ“ä½œæ‰‹å†Š

#### å¸¸è¦‹å•ç­”æ¨™ç±¤
- FAQ åˆ—è¡¨ï¼ˆå¯æŠ˜ç–Šï¼‰
- å•é¡Œæœå°‹
- åˆ†é¡ç¯©é¸

---

## ğŸ” æœå°‹åŠŸèƒ½

### å…¨ç«™æœå°‹
```javascript
async function searchKnowledge(keyword) {
  // åŒæ™‚æœå°‹ SOPã€å…§éƒ¨æ–‡æª”ã€FAQ
  const results = await fetch(`/api/sops/search?q=${keyword}`);
  
  // æŒ‰æ–‡ä»¶é¡å‹åˆ†çµ„é¡¯ç¤º
  return {
    sops: results.filter(r => r.document_type === 'sop'),
    docs: results.filter(r => r.document_type === 'internal_doc'),
    faqs: results.filter(r => r.document_type === 'faq')
  };
}
```

### æœå°‹çµæœé¡¯ç¤º
```
æœå°‹: "ç™¼ç¥¨"

SOP æ–‡ä»¶ (3)
- æœˆåº¦è¨˜å¸³æµç¨‹ (æœƒè¨ˆæœå‹™)
- ç‡Ÿæ¥­ç¨…ç”³å ±æµç¨‹ (ç‡Ÿæ¥­ç¨…ç”³å ±)
- ...

å…§éƒ¨æ–‡æª” (1)
- ç™¼ç¥¨è™•ç†æ³¨æ„äº‹é …

å¸¸è¦‹å•ç­” (2)
- Q: å¦‚ä½•è™•ç†éºå¤±çš„ç™¼ç¥¨ï¼Ÿ
- Q: é›»å­ç™¼ç¥¨å¦‚ä½•æ­¸æª”ï¼Ÿ
```

---

## ğŸ“ Markdown ç·¨è¼¯

### ç·¨è¼¯å™¨åŠŸèƒ½
- æ¨™é¡Œã€ç²—é«”ã€æ–œé«”
- åˆ—è¡¨ï¼ˆæœ‰åºã€ç„¡åºï¼‰
- ç¨‹å¼ç¢¼å€å¡Š
- è¡¨æ ¼
- é€£çµã€åœ–ç‰‡
- å³æ™‚é è¦½
- è‡ªå‹•å„²å­˜è‰ç¨¿

### åœ–ç‰‡è™•ç†
```javascript
// å¾åª’é«”åº«æ’å…¥åœ–ç‰‡
editor.codemirror.replaceSelection(
  `![${alt_text}](${image_url})`
);

// æˆ–ç›´æ¥ä¸Šå‚³
async function uploadAndInsert(file) {
  const uploaded = await uploadToMediaLibrary(file);
  editor.codemirror.replaceSelection(
    `![](${uploaded.url})`
  );
}
```

---

## ğŸ“Š çŸ¥è­˜åº«çµ±è¨ˆ

### æ–‡ä»¶çµ±è¨ˆ
```sql
-- å„åˆ†é¡æ–‡ä»¶æ•¸é‡
SELECT 
  sc.name,
  COUNT(s.id) as doc_count,
  SUM(s.views) as total_views,
  MAX(s.updated_at) as last_updated
FROM sop_categories sc
LEFT JOIN sops s ON sc.id = s.category_id AND s.status = 'published'
GROUP BY sc.id
ORDER BY doc_count DESC;
```

### ç†±é–€æ–‡ä»¶
```sql
-- æœ€å¤šäººé–±è®€çš„æ–‡ä»¶
SELECT 
  id,
  title,
  document_type,
  views,
  updated_at
FROM sops
WHERE status = 'published'
ORDER BY views DESC
LIMIT 10;
```

### æœ€æ–°æ›´æ–°
```sql
-- æœ€è¿‘æ›´æ–°çš„æ–‡ä»¶
SELECT 
  id,
  title,
  document_type,
  version,
  updated_at
FROM sops
WHERE status = 'published'
ORDER BY updated_at DESC
LIMIT 20;
```

---

## ğŸ¨ å‰ç«¯ç‰¹è‰²åŠŸèƒ½

### å´é‚Šæ¬„å°èˆª
```html
<div class="sidebar">
  <!-- åˆ†é¡æ¨¹ -->
  <div class="category-tree">
    <div class="category-item">
      <span class="material-symbols-outlined">folder</span>
      æœƒè¨ˆæœå‹™
      <div class="subcategories">
        <div class="subcategory">è¨˜å¸³æœå‹™ (5)</div>
        <div class="subcategory">ç‡Ÿæ¥­ç¨… (3)</div>
      </div>
    </div>
  </div>
  
  <!-- å¿«é€Ÿé€£çµ -->
  <div class="quick-links">
    <h4>å¸¸ç”¨æ–‡ä»¶</h4>
    <a href="#sop-1">æœˆåº¦è¨˜å¸³æµç¨‹</a>
    <a href="#sop-5">ç‡Ÿæ¥­ç¨…ç”³å ±</a>
  </div>
</div>
```

### æ–‡ä»¶å¡ç‰‡
```html
<div class="doc-card" onclick="openDocument(1)">
  <h3>æœˆåº¦è¨˜å¸³æ¨™æº–æµç¨‹</h3>
  <div class="doc-meta">
    <span class="badge">SOP</span>
    <span>è¨˜å¸³æœå‹™</span>
    <span>v3</span>
    <span>ğŸ‘ 45</span>
  </div>
  <p class="doc-excerpt">æ¨™æº–çš„æœˆåº¦è¨˜å¸³ä½œæ¥­æµç¨‹...</p>
  <div class="doc-footer">
    <span>æ›´æ–°ï¼š2025-10-20</span>
    <span>ä½œè€…ï¼šadmin</span>
  </div>
</div>
```

### æ–‡ä»¶å…§å®¹é¡¯ç¤º
```html
<div class="doc-content">
  <div class="doc-header">
    <h1>æœˆåº¦è¨˜å¸³æ¨™æº–æµç¨‹</h1>
    <div class="doc-info">
      <span>ç‰ˆæœ¬ 3</span>
      <span>è¨˜å¸³æœå‹™</span>
      <span>æ›´æ–°æ–¼ 2025-10-20</span>
    </div>
  </div>
  
  <div class="doc-actions">
    <button onclick="editDocument()">ç·¨è¼¯</button>
    <button onclick="viewVersions()">ç‰ˆæœ¬æ­·å²</button>
    <button onclick="printDocument()">åˆ—å°</button>
    <button onclick="shareDocument()">åˆ†äº«</button>
  </div>
  
  <div class="markdown-content">
    <!-- æ¸²æŸ“å¾Œçš„ Markdown å…§å®¹ -->
  </div>
</div>
```

---

## ğŸ” æœå°‹èˆ‡ç¯©é¸

### å¤šæ¢ä»¶æœå°‹
```javascript
async function searchDocuments(params) {
  const {
    keyword,          // é—œéµå­—
    documentType,     // sop, internal_doc, faq
    categoryId,       // åˆ†é¡ ID
    tags,             // æ¨™ç±¤é™£åˆ—
    dateFrom,         // æ—¥æœŸç¯„åœ
    dateTo
  } = params;
  
  const query = new URLSearchParams({
    q: keyword,
    type: documentType,
    category_id: categoryId,
    // ...
  });
  
  return await fetch(`/api/sops/search?${query}`);
}
```

### æ¨™ç±¤é›²
```html
<div class="tag-cloud">
  <span class="tag" data-count="15">è¨˜å¸³</span>
  <span class="tag" data-count="12">ç‡Ÿæ¥­ç¨…</span>
  <span class="tag" data-count="8">ç”³å ±</span>
  <span class="tag" data-count="6">ç™¼ç¥¨</span>
  <!-- æ¨™ç±¤å¤§å°ä¾ä½¿ç”¨æ¬¡æ•¸èª¿æ•´ -->
</div>
```

---

## ğŸ“š æ–‡ä»¶é¡å‹å·®ç•°

### SOP æ–‡ä»¶
- åš´æ ¼çš„ç‰ˆæœ¬æ§åˆ¶
- éœ€è¦å¯©æ ¸ç™¼å¸ƒ
- æ¨™æº–åŒ–æ ¼å¼
- é—œè¯æ¥­å‹™é¡å‹
- è¨˜éŒ„é–±è®€æ¬¡æ•¸

### å…§éƒ¨æ–‡æª”
- è¼ƒè¼•é‡çš„ç‰ˆæœ¬æ§åˆ¶
- å¿«é€Ÿç™¼å¸ƒ
- éˆæ´»çš„æ ¼å¼
- éƒ¨é–€å…§éƒ¨ä½¿ç”¨

### å¸¸è¦‹å•ç­”
- å•ç­”æ ¼å¼
- åˆ†é¡ç®¡ç†
- å¿«é€ŸæŸ¥æ‰¾
- å¯æŠ˜ç–Šé¡¯ç¤º

---

## ğŸ’» é é¢å¯¦æ–½ï¼ˆâœ… å·²å¯¦æ–½ 2025-10-26ï¼‰

### knowledge.html æ¨™ç±¤åˆ‡æ›

**å¯¦æ–½ä½ç½®**: knowledge.html ç¬¬430-463è¡Œï¼Œç¬¬474-663è¡Œ

```javascript
// âœ… å·²å¯¦æ–½
function switchMainTab(tabName) {
    // æ›´æ–°æ¨™ç±¤æŒ‰éˆ•å’Œå…§å®¹é¡¯ç¤º
    // ...
}

// âœ… SOP åŠŸèƒ½å·²å¯¦æ–½
async function loadSopCategories() {
    const response = await fetch(`${WORKER_URL}/api/sop/categories`, {
        headers: { 'Authorization': `Bearer ${sessionToken}` }
    });
    const data = await response.json();
    sopCategories = data.categories || [];
    
    // å¡«å……åˆ†é¡ç¯©é¸å™¨
    // ...
}

async function loadSops() {
    const categoryId = document.getElementById('sopCategoryFilter')?.value || '';
    let url = `${WORKER_URL}/api/sops?document_type=sop&status=published`;
    if (categoryId) {
        url += `&category_id=${categoryId}`;
    }
    
    const response = await fetch(url, {
        headers: { 'Authorization': `Bearer ${sessionToken}` }
    });
    const data = await response.json();
    allSops = data.sops || [];
    
    renderSops(allSops);
}

function renderSops(sops) {
    // æŒ‰åˆ†é¡åˆ†çµ„é¡¯ç¤º
    const grouped = {};
    sops.forEach(sop => {
        const catName = sop.category_name || 'æœªåˆ†é¡';
        if (!grouped[catName]) grouped[catName] = [];
        grouped[catName].push(sop);
    });
    
    // æ¸²æŸ“ç‚ºå¡ç‰‡åˆ—è¡¨
    // ...
}
```

**å¯¦æ–½ç‹€æ…‹**:
- âœ… SOP åˆ—è¡¨è¼‰å…¥ï¼ˆknowledge.html ç¬¬516-559è¡Œï¼‰
- âœ… åˆ†é¡ç¯©é¸å™¨ï¼ˆç¬¬482-511è¡Œï¼‰
- âœ… æœå°‹åŠŸèƒ½ï¼ˆç¬¬633-647è¡Œï¼‰
- âœ… æŒ‰åˆ†é¡åˆ†çµ„é¡¯ç¤ºï¼ˆç¬¬564-628è¡Œï¼‰
- âœ… é»æ“ŠæŸ¥çœ‹SOPï¼ˆç¬¬652-656è¡Œï¼Œå¯æ“´å±•ï¼‰
- ğŸ“‹ å‰µå»ºSOPï¼ˆç¬¬661-663è¡Œï¼Œé¡¯ç¤ºæç¤ºï¼Œå¯é€²ä¸€æ­¥å¯¦ç¾ç·¨è¼¯å™¨ï¼‰

### èˆ‡ sop.html çš„é—œä¿‚

**knowledge.html**: å…§éƒ¨çŸ¥è­˜åº«ï¼ˆéœ€ç™»å…¥ï¼‰
- åŒ…å« SOPã€å…§éƒ¨æ–‡æª”ã€FAQ
- å®Œæ•´çš„ç·¨è¼¯åŠŸèƒ½
- ç‰ˆæœ¬æ§åˆ¶

**sop.html**: å¯èƒ½æ˜¯å…¬é–‹ç‰ˆæœ¬æˆ–å°ˆé–€çš„ SOP ç®¡ç†é é¢
- å¦‚æœé‡è¤‡ï¼Œæ‡‰è©²æ•´åˆæˆ–å»¢æ£„å…¶ä¸­ä¸€å€‹

---

## ğŸ”§ å¯¦æ–½ç´°ç¯€

### æ–‡ä»¶é¡å‹åˆ‡æ›
```javascript
// æ ¹æ“š document_type é¡¯ç¤ºä¸åŒåœ–ç¤ºå’Œæ¨£å¼
function getDocumentIcon(type) {
  const icons = {
    sop: 'description',
    internal_doc: 'article',
    faq: 'help'
  };
  return icons[type] || 'description';
}

function getDocumentBadgeColor(type) {
  const colors = {
    sop: 'blue',
    internal_doc: 'green',
    faq: 'orange'
  };
  return colors[type] || 'gray';
}
```

### å¿«é€Ÿå°èˆª
```javascript
// éºµåŒ…å±‘å°èˆª
function renderBreadcrumb(category) {
  const path = getCategoryPath(category.id);
  return path.map(c => c.name).join(' > ');
}

// ç¯„ä¾‹ï¼šæœƒè¨ˆæœå‹™ > è¨˜å¸³æœå‹™ > æœˆåº¦è¨˜å¸³æµç¨‹
```

---

## ğŸ“Š çŸ¥è­˜åº«çµ±è¨ˆå„€è¡¨æ¿

### çµ±è¨ˆæŒ‡æ¨™
```sql
-- çŸ¥è­˜åº«ç¸½è¦½
SELECT 
  document_type,
  COUNT(*) as total_docs,
  SUM(views) as total_views,
  COUNT(DISTINCT author_id) as contributors
FROM sops
WHERE status = 'published'
GROUP BY document_type;
```

### ä½¿ç”¨åˆ†æ
```sql
-- æœ¬æœˆç†±é–€æ–‡ä»¶
SELECT 
  s.title,
  s.document_type,
  s.views,
  sc.name as category
FROM sops s
LEFT JOIN sop_categories sc ON s.category_id = sc.id
WHERE s.status = 'published'
  AND s.updated_at >= date('now', '-30 days')
ORDER BY s.views DESC
LIMIT 10;
```

---

## ğŸš€ æœªä¾†æ“´å±•

### è¨ˆåŠƒåŠŸèƒ½
- [ ] æ–‡ä»¶å”ä½œç·¨è¼¯
- [ ] è©•è«–èˆ‡è¨è«–
- [ ] æ–‡ä»¶é—œè¯æ¨è–¦
- [ ] å­¸ç¿’è·¯å¾‘ï¼ˆæ–°äººè¨“ç·´ï¼‰
- [ ] æ–‡ä»¶æœ‰æ•ˆæœŸé™èˆ‡å¯©æ ¸æé†’
- [ ] å¤šèªè¨€æ”¯æ´
- [ ] PDF åŒ¯å‡º
- [ ] æ–‡ä»¶ç¨½æ ¸è¿½è¹¤ï¼ˆèª°çœ‹éï¼‰
- [ ] AI è¼”åŠ©æœå°‹
- [ ] èªéŸ³è¼¸å…¥

---

## ğŸ”— èˆ‡å…¶ä»–ç³»çµ±æ•´åˆ

### èˆ‡ä»»å‹™ç³»çµ±æ•´åˆ
```javascript
// SOP å¯ä»¥é—œè¯åˆ°ä»»å‹™
// ä»»å‹™åŸ·è¡Œæ™‚å¯å¿«é€ŸæŸ¥çœ‹ç›¸é—œ SOP

// åœ¨ä»»å‹™è©³æƒ…ä¸­é¡¯ç¤º
<a href="knowledge.html?sop_id=5">æŸ¥çœ‹ç›¸é—œ SOP</a>
```

### èˆ‡å®¢æˆ¶æœå‹™æ•´åˆ
```javascript
// æœå‹™æª¢æŸ¥æ¸…å–®ç¯„æœ¬å¯ä»¥åƒè€ƒ SOP

// å»ºç«‹ç¯„æœ¬æ™‚
const sopReference = {
  service_type: 'vat',
  related_sop_id: 5,
  sop_title: 'ç‡Ÿæ¥­ç¨…ç”³å ±æµç¨‹'
};
```

---

**ç›¸é—œæ–‡æª”**ï¼š
- [ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md](./ç³»çµ±æ¶æ§‹è¨­è¨ˆ.md) - æ•´é«”æ¶æ§‹
- [ä»»å‹™ç®¡ç†ç³»çµ±è¨­è¨ˆ.md](./ä»»å‹™ç®¡ç†ç³»çµ±è¨­è¨ˆ.md) - ä»»å‹™æ•´åˆ
- [å…§å®¹ç®¡ç†ç³»çµ±è¨­è¨ˆ.md](./å…§å®¹ç®¡ç†ç³»çµ±è¨­è¨ˆ.md) - CMS æ•´åˆ
- [APIç«¯é»æ–‡æª”.md](./APIç«¯é»æ–‡æª”.md) - API åƒè€ƒ

### è³‡æ–™æ¨¡å‹è£œå……ï¼šSOP æ–‡ä»¶
- è¡¨ï¼š`sops`
  - `document_type` TEXT CHECK(document_type IN ('SOP','INTERNAL','FAQ')) DEFAULT 'SOP'
  - å…¶é¤˜æ¬„ä½ï¼š`title`, `category_id`, `content`, `version`, `status`, `business_type`, `created_by`, `updated_by`, `created_at`, `updated_at`
- è¡¨ï¼š`sop_tags`
  - ä½¿ç”¨é—œè¯è¡¨ç®¡ç†æ¨™ç±¤ï¼š`id`, `sop_id`, `tag`
  - å¥½è™•ï¼šå¯ç´¢å¼•ã€é¿å… JSON LIKE æŸ¥è©¢æ•ˆèƒ½å•é¡Œ

### API è¡Œç‚ºè£œå……
- GET `/api/sops` æ”¯æ´æŸ¥è©¢åƒæ•¸ï¼š
  - `category`ï¼šåˆ†é¡ ID
  - `business_type`ï¼šæ¥­å‹™é¡å‹
  - `status`ï¼š`draft|published|archived`
  - `document_type`ï¼š`SOP|INTERNAL|FAQ`

### è¨­è¨ˆåŸå‰‡èª¿æ•´
- åŸæœ¬è¦åŠƒä»¥ JSON æ¬„ä½å„²å­˜æ¨™ç±¤ï¼Œç¾æ”¹ç‚ºé—œè¯è¡¨ `sop_tags`ï¼Œä»¥æå‡æŸ¥è©¢èˆ‡ç´¢å¼•æ•ˆèƒ½ã€‚
- æ–°å¢ `document_type` æ¬„ä½ä»¥æ”¯æ´çŸ¥è­˜åº«é é¢æŒ‰é¡å‹åˆ†é é¡¯ç¤ºã€‚

