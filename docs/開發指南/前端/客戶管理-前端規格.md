# 客戶管理｜前端規格（UI/UX）

> 僅包含 UI、UX、畫面顯示與前端驗證；完全省略後端與資料庫細節。

---

## 1. 目標與範圍
- 管理客戶基本資料、負責人員、標籤、備註
- 支援列表查詢/搜尋、建立、編輯、刪除、標籤管理、批量分配負責人（管理員）
- 支援客戶服務設定入口（僅前端入口與表單欄位呈現）

---

## 2. 角色與可見性（前端）
- 員工（小型事務所彈性）：
  - 可見與可操作：查看所有、建立、編輯、刪除、管理標籤
  - 不可見：批量分配負責人入口
- 管理員：
  - 可見與可操作：查看所有、建立、編輯、刪除、管理標籤、批量分配負責人、批量刪除
- 權限不足處理：出現『權限不足』訊息條；隱藏對應操作按鈕

---

## 3. 主要畫面與元件

### 3.1 客戶列表頁
- 篩選/搜尋
  - 關鍵字搜尋（公司名稱；300ms debounce）
  - 分頁控制（每頁 50 筆）
- 表格欄位
  - 公司名稱、統一編號、負責人、標籤（chips）、電話、Email、建立時間
  - 操作：查看詳情、編輯、刪除
- 批量操作（僅管理員）
  - 多選列後顯示批量操作條：
    - 批量分配負責人（上限 100 筆；超出顯示警告）
    - 批量刪除（上限 100 筆；顯示可能關聯刪除提示）
- 空狀態
  - 顯示『尚無客戶』並提供『新增客戶』按鈕

### 3.2 新增/編輯客戶（Modal 或頁面）
- 表單欄位
  - 統一編號（必填，8 位數字，maxLength=8）
  - 公司名稱（必填，maxLength=100）
  - 負責人員（必填，下拉選單）
  - 電話（選填）
  - Email（選填，email 格式）
  - 客戶標籤（選填，多選 chips）
  - 客戶備註（選填，多行）
  - 收款備註（選填，多行）
- 操作
  - 取消、儲存（通過前端驗證前 disabled）
- 成功/失敗
  - 成功：Toast『已儲存』並返回列表/詳情
  - 失敗：顯示錯誤訊息條（採用後端回傳 message）

### 3.3 客戶詳情頁
- 區塊
  - 基本資料卡：公司名稱、統一編號、負責人員、聯絡方式、標籤
  - 備註卡：客戶備註、收款備註（可展開/收合）
  - 服務設定卡：顯示已設定的服務，並提供『設定服務』入口（進入 `ClientServiceForm`）
  - 快速操作：編輯、刪除

### 3.4 標籤管理（可內嵌/對話框）
- 列表：標籤名稱、顏色
- 操作：新增、修改名稱/顏色、刪除
- 客戶表單內 chips 支援新增標籤（若權限允許）

### 3.5 批量分配負責人（管理員）
- 對話框欄位
  - 選擇負責人（必填）
  - 顯示已選擇客戶數量（上限 100）
- 成功：Toast『批量分配成功』→ 刷新列表

---

## 4. 操作流程（UX）
- 新增：列表 → 新增 → 填表 → 儲存 → 成功提示
- 編輯：詳情/列表 → 編輯 → 修改 → 儲存 → 成功提示
- 刪除：詳情/列表 → 刪除 → 二次確認 → 成功提示 → 從列表移除
- 標籤管理：列表/表單 → 管理標籤 → 保存 → 更新 chips
- 批量分配（管理員）：列表多選 → 批量分配 → 選負責人 → 確認 → 成功提示

---

## 5. 前端驗證與錯誤訊息
- 統一編號：8 位數字 → 『統一編號必須為 8 位數字』
- 公司名稱：必填、1–100 字 → 『公司名稱為必填』
- Email：格式驗證 → 『Email 格式錯誤』
- 電話：依台灣電話格式（僅基本檢查）→ 『電話格式錯誤』
- 批量上限：選擇數量 > 100 → 顯示『批量操作最多 100 筆』
- 權限不足：顯示『您沒有權限執行此操作』
- 通用錯誤：顯示後端 message；未知錯誤顯示『操作失敗，請稍後再試』

---

## 6. 狀態與樣式
- 標籤 chips：顏色標示；多於 3 個時收合顯示『+N』
- 列表行 hover 顯示操作捷徑
- 刪除為危險動作（紅色按鈕、二次確認）

---

## 7. 無障礙與可用性
- 表單 Enter 送出、Esc 關閉 Modal
- 聚焦管理：開啟 Modal 自動聚焦第一欄位
- 表單驗證錯誤聚焦第一個錯誤欄位

---

## 8. 與其他模組之 UI 串接（僅前端表現）
- 客戶服務設定：導向 `ClientServiceForm`，用於設定服務與週期（任務自動生成由後端/排程處理）

---

## 9. 覆蓋之業務需求（對應）
- 角色：員工可查看/新增/編輯/刪除/標籤；管理員額外有批量分配與批量刪除
- 欄位：統一編號、公司名稱、負責人員、電話、Email、標籤、客戶備註、收款備註
- 重要功能：提供服務設定入口以支援後續任務生成
- 批量操作：上限 100 筆分配負責人
