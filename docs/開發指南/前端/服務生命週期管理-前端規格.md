# 服務生命週期管理｜前端規格（UI/UX）

> 僅包含 UI、UX、畫面顯示與前端驗證設計；不含任何後端或資料庫細節。

---

## 1. 目標與範圍
- 管理客戶服務狀態：啟用中（active）、已暫停（suspended）、已到期（expired）、已取消（cancelled）
- 支援行為：暫停、恢復、取消（取消僅管理員可見）、查看服務變更歷史
- 支援「預約暫停日期」：選擇未來日期後顯示排程狀態與提示

---

## 2. 角色與可見性（前端層級）
- 員工
  - 可見：暫停、恢復、查看歷史
  - 不可見：取消（隱藏按鈕與相關入口）
- 管理員
  - 可見：暫停、恢復、取消、查看歷史、狀態篩選總覽

> 若使用者無權限，對應按鈕不渲染；若以連結直接進入，顯示「權限不足」訊息條。

---

## 3. 主要畫面與元件

### 3.1 服務列表頁（客戶 > 服務）
- 元件
  - 搜尋輸入框（客戶名稱 / 服務名稱）
  - 狀態篩選籤：全部｜啟用中｜已暫停｜已到期｜已取消
  - 服務卡片（或表格列）：
    - 服務名稱、客戶名稱
    - 狀態徽章（顏色對應：active 綠、suspended 黃、expired 灰、cancelled 紅）
    - 下次週期資訊（如有）與是否已排程暫停之提示（小徽章「已排程」）
    - 進入詳情按鈕
- 互動
  - 即時搜尋（300ms debounce）
  - 篩選會重置分頁至第一頁
- 空狀態
  - 顯示「尚無符合條件的服務」

### 3.2 服務詳情頁
- 區塊
  - 標題區：服務名稱、客戶名稱、狀態徽章
  - 基本資訊：開始／結束日期、週期資訊、負責人
  - 排程提示（如存在未來暫停日期）：
    - 鮮明資訊條：
      - 文案：『已排程於 YYYY-MM-DD 暫停』
  - 操作區（按鈕列）：
    - 啟用中：顯示「暫停服務」「取消服務（管理員）」「查看歷史」
    - 已暫停：顯示「恢復服務」「取消服務（管理員）」「查看歷史」
    - 已到期：僅「查看歷史」
    - 已取消：僅「查看歷史」

---

## 4. 操作流程（UX）

### 4.1 暫停服務（含預約日期）
- 入口：
  - 服務詳情頁 > 按鈕「暫停服務」
- 對話框欄位：
  - 暫停生效日期（必填，日期選擇器，預設＝今日；最小值＝今日）
  - 暫停原因（必填，文字輸入，限制 200 字）
  - 備註（選填，限制 500 字）
- 驗證規則：
  - 日期不得早於今日
  - 原因不得為空；去除前後空白後長度 > 0
- 提示與結果：
  - 若日期＝今日：成功後顯示 Toast「服務已暫停」；狀態徽章即時更新為『已暫停』
  - 若日期＞今日：成功後顯示 Toast「已排程於 YYYY-MM-DD 暫停」；詳情頁顯示排程資訊條；狀態維持『啟用中』
- 失敗處理：
  - 顯示錯誤訊息條，內容使用後端回傳 message；保留已輸入內容

### 4.2 恢復服務
- 入口：
  - 服務詳情頁 > 按鈕「恢復服務」（僅在『已暫停』時顯示）
- 對話框欄位：
  - 備註（選填，限制 500 字）
- 提示與結果：
  - 成功後 Toast「服務已恢復」；狀態徽章更新為『啟用中』；移除任何排程提示
- 失敗處理：
  - 顯示錯誤訊息條

### 4.3 取消服務（管理員）
- 入口：
  - 服務詳情頁 > 按鈕「取消服務」（僅管理員）
- 對話框欄位：
  - 取消原因（必填，限制 200 字）
  - 同時取消相關未完成任務（選填，預設關閉；說明文字：『選取後，未完成任務將不可再操作』）
- 警示：
  - 顯示紅色警告框：『此操作不可恢復。請再次確認。』
- 確認：
  - 二次確認按鈕『我已了解，仍要取消』
- 提示與結果：
  - 成功後 Toast「服務已取消」；狀態徽章更新為『已取消』；隱藏操作按鈕

### 4.4 查看服務變更歷史
- 入口：
  - 服務詳情頁 > 按鈕「查看歷史」
- 呈現：側邊抽屜或對話框
  - 欄位：變更時間、操作者、舊狀態、新狀態、原因、備註
  - 依時間倒序；支援分頁／滾動載入
- 空狀態：『尚無歷史紀錄』

---

## 5. 狀態顯示與樣式
- 狀態徽章（僅前端樣式規範）：
  - active：綠底深綠字
  - suspended：黃底棕字
  - expired：灰底深灰字
  - cancelled：紅底深紅字
- 已排程暫停：於詳情頁標題下方顯示藍色資訊條，文案『已排程於 YYYY-MM-DD 暫停』

---

## 6. 前端驗證與錯誤訊息
- 通用
  - 欄位必填未填：『此欄位為必填』
  - 字數超過：『請勿超過 {max} 字』
  - 日期不合法：『請選擇有效日期』
  - 日期早於今日：『暫停生效日期不可早於今日』
- 操作級
  - 當前狀態不允許：顯示『目前狀態不允許此操作』
  - 權限不足：顯示『您沒有權限執行此操作』

---

## 7. 提示訊息（Toast／訊息條）
- 暫停（今日）：『服務已暫停』
- 暫停（排程）：『已排程於 YYYY-MM-DD 暫停』
- 恢復：『服務已恢復』
- 取消：『服務已取消』
- 請求失敗：顯示後端回傳 message；未知錯誤顯示『操作失敗，請稍後再試』

---

## 8. 輔助規範
- 可存檔的表單欄位在送出後清空；再次開啟對話框時重設為預設值
- 對話框的主要動作按鈕預設為禁用，直到通過前端驗證
- 全站一致的按鈕文案與順序：主要動作在右、取消在左
- 鍵盤可達性：
  - 對話框開啟自動聚焦第一個欄位
  - Esc 關閉、Enter 送出（通過驗證時）

---

## 9. 覆蓋之業務需求（對應）
- 角色與權限可視：員工（暫停、恢復、歷史）、管理員（暫停、恢復、取消、總覽）
- 狀態定義：active／suspended／expired／cancelled
- 使用範例支援：可選擇『暫停生效日期（未來）』、填寫原因與備註；12 月起不產生任務的效果將由後端實現，前端顯示排程提示與狀態同步
