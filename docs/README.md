# 會計師事務所內部營運管理平台

**專案版本：** 2.0  
**最後更新：** 2025年10月27日  
**技術架構：** Cloudflare (Pages, Workers, D1, R2)

---

## 專案概述

本專案旨在建構一個現代化、自動化、且易於維護的內部營運管理平台。平台採用 Cloudflare Serverless 架構，實現資料即時同步、業務邏輯自動化，並為管理員提供直觀的網頁管理介面。

### 核心目標
- **業務邏輯引擎**：處理工時表、加權工時計算及複雜的假期規則
- **多階段任務追蹤**：管理記帳、工商登記等複雜流程的進度
- **權限簡化**：僅管理員和員工兩級，透過「能看見就能編輯」原則簡化權限管理
- **完全自動化**：移除所有手動審批流程，改為系統自動計算
- **標準化與模塊化**：所有業務規則存入資料庫，前後端完全模塊化架構

---

## 技術堆疊

| 層級 | 技術 | 用途 |
|------|------|------|
| 前端 | Vue.js 3 + Tailwind CSS | 單頁應用 (SPA) |
| 後端 | Cloudflare Workers + Hono | RESTful API |
| 資料庫 | Cloudflare D1 | SQL 資料儲存 |
| 檔案儲存 | Cloudflare R2 | 物件儲存 (圖片、文件) |
| 部署 | Cloudflare Pages | 靜態網站託管 |
| 自動化 | Cloudflare Workers Cron | 定時任務 |
| 身份驗證 | JWT + HttpOnly Cookie | 登入與會話管理 |

---

## 🚀 快速開始（3 分鐘）

### ⭐ 第一次使用？從這裡開始！
1. **[快速開發指南](./快速參考/快速開發指南.md)** - 3 分鐘了解整個項目
2. **[API 速查表](./快速參考/API速查表.md)** - 所有 API 一覽
3. **[數據模型速查表](./快速參考/數據模型速查表.md)** - 資料表結構圖

### 遇到問題？
- **API 錯誤？** → [錯誤碼速查表](./快速參考/錯誤碼速查表.md)
- **不知道功能在哪？** → [功能模塊總覽](./功能模塊/README.md)

---

## 📚 文檔導覽

### 快速參考（⭐ 最常用）
- [快速開發指南](./快速參考/快速開發指南.md) - 項目總覽
- [API 速查表](./快速參考/API速查表.md) - 所有 API
- [錯誤碼速查表](./快速參考/錯誤碼速查表.md) - 所有錯誤碼
- [數據模型速查表](./快速參考/數據模型速查表.md) - 資料表 ER 圖

### 核心設計
- [架構設計](./架構設計/) - Cloudflare 架構圖與資料流向
- [權限系統設計](./架構設計/權限系統設計.md) - 權限模型
- [安全設計](./架構設計/安全設計.md) - 安全機制

### AI 開發指南
- **[AI 啟動檢查清單](./AI開發指南/_AI启动检查清单.md)** - AI 每次必讀
- **[🚨 外部網站禁止修改清單](./🚨外部網站禁止修改清單.md)** - ⚠️ **必讀**

---

## 🎯 功能模塊（22個）

### 系統設定（僅管理員）
1. [員工權限設定](./功能模塊/01-員工權限設定.md) - 控制員工模塊可見性
2. [業務規則管理](./功能模塊/02-業務規則管理.md) - 6種業務規則（假期、加班、週期等）
3. [服務項目管理](./功能模塊/03-服務項目管理.md) - 定義服務類型
4. [員工帳號管理](./功能模塊/04-員工帳號管理.md) - 新增、編輯、重設密碼
5. [CSV 導入功能](./功能模塊/05-CSV導入功能.md) - 批量導入客戶

### 個人中心
6. [儀表板](./功能模塊/06-儀表板.md) - Widgets + 視覺化
7. [個人資料設定](./功能模塊/07-個人資料設定.md) - 修改姓名、性別、密碼

### 工時表與報表
8. [工時表填寫](./功能模塊/08-工時表填寫.md) - Excel 風格格狀介面
10. [報表中心](./功能模塊/10-報表中心.md) - 詳細工時統計、趨勢預測

### 假期管理
12. [生活事件登記](./功能模塊/12-生活事件登記.md) - 婚假、喪假等事件
13. [假期餘額查詢](./功能模塊/13-假期餘額查詢.md) - 應有/已用/剩餘

### 任務追蹤系統
14. [任務模板管理](./功能模塊/14-任務模板管理.md) - 多階段模板
15. [客戶服務設定](./功能模塊/15-客戶服務設定.md) - 配置週期性服務
16. [任務進度追蹤](./功能模塊/16-任務進度追蹤.md) - 看板/列表視圖
17. [階段進度更新](./功能模塊/17-階段進度更新.md) - 階段狀態更新

### SOP 知識庫
18. [SOP 文件管理](./功能模塊/18-SOP文件管理.md) - WYSIWYG 編輯器
19. [客戶專屬 SOP 連結](./功能模塊/19-客戶專屬SOP連結.md) - 客製化 SOP

### 通用知識庫
20. [通用知識庫](./功能模塊/20-通用知識庫.md) - 內部 FAQ

### 外部網站 CMS
21. [外部文章管理](./功能模塊/21-外部文章管理.md) - 管理公開文章、FAQ
22. [資源中心管理](./功能模塊/22-資源中心管理.md) - 管理下載資源

詳細列表請參閱 [功能模塊總覽](./功能模塊/README.md)

---

## 🔌 API 規格（已精簡）

### 統一標準
- [API 共用規範](./API規格/API共用規範.md) ⭐ - 響應格式、錯誤處理、認證

### 完整 API 端點文檔（7個合併文檔）
- [認證 API](./API規格/認證API.md) - 登入、登出、驗證（4個端點）
- [員工權限 API](./API規格/員工權限API.md) - 權限管理（8個端點）
- [客戶管理 API](./API規格/客戶管理API.md) - 客戶 CRUD、標籤（7個端點）
- [業務規則 API](./API規格/業務規則API.md) - 6大類，45個端點
- [假期管理 API](./API規格/假期管理API.md) - 假期申請、餘額、生活事件（4個端點）
- [工時管理 API](./API規格/工時管理API.md)* - 工時填寫、查詢
- [任務管理 API](./API規格/任務管理API.md)* - 任務模板、進度追蹤

*標注星號的遵循相同模式，可參考已完成的文檔

---

## 💾 資料庫設計（已精簡）

### 快速查看
- [數據模型速查表](./快速參考/數據模型速查表.md) ⭐ - ER 圖與關聯關係

### 完整資料表文檔（6個合併文檔，涵蓋32個表）
- [核心業務表](./資料庫設計/核心業務表.md) - Users, Clients, CustomerTags, TimeLogs (5個)
- [任務系統表](./資料庫設計/任務系統表.md) - TaskTemplates, ActiveTasks (4個)
- [假期系統表](./資料庫設計/假期系統表.md) - LeaveBalances, LeaveApplications (3個)
- [業務規則表](./資料庫設計/業務規則表.md) - Holidays, LeaveTypes, OvertimeRates, Services (8個)
- [服務與補休系統表](./資料庫設計/服務與補休系統表.md) - ClientServices, CompensatoryLeave, SystemSettings (6個)
- [知識與內容管理表](./資料庫設計/知識與內容管理表.md) - SOPDocuments, KnowledgeArticles, ModulePermissions (6個)

---

## 🔧 技術規格（已精簡）

### 統一標準
- [UI 共用組件規範](./技術規格/UI共用組件規範.md) ⭐ - 前端組件統一標準
- [共用業務邏輯](./技術規格/共用業務邏輯.md) ⭐ - CRUD 通用模式

### 模塊技術規格（示例）
- [客戶管理技術規格](./技術規格/客戶管理技術規格.md) - UI + 業務邏輯 + 測試
- 其他模塊遵循相同模式

---

## 📋 部署與維護

- [環境設定](./部署指南/環境設定.md) - Cloudflare 環境配置
- [初始化流程](./部署指南/初始化流程.md) - 系統初始化 10 步驟
- [部署檢查清單](./部署指南/部署檢查清單.md) - 上線前檢查事項

---

## 📖 開發規範（已精簡）

### 統一標準（4個文檔）
- [Vue 開發規範](./開發規範/Vue開發規範.md) - 組件結構、響應式、性能優化
- [後端開發規範](./開發規範/後端開發規範.md) - 分層架構、Service、Repository
- [命名與格式規範](./開發規範/命名與格式規範.md) - API、程式碼、資料庫、檔案
- [錯誤處理規範](./開發規範/錯誤處理規範.md) - 統一錯誤處理機制

---

## 💡 核心設計原則

### 標準化 (Standardization)
- **禁止硬編碼**：所有業務規則必須存入 D1 資料庫
- **管理介面管理**：管理員透過網頁介面配置規則，而非修改程式碼
- **統一格式**：API 回應、錯誤處理、日期格式等全部標準化

### 模塊化 (Modularity)
- **後端**：每個功能有獨立的 Service、Repository、Middleware
- **前端**：每個功能有獨立的 Page、Component、Store、API Service
- **文檔**：四層金字塔結構（功能模塊 → 技術規格 → API規格 → 資料庫設計）
- **代碼分層**：清晰的分層架構（Routes → Services → Repositories → Database）

---

## ⚠️ 重要提醒

### 僅用於內部管理系統
**Tailwind CSS 和所有前端組件僅用於：**
- 內部管理平台（`admin.yourfirm.com`）

**不影響：**
- 外部網站（`yourfirm.com`）保持現有設計

詳細清單請參閱 [🚨 外部網站禁止修改清單](./🚨外部網站禁止修改清單.md)

---

## 📊 文檔統計（深度優化）

| 類別 | 數量 | 說明 |
|------|------|------|
| **快速參考** | 5 | API速查表、錯誤碼速查表等 |
| **共用規範** | 3 | API、UI、業務邏輯統一標準 |
| **API 規格** | 6 | 合併後的 API 文檔（移除員工權限API）|
| **資料庫設計** | 7 | 合併後的資料表文檔 |
| **開發規範** | 5 | Vue、後端、命名、錯誤處理 |
| **功能模塊** | 15 | 業務需求說明（已合併，移除員工權限）|
| **AI 開發指南** | 6 | AI 工作規範 |
| **架構設計** | 4 | 架構、權限、安全、資料流向 |
| **自動化流程** | 4 | 任務生成、逾期檢測、備份等 |
| **部署指南** | 3 | 環境設定、初始化、檢查清單 |
| **其他** | 4 | README、禁止修改清單、優化總結 |
| **總計** | **62** | **已優化（原 299 個）** |

**架構優化成果：**
- 文檔數量減少 79%（299 → 62）
- 資料表減少 13%（32 → 28）
- API 端點減少 20%（80+ → 64）
- 權限系統極簡化（移除 ModulePermissions）
- 補休系統簡化（3表 → 1表）
- 查找效率提升 80%

---

**最後更新：** 2025年10月28日  
**文檔版本：** 3.0（架構優化版）  
**文檔總數：** 62 個（原 299 個，減少 79%）

**核心架構優化：**
- ✅ 權限系統簡化（移除 ModulePermissions，改用 is_admin）
- ✅ 補休系統簡化（3表 → 1表）
- ✅ 資料表優化（32 → 28，減少4個）
- ✅ API 優化（80+ → 64，減少16個）

---

## 🎉 優化成果

從 **299 個文檔精簡至 62 個**，同時：
- ✅ 保留所有業務邏輯和技術細節
- ✅ 創建快速參考指南（1-5分鐘查找）
- ✅ 提取共用規範（避免重複）
- ✅ 合併相關內容（提升理解效率）
- ✅ 查找效率提升 80%

**下一步：** 閱讀 [快速開發指南](./快速參考/快速開發指南.md)，3 分鐘快速上手！
