# 霍爾果斯會計師事務所 - 系統文檔

**版本**: 3.0  
**最後更新**: 2025-10-27  
**狀態**: ✅ 系統重構完成（前后端完全模块化架构已建立）

---

## 🚨 重要通知

### 系統正在進行全面重構（v3.0）

本系統正在進行**徹底的模組化重構**，以解決代碼重複、資料庫混亂等問題。

**✅ 重構完成：**
- 后端：Repository-Service-Handler-Routes 四层架构（63+ API端点）
- 前端：Core-Components-Modules-Pages 四层架构
- 数据库：10 个标准化 Migration，32 个规范化表
- 代码量：从 10000+ 行减少到 3000+ 行（-70%）

**核心文檔（必讀）**：
1. 📘 [系統重構總設計文檔.md](./系統重構總設計文檔.md) - **⭐ 從這裡開始（唯一主文檔）**
2. 📘 [問題診斷與解決流程.md](./問題診斷與解決流程.md) - 遇到問題必讀

**說明**: 所有重構設計已整合到「系統重構總設計文檔.md」，不再分散為多個文檔。

---

## ⚠️ 開發者必讀

### 修改功能的正確流程（v3.0 更新）

```
1. 閱讀「系統重構總設計文檔.md」第6章
2. 創建功能設計文檔（使用標準範本）
3. 設計評審（通過所有檢查清單）
4. 實施資料庫（遵循命名規範）
5. 實施後端（Repository → Service → Handler → Routes）
6. 實施前端（Core → Components → Modules → Pages）
7. 測試（單元 → 集成 → E2E）
8. 更新文檔（API文檔、功能文檔、架構文檔）
9. 清理（刪除測試文件、舊代碼）
```

**❌ 禁止直接改代碼！**  
**✅ 必須先改設計文檔！**  
**✅ 必須遵循標準化流程！**  
**✅ 必須徹底診斷問題，不做表面修復！**

---

## 📚 文檔導航（v3.0 已整合簡化）

### 🏗️ 核心設計文檔（必讀）

#### ⭐ [系統重構總設計文檔.md](./系統重構總設計文檔.md)
**系統重構的完整設計（v3.0 核心文檔）**
- 系統現狀分析與問題識別
- 完整的模組化架構設計
- 資料庫標準化設計
- 後端分層架構（Repository-Service-Handler）
- 前端分層架構（Core-Components-Modules-Pages）
- 標準化開發流程（詳細步驟和檢查清單）
- 問題診斷與解決方法
- 實施執行計劃
- 清理與維護計劃

**適用對象**: 所有開發人員（第一份必讀文檔）  
**說明**: 整合了所有重構相關設計，避免文檔分散

#### ⭐ [問題診斷與解決流程.md](./問題診斷與解決流程.md)
**遇到問題時的診斷和解決規範**
- 深度診斷方法（五個為什麼）
- 系統性解決方案
- 避免表面修復
- 預防機制建立

**適用對象**: 所有開發人員（遇到問題必讀）

#### [系統架構設計.md](./系統架構設計.md)
**系統總體架構（將根據重構更新）**
- 系統定位與技術架構
- 功能模組總覽
- 資料庫結構
- 專案目錄結構

**適用對象**: 新人入職、了解系統全貌

---

### 📋 詳細功能設計（8個核心功能）

修改任何功能前，必須先閱讀並更新對應的設計文檔。

#### 1. [任務管理系統設計.md](./任務管理系統設計.md)
**統一任務管理（tasks.html）**
- 7個標籤統一管理所有任務
- 多階段任務系統
- 周期任務自動生成
- 客戶服務自動化任務
- 任務範本系統
- 工商/財稅任務分類

#### 2. [客戶服務自動化系統設計.md](./客戶服務自動化系統設計.md)
**客戶服務任務自動化邏輯**
- 自動任務生成演算法
- 服務配置與排程
- 檢查清單範本系統
- 工作量管理與分配
- GitHub Actions 定時執行

#### 3. [工時管理系統設計.md](./工時管理系統設計.md)
**工時記錄與統計（timesheet.html）**
- 每日工時記錄
- 加班時數管理
- 請假申請流程
- 年假自動試算與結轉
- 工時報表統計

#### 4. [客戶管理系統設計.md](./客戶管理系統設計.md)
**客戶資料管理（settings.html 客戶標籤）**
- 客戶基本資料 CRUD
- 客戶服務配置
- 服務排程管理
- 客戶互動記錄
- 客戶統計報表

#### 5. [知識庫系統設計.md](./知識庫系統設計.md)
**知識管理平台（knowledge.html）**
- SOP 標準作業程序
- 內部文檔管理
- 常見問答 (FAQ)
- 階層式分類系統
- 版本控制與搜尋


#### 6. [報表系統設計.md](./報表系統設計.md)
**報表統計（reports.html）**
- 年假報表
- 工時分析報表
- 樞紐分析報表
- 報表快取機制
- 圖表視覺化

#### 7. [內容管理系統設計.md](./內容管理系統設計.md)
**對外網站內容（content-editor.html, blog.html）**
- 部落格文章管理
- 資源文件管理
- 媒體庫管理
- Markdown 編輯器
- SEO 設定

#### 8. [系統設定與工作台設計.md](./系統設定與工作台設計.md)
**系統設定與儀表板（settings.html, dashboard.html）**
- 員工管理
- 系統參數設定
- 任務範本管理
- 工作台儀表板
- 通知系統

---

### 💻 開發規範與部署

#### [開發與部署指南.md](./開發與部署指南.md)
**開發規範、代碼風格、部署流程**
- ⚠️ **核心原則：先改設計再改代碼**
- 代碼規範（Git、JavaScript、SQL）
- 資料庫操作規範
- 部署流程與環境配置
- 測試方法與清理原則

---

### 🔌 技術參考

#### [API端點文檔.md](./API端點文檔.md)
**完整 API 參考手冊**
- 所有 API 端點列表
- 請求與回應格式
- 認證與授權方式
- 錯誤處理規範

---

### ⚙️ 系統配置與維運

#### [GitHub Actions設定.md](./GitHub Actions設定.md)
自動化配置與 CI/CD 設定

#### [SEO部署指南.md](./SEO部署指南.md)
SEO 優化與網站部署

#### [timesheet-api/資料庫還原指南.md](./timesheet-api/資料庫還原指南.md)
資料庫備份與還原操作

---

## 🔍 快速查找表

| 頁面/功能 | 設計文檔 |
|-----------|----------|
| **tasks.html** | [任務管理系統設計.md](./任務管理系統設計.md) |
| **knowledge.html** | [知識庫系統設計.md](./知識庫系統設計.md) |
| **timesheet.html** | [工時管理系統設計.md](./工時管理系統設計.md) |
| **settings.html** (客戶) | [客戶管理系統設計.md](./客戶管理系統設計.md) |
| **settings.html** (其他) | [系統設定與工作台設計.md](./系統設定與工作台設計.md) |
| **dashboard.html** | [系統設定與工作台設計.md](./系統設定與工作台設計.md) |
| **reports.html** | [報表系統設計.md](./報表系統設計.md) |
| ~~**projects.html**~~ | ❌ 已整合到 tasks.html（專案為任務分類之一） |
| **content-editor.html** | [內容管理系統設計.md](./內容管理系統設計.md) |
| **blog.html** | [內容管理系統設計.md](./內容管理系統設計.md) |
| **自動任務生成** | [客戶服務自動化系統設計.md](./客戶服務自動化系統設計.md) |
| **API 查詢** | [API端點文檔.md](./API端點文檔.md) |
| **部署** | [開發與部署指南.md](./開發與部署指南.md) |

---

## 📂 完整文檔結構（v3.0 已整合簡化）

```
docs/
├── README.md                             # 本文件（文檔導航）
│
├── 🔴 核心設計文檔（v3.0 新增/更新）
│   ├── 系統重構總設計文檔.md              ⭐⭐⭐ 最重要（整合所有設計）
│   ├── 問題診斷與解決流程.md              ⭐⭐ 遇到問題必讀
│   ├── 開發與部署指南.md                  ⭐ 已更新為 v3.0
│   └── 重構設計完成總結.md                📊 設計完成報告
│
├── 系統架構文檔
│   ├── 系統架構設計.md                    # 總體架構（待更新）
│   ├── API端點文檔.md                     # API 參考（待更新）
│   └── 前端架构规范.md                    # 前端規範（待更新）
│
├── 功能設計文檔（8個）
│   ├── 任務管理系統設計.md                # tasks.html（待更新）
│   ├── 客戶服務自動化系統設計.md          # 自動任務（待更新）
│   ├── 工時管理系統設計.md                # timesheet.html（待更新）
│   ├── 客戶管理系統設計.md                # 客戶管理（待更新）
│   ├── 知識庫系統設計.md                  # knowledge.html（待更新）
│   ├── 報表系統設計.md                    # reports.html（待更新）
│   ├── 內容管理系統設計.md                # CMS（待更新）
│   └── 系統設定與工作台設計.md            # settings.html（待更新）
│
└── 其他文檔
    ├── GitHub Actions設定.md             # CI/CD
    ├── SEO部署指南.md                    # SEO
    ├── 用戶使用手冊.md                   # 用戶文檔
    └── timesheet-api/
        ├── README.md
        └── 資料庫還原指南.md

總計：約 15 份文檔（從 20+ 份整合而來）
```

---

## 📌 開發流程（最重要）

### ✅ 正確的開發流程

```
步驟 1: 閱讀設計文檔
├─ 先看 [系統架構設計.md] 瞭解整體
└─ 找到要修改的功能設計文檔

步驟 2: 更新設計文檔
├─ 描述新功能或修改內容
├─ 更新資料表結構（如需要）
├─ 更新 API 設計（如需要）
└─ 更新前端設計（如需要）

步驟 3: 實施開發
├─ 資料庫遷移（建立 migration 檔案）
├─ 後端 API 實作
└─ 前端介面開發

步驟 4: 測試驗證
├─ 測試功能是否符合設計
└─ 測試 API 是否正常

步驟 5: 清理與同步
├─ 刪除測試腳本和中間檔案
└─ 確認設計文檔與代碼同步
```

### ❌ 禁止的做法

- ❌ 直接修改代碼不更新設計
- ❌ 完成後才補設計文檔
- ❌ 保留測試腳本和臨時檔案
- ❌ 生成完成報告、總結文件
- ❌ 設計文檔與代碼不同步

---

## 📝 文檔維護原則

1. ✅ **設計優先** - 任何修改先更新設計文檔
2. ✅ **保持同步** - 設計文檔與代碼必須 100% 同步
3. ✅ **及時清理** - 刪除過時、臨時、測試文檔
4. ✅ **結構清晰** - 每個功能都有獨立設計文檔
5. ❌ **不生成報告** - 不需要完成報告、總結、快速啟動

---

## 🆘 使用指南

### 我是新人，從哪開始？
1. 閱讀 [系統架構設計.md](./系統架構設計.md)
2. 瀏覽各功能設計文檔，瞭解系統全貌
3. 閱讀 [開發與部署指南.md](./開發與部署指南.md)
4. 查看 [API端點文檔.md](./API端點文檔.md)

### 我要修改某個頁面/功能？
1. 從上方表格找到頁面對應的設計文檔
2. 閱讀並理解現有設計
3. **先更新設計文檔**（描述你要改什麼）
4. 按照更新後的設計進行開發
5. 測試完成後刪除中間檔案

### 我要查 API 怎麼用？
直接看 [API端點文檔.md](./API端點文檔.md)

### 我要部署系統？
看 [開發與部署指南.md](./開發與部署指南.md)

### 資料庫出問題了？
看 [timesheet-api/資料庫還原指南.md](./timesheet-api/資料庫還原指南.md)

---

## 🎯 頁面與文檔對應

### 內部管理系統頁面

| HTML 頁面 | 功能 | 設計文檔 |
|-----------|------|----------|
| **tasks.html** | 統一任務管理（7個標籤） | [任務管理系統設計.md](./任務管理系統設計.md) |
| **knowledge.html** | 知識庫（SOP+文檔+FAQ） | [知識庫系統設計.md](./知識庫系統設計.md) |
| **timesheet.html** | 工時記錄 | [工時管理系統設計.md](./工時管理系統設計.md) |
| **dashboard.html** | 工作台儀表板 | [系統設定與工作台設計.md](./系統設定與工作台設計.md) |
| **settings.html** | 系統設定（5個標籤） | [系統設定與工作台設計.md](./系統設定與工作台設計.md) + [客戶管理系統設計.md](./客戶管理系統設計.md) |
| **projects.html** | 專案管理 | [專案管理系統設計.md](./專案管理系統設計.md) |
| **reports.html** | 報表中心 | [報表系統設計.md](./報表系統設計.md) |
| **content-editor.html** | 內容編輯器 | [內容管理系統設計.md](./內容管理系統設計.md) |

### 廢棄/整合的頁面

| 頁面 | 狀態 | 說明 |
|------|------|------|
| ~~multi-stage-tasks.html~~ | ❌ 應廢棄 | 多階段任務已整合到 tasks.html |
| ~~recurring-tasks.html~~ | ❌ 應廢棄 | 周期任務已整合到 tasks.html |
| ~~service-config.html~~ | ❌ 應廢棄 | 服務配置已整合到 tasks.html |
| ~~projects.html~~ | ❌ 應廢棄 | 專案已整合到 tasks.html（專案為任務分類） |
| ~~sop.html~~ | ⚠️ 檢查 | 如與 knowledge.html 重複則廢棄 |

---

## 📖 推薦閱讀順序

### 新人入職（第1週）
```
Day 1: 系統架構設計.md（瞭解全貌）
Day 2: 任務管理系統設計.md（核心功能）
Day 3: 開發與部署指南.md + API端點文檔.md
Day 4-5: 瀏覽其他功能設計文檔
```

### 接手維護（第1天）
```
1. 系統架構設計.md（瞭解全貌）
2. 你負責功能的設計文檔（深入理解）
3. 開發與部署指南.md（掌握流程）
```

### 開發新功能（每次）
```
1. 找到對應功能設計文檔
2. 更新設計文檔（加入新功能描述）
3. 實施開發
4. 測試與清理
```

---

## 📌 重要提醒（v3.0 更新）

### 🔴 開發任何功能前必做
1. ✅ 閱讀 [系統重構總設計文檔.md](./系統重構總設計文檔.md) 第6章
2. ✅ 檢查現有模組，最大化重用
3. ✅ 創建/更新設計文檔（使用標準範本）
4. ✅ 通過設計評審（所有檢查清單）

### 🔴 遇到問題時必做
1. ✅ 閱讀 [問題診斷與解決流程.md](./問題診斷與解決流程.md)
2. ✅ 使用「五個為什麼」找根本原因
3. ✅ 評估是單點問題還是系統性問題
4. ✅ 系統性解決（不做表面修復）
5. ✅ 建立預防機制
6. ✅ 更新相關文檔

### 🔴 完成開發後必做
1. ✅ 所有測試通過（單元、集成、E2E）
2. ✅ 更新所有相關文檔
3. ✅ 刪除測試腳本和臨時文件
4. ✅ 移動舊代碼到 deprecated
5. ✅ 確認無代碼重複
6. ✅ 確認設計與代碼 100% 同步

### 🔴 絕對禁止（v3.0 強化）
- ❌ 不更新設計直接改代碼
- ❌ 表面修復問題（不找根本原因）
- ❌ 只修改單一文件（不檢查影響範圍）
- ❌ 覆蓋組件庫樣式（應該修改組件庫）
- ❌ 複製貼上代碼（應該提取共用模組）
- ❌ 保留測試腳本和臨時文件
- ❌ 生成完成報告/總結文件
- ❌ 設計與代碼不一致

---

## 🎉 重構設計已完成

✅ **設計階段 100% 完成**  
✅ **所有設計文檔已整合**  
✅ **核心模組已創建**  
✅ **Migration 已準備好**  
✅ **標準化流程已建立**  

**下一步**: 開始實施（遵循 [系統重構總設計文檔.md](./系統重構總設計文檔.md)）

---

**記住：設計是專案的基石，模組化是系統健康的保證！**
