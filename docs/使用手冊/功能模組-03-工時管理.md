# 工時管理

對應規格：前端 `docs/開發指南/前端/工時管理-前端規格.md`；後端 `docs/開發指南/後端/工時管理-後端規格.md`

**用途：** 記錄每天的工作時間，自動計算加班費和補休。

---

## 角色與權限

### 員工可以做什麼
- 填寫自己的工時
- 修改自己的工時
- 刪除自己的工時
- 查看自己的工時統計
- 看不到別人的工時
- 不能填別人的工時

### 管理員可以做什麼
- 查看所有人的工時
- 查看工時統計報表
- 通常不幫員工填工時（管理原則）

---

## 工時表呈現方式（試算表介面）

**整體設計：** 類似 Excel 的表格介面，左側列出客戶與工作類型，上方為日期欄位（週一至週日），直接在表格儲存格中輸入工時數字。

### 表格結構
- **列（Row）**：每列代表一個工時記錄的組合，包含三個下拉選單
  - 客戶欄：下拉選單（選擇客戶名稱）
  - 業務類型欄：下拉選單（記帳、稅務申報等）
  - 工時類型欄：下拉選單（正常工時、平日加班前2h等）
- **欄（Column）**：每欄代表一個日期（週一至週日）
- **儲存格（Cell）**：直接輸入工時數字（0.5 的倍數）

### 填寫方式
1. **選擇列的設定**：
   - 在每列的「客戶」下拉選單選擇客戶
   - 在「業務類型」下拉選單選擇業務（記帳、稅務等）
   - 在「工時類型」下拉選單選擇類型（正常工時、加班等）
2. **填寫工時**：
   - 在該列的日期欄位中，點擊對應日期的儲存格
   - 直接輸入工時數字
3. **自動儲存**：輸入完成後按 Enter 或點擊其他儲存格，自動儲存
4. **快速填寫**：使用 Tab 鍵或方向鍵在儲存格間快速移動
5. **數字輸入**：只能輸入 0.5 的倍數（0.5, 1, 1.5, 2, 2.5... 最多 12）

### 新增列與刪除列
- **新增列**：點擊「新增列」按鈕，在表格底部新增一列空白列，所有下拉選單皆可選擇
- **刪除列**：點擊列左側的刪除圖示，可刪除該列（需確認）
- **預設列**：系統會根據用戶常用的客戶與業務組合，預先建立常用列

## 工作類型選項（下拉選單）

**選項 1：正常工時**
- 說明：一般上班時間（每日8小時內）
- 費率：1.0 倍
- 是否產生補休：不產生

**選項 2：平日加班（前2小時）**
- 說明：平日第 9-10 小時的延長工時
- 費率：1.34 倍
- 是否產生補休：產生補休（1:1）
- 適用時段：當天工作的第 9-10 小時

**選項 3：平日加班（後2小時）**
- 說明：平日第 11-12 小時的延長工時
- 費率：1.67 倍
- 是否產生補休：產生補休（1:1）
- 適用時段：當天工作的第 11-12 小時

**選項 4：休息日加班（前2小時）**
- 說明：休息日（通常週六）工作的前2小時
- 費率：1.34 倍
- 是否產生補休：產生補休（1:1）

**選項 5：休息日加班（第3-8小時）**
- 說明：休息日工作的第3-8小時
- 費率：1.67 倍
- 是否產生補休：產生補休（1:1）

**選項 6：休息日加班（第9-12小時）**
- 說明：休息日工作的第9-12小時
- 費率：2.67 倍
- 是否產生補休：產生補休（1:1）

**選項 7：國定假日加班（8小時內）**
- 說明：國定假日（如端午、中秋、國慶）出勤工作
- 費率：加發 1 日工資（雙倍薪，即使只上 1 小時也算 1 日）
- 是否產生補休：產生補休（統一8小時，與加班費對等）
- 適用日期：由系統國定假日設定決定
- 特別說明：不論實際工作幾小時（1小時或7小時），補休統一產生8小時

**選項 8：國定假日加班（第9-10小時）**
- 說明：國定假日工作超過8小時的第9-10小時
- 費率：1.34 倍
- 是否產生補休：產生補休（1:1）

**選項 9：國定假日加班（第11-12小時）**
- 說明：國定假日工作的第11-12小時
- 費率：1.67 倍
- 是否產生補休：產生補休（1:1）

**選項 10：例假日加班（8小時內）**
- 說明：例假日（通常週日）出勤工作
- 費率：加發 1 日工資 + 強制補休 1 天
- 是否產生補休：強制產生補休（統一8小時，與加班費對等）
- 原則上禁止：僅限天災、事變或突發事件，需主管機關核備
- 特別說明：不論實際工作幾小時，補休統一產生8小時

**選項 11：例假日加班（第9-12小時）**
- 說明：例假日工作超過8小時的第9-12小時
- 費率：2.0 倍
- 是否產生補休：產生補休（1:1）
- 原則上禁止

---

## 實際填寫範例（試算表模式）

### 範例 1：正常上班
```
員工 A 在試算表中填寫 2025年11月1日（週五）工時：

表格畫面：
┌──────────────┬──────────┬──────────┬───┬───┬───┬───┬ 週五 ┐
│ 客戶 ▼       │業務類型▼ │工時類型▼ │週一│週二│週三│週四│(11/1)│
├──────────────┼──────────┼──────────┼───┼───┼───┼───┼──────┤
│[選擇客戶...] │[選擇...] │[選擇...] │   │   │   │   │      │← 空白列
└──────────────┴──────────┴──────────┴───┴───┴───┴───┴──────┘

步驟 1：在第一列的「客戶」下拉選單，選擇「測試科技有限公司」
步驟 2：在「業務類型」下拉選單，選擇「記帳」
步驟 3：在「工時類型」下拉選單，選擇「正常工時」
步驟 4：點擊週五欄位的儲存格，輸入 8
步驟 5：按 Enter

設定完成後表格顯示：
┌──────────────┬──────────┬──────────┬───┬───┬───┬───┬──────┐
│ 客戶 ▼       │業務類型▼ │工時類型▼ │週一│週二│週三│週四│週五  │
├──────────────┼──────────┼──────────┼───┼───┼───┼───┼──────┤
│測試科技有限  │ 記帳     │正常工時  │   │   │   │   │  8   │
└──────────────┴──────────┴──────────┴───┴───┴───┴───┴──────┘

自動儲存後：
✓ 記錄 8 小時正常工時
✓ 加權工時 = 8 × 1.0 = 8 小時
✓ 不產生補休（因為是正常工時）
✓ 這 8 小時會列入客戶成本計算
```

### 範例 2：週六加班
```
員工 A 在試算表中填寫 2025年11月2日（週六）工時：

需要新增兩列來記錄不同費率的加班：

第一列設定：
- 客戶：測試科技有限公司
- 業務類型：稅務申報  
- 工時類型：休息日加班（前2小時）
- 週六格：輸入 2

第二列設定（點擊「新增列」按鈕）：
- 客戶：測試科技有限公司
- 業務類型：稅務申報
- 工時類型：休息日加班（第3-8小時）
- 週六格：輸入 2

完成後表格顯示：
┌──────────────┬──────────┬──────────────┬───┬ 週六 ┬───┐
│ 客戶 ▼       │業務類型▼ │工時類型▼     │週五│(11/2)│週日│
├──────────────┼──────────┼──────────────┼───┼──────┼───┤
│測試科技有限  │稅務申報  │休息日加班前2h│   │  2   │   │
│測試科技有限  │稅務申報  │休息日加班3-8h│   │  2   │   │
└──────────────┴──────────┴──────────────┴───┴──────┴───┘

自動儲存後：
✓ 記錄 4 小時實際工時（2+2）
✓ 系統自動計算加班費：2×1.34 + 2×1.67
✓ 自動產生補休 = 4 小時（1:1）
✓ 補休有效期：到 11月30日
```

### 範例 3：平日晚上加班 2 小時
```
員工 B 在試算表中填寫 2025年11月4日（週一）工時：

第一列：
- 客戶下拉選單：選擇「ABC公司」
- 業務類型下拉選單：選擇「記帳」
- 工時類型下拉選單：選擇「正常工時」
- 週一格：輸入 8

第二列（新增）：
- 客戶下拉選單：選擇「ABC公司」
- 業務類型下拉選單：選擇「記帳」
- 工時類型下拉選單：選擇「平日加班（前2小時）」
- 週一格：輸入 2

自動儲存後：
✓ 當天總共 10 小時工時
✓ 正常 8 小時 + 加班 2 小時（第9-10小時）
✓ 加班費 = 2 × 時薪 × 1.34
✓ 產生補休 2 小時（1:1）
```

### 範例 4：一週多天工作
```
員工 C 可在試算表中一次填寫整週工時：

設定第一列：客戶▼ABC公司 | 業務類型▼記帳 | 工時類型▼正常工時
設定第二列：客戶▼ABC公司 | 業務類型▼記帳 | 工時類型▼平日加班前2h

然後在各日期格子填入數字：

┌──────┬────────┬────────┬週一┬週二┬週三┬週四┬週五┬週六┬週日┐
│客戶▼ │業務類型▼│工時類型▼│ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │ 10│
├──────┼────────┼────────┼───┼───┼───┼───┼───┼───┼───┤
│ABC   │記帳    │正常工時│ 8 │ 8 │ 8 │ 8 │ 8 │   │   │
│ABC   │記帳    │平日加班│   │   │ 2 │   │   │   │   │
└──────┴────────┴────────┴───┴───┴───┴───┴───┴───┴───┘

優勢：
✓ 可快速瀏覽整週工時
✓ Tab 鍵快速移動填寫
✓ 每個格子自動儲存
✓ 一目瞭然查看工作分布
✓ 下拉選單設定一次，整週使用
```
