# 資料庫命名規範

**最後更新：** 2025年10月27日

---

## 1. 表格命名

### 規則：PascalCase（大駝峰）

```sql
✅ 正確：
CREATE TABLE Users (...);
CREATE TABLE Clients (...);
CREATE TABLE ClientServices (...);
CREATE TABLE ActiveTasks (...);
CREATE TABLE ModulePermissions (...);

❌ 錯誤：
CREATE TABLE users (...);              -- 不使用小寫
CREATE TABLE client_services (...);    -- 不使用 snake_case
CREATE TABLE clientservices (...);     -- 缺少可讀性
```

### 命名原則

- ✅ 使用複數形式（表示多筆記錄）
- ✅ 使用完整單字（避免縮寫）
- ✅ 關聯表使用兩個表名組合

```sql
✅ Users              -- 複數
✅ ClientServices     -- 關聯表：Client + Services
✅ ClientTagAssignments  -- 關聯表：Client + Tag + Assignments

❌ User               -- 不使用單數
❌ CS                 -- 不使用縮寫
```

---

## 2. 欄位命名

### 規則：snake_case（蛇形）

```sql
✅ 正確：
user_id INTEGER
company_name TEXT
created_at TEXT
is_active BOOLEAN
overtime_rate REAL

❌ 錯誤：
userId INTEGER       -- 不使用 camelCase
UserName TEXT        -- 不使用 PascalCase
CREATED_AT TEXT      -- 不使用大寫
```

---

## 3. 主鍵命名

### 規則：`{單數表名}_id`

```sql
✅ 正確：
-- Users 表
user_id INTEGER PRIMARY KEY

-- Clients 表
client_id TEXT PRIMARY KEY

-- TaskTemplates 表
task_template_id INTEGER PRIMARY KEY

❌ 錯誤：
id INTEGER           -- 不清楚是哪個表
user_pk INTEGER      -- 不使用 _pk 後綴
userId INTEGER       -- 不使用 camelCase
```

---

## 4. 外鍵命名

### 規則：與引用的主鍵相同

```sql
✅ 正確：
CREATE TABLE TimeLogs (
    log_id INTEGER PRIMARY KEY,
    user_id INTEGER,              -- 引用 Users.user_id
    client_id TEXT,               -- 引用 Clients.client_id
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (client_id) REFERENCES Clients(client_id)
);

❌ 錯誤：
CREATE TABLE TimeLogs (
    id INTEGER PRIMARY KEY,
    user INTEGER,                 -- 不清楚
    client TEXT                   -- 不清楚
);
```

---

## 5. 布林欄位命名

### 規則：使用 `is_` 或 `has_` 前綴

```sql
✅ 正確：
is_active BOOLEAN
is_deleted BOOLEAN
is_admin BOOLEAN
has_permission BOOLEAN

❌ 錯誤：
active BOOLEAN       -- 不清楚是狀態還是動作
deleted BOOLEAN      -- 不清楚含義
admin BOOLEAN        -- 不清楚是名詞還是狀態
```

---

## 6. 日期/時間欄位命名

### 規則：使用 `_at` 或 `_date` 後綴

```sql
✅ 正確：
created_at TEXT      -- 時間戳
updated_at TEXT
deleted_at TEXT
start_date TEXT      -- 日期
end_date TEXT
work_date TEXT

❌ 錯誤：
created TEXT         -- 不清楚是什麼
update TEXT
date TEXT            -- 太籠統
```

---

## 7. 索引命名

### 規則：`idx_{表名}_{欄位名}`

```sql
✅ 正確：
CREATE INDEX idx_clients_status ON Clients(status);
CREATE INDEX idx_time_logs_user_id ON TimeLogs(user_id);
CREATE INDEX idx_time_logs_work_date ON TimeLogs(work_date);

-- 複合索引
CREATE INDEX idx_time_logs_user_date ON TimeLogs(user_id, work_date);

❌ 錯誤：
CREATE INDEX index1 ON Clients(status);           -- 不清楚
CREATE INDEX clients_idx ON Clients(status);      -- 順序錯誤
```

---

## 8. 外鍵約束命名

### 規則：`fk_{表名}_{引用表名}`

```sql
✅ 正確：
CONSTRAINT fk_time_logs_users 
    FOREIGN KEY (user_id) REFERENCES Users(user_id)

CONSTRAINT fk_time_logs_clients 
    FOREIGN KEY (client_id) REFERENCES Clients(client_id)

❌ 錯誤：
CONSTRAINT fk1 FOREIGN KEY (user_id) ...          -- 不清楚
```

---

## 9. 標準欄位

### 所有表格必須包含（審計欄位）

```sql
created_at TEXT NOT NULL          -- 建立時間
updated_at TEXT NOT NULL          -- 更新時間
created_by INTEGER                -- 建立者
updated_by INTEGER                -- 更新者
```

### 重要表格應包含（軟刪除）

```sql
is_deleted BOOLEAN DEFAULT 0      -- 是否已刪除
deleted_at TEXT                   -- 刪除時間
deleted_by INTEGER                -- 刪除者
```

---

## 📝 完整範例

```sql
CREATE TABLE ClientTags (
    -- 主鍵
    tag_id INTEGER PRIMARY KEY AUTOINCREMENT,
    
    -- 業務欄位
    tag_name TEXT NOT NULL UNIQUE,
    tag_color TEXT,
    display_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT 1,
    
    -- 審計欄位
    created_at TEXT NOT NULL,
    updated_at TEXT NOT NULL,
    created_by INTEGER,
    updated_by INTEGER,
    
    -- 軟刪除
    is_deleted BOOLEAN DEFAULT 0,
    deleted_at TEXT,
    deleted_by INTEGER,
    
    -- 外鍵約束
    CONSTRAINT fk_client_tags_created_by 
        FOREIGN KEY (created_by) REFERENCES Users(user_id),
    CONSTRAINT fk_client_tags_updated_by 
        FOREIGN KEY (updated_by) REFERENCES Users(user_id),
    CONSTRAINT fk_client_tags_deleted_by 
        FOREIGN KEY (deleted_by) REFERENCES Users(user_id)
);

-- 索引
CREATE INDEX idx_client_tags_name ON ClientTags(tag_name);
CREATE INDEX idx_client_tags_active ON ClientTags(is_active);
CREATE INDEX idx_client_tags_deleted ON ClientTags(is_deleted);
```

---

## 相關文檔

- [程式碼命名](./程式碼命名.md)
- [資料庫設計標準](../後端開發/06-資料庫設計標準.md)

---

**最後更新：** 2025年10月27日





