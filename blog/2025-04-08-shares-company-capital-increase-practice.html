<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="發布日期：2025-04-08" />
  <title>股份轉換與可轉換公司債增資實務 | 霍爾果斯會計師事務所</title>
  
  
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <!-- Material Symbols 圖示庫 -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  
  <!-- 引用全站共用樣式 -->
  <link rel="stylesheet" href="/assets/css/common.css" />
  <link rel="stylesheet" href="/assets/css/navbar.css" />
  <link rel="stylesheet" href="/assets/css/footer.css" />
  
  <!-- 新增: 首頁特定樣式 - 用於流動式設計 -->
  <link rel="stylesheet" href="/assets/css/index-style.css" />
  
  <!-- 移動版導航欄樣式 -->
  <link rel="stylesheet" href="/assets/css/mobile-navbar.css" />
  
  <!-- 文章內頁專用現代化樣式 -->
  <link rel="stylesheet" href="/assets/css/blog-article-modern.css" />
  
  <!-- Google 分析 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RKMCS9WVS5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RKMCS9WVS5');
  </script>
  
  <!-- 結構化資料 -->
  <script type="application/ld+json">
  {"@context": "https://schema.org", "@type": "BlogPosting", "headline": "股份轉換與可轉換公司債增資實務", "description": "發布日期：2025-04-08", "image": "https://www.horgoscpa.com/assets/images/blog/business_1.jpg", "datePublished": "2025-04-08", "dateModified": "2025-04-08", "author": {"@type": "Person", "name": "霍爾果斯會計師事務所", "url": "https://www.horgoscpa.com/team.html"}, "publisher": {"@type": "Organization", "name": "霍爾果斯會計師事務所", "logo": {"@type": "ImageObject", "url": "https://www.horgoscpa.com/assets/images/logo.png"}}, "mainEntityOfPage": {"@type": "WebPage", "@id": "https://www.horgoscpa.com/blog/2025-04-08-shares-company-capital-increase-practice.html"}, "keywords": "公司, 股份, 轉換, 發行, 企業"}
  </script>
</head>
<body>

<!-- 導航欄 -->
<nav class="site-nav">
  <div class="nav-container">
    <div class="logo">
      <a href="/index.html">
        <div class="logo-container">
          <img src="/assets/images/logo-white.png" alt="霍爾果斯會計師事務所" class="logo-img">
          <div class="logo-sub">HorgosCPA</div>
        </div>
      </a>
    </div>
    <input type="checkbox" id="nav-toggle" class="nav-toggle">
    <label for="nav-toggle" class="nav-toggle-label">
      <span></span>
    </label>
    <ul class="nav-menu">
      <li><a href="/services.html">專業服務</a></li>
      <li><a href="/team.html">專業團隊</a></li>
      <li><a href="/blog.html" class="active">專欄文章</a></li>
      <li><a href="/faq.html">常見問題</a></li>
      <li><a href="/video.html">影音專區</a></li>
      <li><a href="/contact.html">聯繫我們</a></li>
      <li><a href="/booking.html" class="nav-consult-btn">免費諮詢</a></li>
    </ul>
  </div>
</nav>

<!-- 移動版導航欄 -->
<div class="mobile-navbar" style="display: none;">
  <div class="mobile-nav-container">
    <div class="mobile-menu-btn" id="mobileMenuBtn">
      <span class="material-symbols-rounded">menu</span>
    </div>
    <div class="logo">
      <a href="/index.html">
        <div class="logo-container">
          <img src="/assets/images/logo-white.png" alt="霍爾果斯會計師事務所" class="logo-img">
          <div class="logo-sub">HorgosCPA</div>
        </div>
      </a>
    </div>
    <div class="mobile-nav-spacer"></div>
  </div>
  
  <div class="mobile-menu" id="mobileMenu">
    <ul class="mobile-menu-links">
      <li><a href="/services.html" class="mobile-nav-link">專業服務</a></li>
      <li><a href="/team.html" class="mobile-nav-link">專業團隊</a></li>
      <li><a href="/blog.html" class="mobile-nav-link">專欄文章</a></li>
      <li><a href="/faq.html" class="mobile-nav-link">常見問題</a></li>
      <li><a href="/video.html" class="mobile-nav-link">影音專區</a></li>
      <li><a href="/contact.html" class="mobile-nav-link">聯繫我們</a></li>
      <li><a href="/booking.html" class="mobile-consult-btn">免費諮詢</a></li>
    </ul>
  </div>
</div>

<!-- 文章內容主體區塊 -->
<section class="article-content-section">
  <div class="article-container">
    <!-- 文章卡片 -->
    <article class="article-card">
      <!-- 文章元數據 -->
      <div class="article-meta">
        <div class="article-date">
          <span class="material-symbols-rounded">calendar_month</span>
          2025-04-08
        </div>
        <a href="/blog.html?category=business" class="article-category">
          <span class="material-symbols-rounded">sell</span>
          企業經營
        </a>
      </div>
      
      <!-- 文章標題區 -->
      <div class="article-header-main">
        <h1 class="article-title">股份轉換與可轉換公司債增資實務</h1>
      </div>
      
      <!-- 文章內容主體 -->
      <div class="article-body">
<p>發布日期：2025-04-08</p><h2>前言</h2><p>企業在發展過程中，常需要透過多元化的資本運作方式來達成策略目標。股份轉換與可轉換公司債是兩種截然不同但同樣重要的增資工具，前者常用於企業併購與組織重組，後者則為企業提供了一種兼具債務與權益特性的融資方式。本文將詳細解析股份轉換與可轉換公司債的法律依據、操作流程與實務問題，協助企業正確運用這兩種工具達成資本擴充與策略發展目標。</p><h2>股份轉換基本概念與法律依據</h2><p>股份轉換的定義</p><p>依據企業併購法第4條第5款規定，股份轉換是指「公司讓與全部已發行股份予他公司，而由他公司以股份、現金或其他財產支付公司股東作為對價之行為。」</p><p>股份轉換的主要特點是：</p><ol>
<li>讓與公司將其「全部」已發行股份轉讓予他公司</li>
<li>對價支付對象為讓與公司的股東，而非讓與公司本身</li>
<li>對價形式可以是股份、現金或其他財產</li>
</ol><p>法律依據</p><p>股份轉換的主要法律依據為企業併購法第29條、第30條：</p><p>「公司進行股份轉換時，公司董事會應就下列事項作成股份轉換契約，經股東會決議通過後實施： 一、承受公司之名稱、地址及負責人姓名。 二、股份轉換之給付方法與相關事項。 三、其他必要事項。」</p><p>此外，企業併購法第2條第1項規定：「公司之併購，依本法之規定；本法未規定者，依公司法...之規定。」</p><h2>股份轉換與股份交換的區別</h2><p>前一篇文章已介紹股份交換，現重點比較股份轉換與股份交換的區別：</p><p>在定義方面，股份轉換是指公司讓與全部已發行股份予他公司，而由他公司以股份、現金或其他財產支付公司股東作為對價；而股份交換則是指公司發行新股作為受讓他公司股份之對價。</p><p>在法律依據方面，股份轉換主要依據企業併購法第4條、第29條規定；而股份交換則依據公司法第156條之3規定。</p><p>決議機關的差異在於，股份轉換需經股東會特別決議；而股份交換僅需董事會特別決議即可。</p><p>在取得股份比例上，股份轉換必須取得標的公司100%股份；而股份交換則無特定限制，可部分取得他公司股份。</p><p>適用情境方面，股份轉換主要用於企業併購、集團組織重組等場景；而股份交換則適用於策略聯盟、交叉持股等目的。</p><p>依據經濟部109年10月19日經商字第10902047670號函釋：「依企業併購法第4條第5款、第31條之規定，作成股份轉換契約之主體為讓與『全部』已發行股份之公司及另一受讓股份並支付對價之他公司，以便利公司收購他公司『全部』股份，達成組織調整之目的，毋須向股東逐一收購，合先敘明。爰如公司向標的公司之個別股東訂立契約，以取得標的公司之股份，尚無企業併購法之適用。」</p><h2>股份轉換增資流程</h2><p>股份轉換增資的完整操作流程如下：</p><p>1. 董事會階段</p><ul>
<li>董事長召集董事會(公司法第203條之1)</li>
<li>召開董事會議訂定股份轉換契約及修正章程(如需修正章程)並召集股東會(公司法第171條)</li>
</ul><p>2. 股東會階段</p><ul>
<li>召開股東會決議通過股份轉換及修正章程(企業併購法第29條、第30條，公司法第277條)</li>
<li>股東會決議需達到特別決議門檻：已發行股份總數三分之二以上股東出席，出席股東表決權過半數同意</li>
</ul><p>3. 實施階段</p><ul>
<li>召開董事會決議發行新股細節並訂定發行新股基準日</li>
<li>排除公司法第267條之適用(不適用員工及原股東優先認股規定)</li>
<li>委託會計師查核簽證</li>
<li>基準日15日內備妥申請文件提出申請</li>
</ul><h2>可轉換公司債基本概念與法律依據</h2><p>可轉換公司債的定義</p><p>可轉換公司債是一種特殊的公司債券，持有人除了享有固定利息收入外，還可在特定條件下將債券轉換為公司股票。這兼具債務與權益特性的金融工具，提供了企業更靈活的融資選擇。</p><p>可轉換公司債的特點是：</p><ol>
<li>具有一般公司債的固定利息與到期還本特性</li>
<li>債權人有權在特定期間內依約定價格將債券轉換為公司股票</li>
<li>轉換價格通常會高於發行時的股票市價</li>
</ol><p>法律依據</p><p>可轉換公司債的主要法律依據為公司法第248條、第248條之1：</p><p>「公司發行公司債時，應載明左列事項，向證券管理機關辦理之...」</p><p>「公司債之發行，如由公司以現金發售，並經規定一定之發行總額、債券每張金額、利率、償還方式及期限、擔保方式、債券持有人之受託人、發行方式及其他發行條件之範圍，授權董事會於該範圍內發行者，不適用前條第一項有關股東會之規定。」</p><p>107年11月1日施行之新公司法第248條第2項修正開放非公發公司可發行轉換公司債或附認股權公司債：「公司發行以外貨幣計價之公司債、可轉換公司債或附認股權公司債，其計價之貨幣、發行總額、償還方式及期限、轉換或認股價格之計算方法、發行後轉換或認股價格之調整、債券持有人之受託人、發行方式及其他發行條件...」</p><p>公司債發行限制</p><p>公司法對公司債發行有以下限制：</p><ol>
<li>發行額度限制（公司法第247條）：公開發行公司：不得逾公司現有全部資產減去全部負債後之餘額無擔保公司債之總額：不得逾前項餘額二分之一非公開發行公司：無額度限制</li>
<li>發行禁止情形（公司法第250條）：對於前已發行之公司債或其他債務有違約或遲延支付本息之事實，尚在繼續中者最近三年或開業不及三年之開業年度課稅後之平均淨利，未達原定發行之公司債應負擔年息總額之百分之一百者（但經銀行保證發行之公司債不受限制）</li>
<li>無擔保公司債發行限制（公司法第249條）：對於前已發行之公司債或其他債務，曾有違約或遲延支付本息之事實已了結，自了結之日起三年內最近三年或開業不及三年之開業年度課稅後之平均淨利，未達原定發行之公司債，應負擔年息總額之百分之一百五十</li>
</ol><h2>可轉換公司債增資流程</h2><p>可轉換公司債從發行到轉換為股份的完整流程如下：</p><p>1. 公司債發行階段</p><ul>
<li>董事長以特別決議決定募集可轉換公司債(公司法第246條)</li>
<li>向股東會報告，檢視章程資本總額是否符合規定(公司法第246條、第248條)</li>
<li>股東會決議(非公開發行公司適用公司法第248條之1、閉鎖性公司視章程訂定第356條之11)</li>
<li>向證券管理機關申請(公司法第248條)</li>
<li>核准後備妥應募書並於指定網站公告、開始募集(公司法第252條)</li>
<li>應募人繳足債款</li>
</ul><p>2. 公司債轉換階段</p><ul>
<li>債權人向公司申請換發新股</li>
<li>公司最少一季辦理一次變更登記</li>
<li>召開董事會決議發行新股細節並訂定發行新股基準日(公司法第266條)</li>
<li>委託會計師查核簽證</li>
<li>基準日15日內備妥申請文件提出申請</li>
</ul><p>3. 特別注意事項</p><p>公司法第248條第7項規定：「第一項第十八款之可轉換股份數額或第十九款之可認購股份數額加計已發行股份總數、已發行轉換公司債可轉換股份總數、已發行附認股權公司債可認購股份總數、已發行附認股權特別股可認購股份總數及已發行認股權憑證可認購股份總數，如超過公司章程所定股份總數時，應先完成變更章程增加資本額後，始得為之。」</p><p>這意味著公司必須確保可轉換公司債轉換為股份後不會超過章程所定股份總數，否則應先修改章程增加資本額。</p><h2>實務案例解析</h2><p>案例一：透過股份轉換成立控股公司</p><p>甲公司與乙公司擬透過股份轉換方式組成控股公司架構，由新設立的丙控股公司同時受讓甲公司與乙公司100%股份。</p><p>實務處理：</p><ul>
<li>甲公司與乙公司分別召開董事會，訂定與丙控股公司的股份轉換契約</li>
<li>股份轉換契約應載明承受公司名稱、股份轉換給付方法等事項</li>
<li>甲公司與乙公司分別召開股東會，以特別決議通過股份轉換案</li>
<li>丙控股公司設立並發行股份作為對價，支付給甲公司與乙公司原股東</li>
<li>完成股份轉換後，丙控股公司持有甲公司與乙公司100%股份，形成控股架構</li>
<li>委請會計師查核簽證，並於資本額變動表及股份轉換配股明細表中詳細說明轉換情況</li>
</ul><p>案例二：非公開發行公司發行可轉換公司債</p><p>丁公司為非公開發行公司，擬發行可轉換公司債籌措資金。</p><p>實務處理：</p><ul>
<li>依107年11月1日施行之公司法第248條第2項規定，非公開發行公司可發行可轉換公司債</li>
<li>丁公司應召開董事會以特別決議決定募集可轉換公司債</li>
<li>召開股東會決議通過發行可轉換公司債</li>
<li>確認章程所定股份總數是否足夠涵蓋可能轉換的股份數額，若不足則應先修改章程</li>
<li>發行後15日內檢附相關發行資料，向證券主管機關報備</li>
<li>債權人依轉換辦法申請轉換時，公司應召開董事會決議發行新股</li>
<li>委請會計師查核簽證，並於資本額變動表及可轉換公司債換股明細表中詳細說明轉換情況</li>
</ul><p>案例三：公開發行公司可轉換公司債轉換股份</p><p>戊公司為公開發行公司，已發行可轉換公司債，現部分債權人申請轉換為公司股份。</p><p>實務處理：</p><ul>
<li>債權人依轉換辦法向公司申請轉換</li>
<li>公司召開董事會決議發行新股並訂定基準日</li>
<li>公司至少每季辦理一次可轉換公司債轉換股份的變更登記</li>
<li>會計處理上，公司應將應付公司債及其折價沖銷，同時認列股本及資本公積-轉換公司債轉換溢價</li>
<li>委請會計師查核簽證，查核報告書中應詳細載明轉換面額、轉換價格、轉換股數等資訊</li>
</ul><h2>會計師查核重點</h2><p>股份轉換的會計師查核重點</p><ol>
<li>查核報告書內容要求：詳細說明股份轉換涉及的公司名稱、股數、轉換比例說明轉換股份的評價依據及計算方法說明轉換後的持股關係(如母子公司關係)</li>
<li>股份評價的合理性：確認股份評價有合理依據，如第三方評估報告確認轉換比例的計算方式明確且合理</li>
<li>法定程序的遵循：確認股東會特別決議程序符合法定要求確認股份轉換契約內容完整、明確確認基準日設定合理且符合法規要求</li>
</ol><h2>可轉換公司債的會計師查核重點</h2><ol>
<li>查核報告書內容要求：詳細說明公司債發行情況，包括發行日期、面額、轉換條件等說明本次轉換的公司債面額、轉換價格及轉換股數說明轉換後的累積已轉換情況</li>
<li>會計處理的正確性：確認應付公司債及其折價沖銷的會計處理正確確認股本及資本公積-轉換公司債轉換溢價的認列正確確認相關分錄已確實轉列</li>
<li>法定程序的遵循：確認可轉換公司債發行程序符合法定要求確認公司債轉換程序符合發行及轉換辦法確認發行新股的董事會決議程序正確</li>
</ol><h2>注意事項</h2><p>股份轉換注意事項</p><ol>
<li>契約主體認定：依企業併購法規定，股份轉換契約之主體為讓與「全部」已發行股份之公司及受讓公司如僅向標的公司個別股東取得股份，不適用企業併購法的股份轉換</li>
<li>租稅優惠考量：依企業併購法進行的股份轉換可享有一定的租稅優惠在選擇交易結構時，應一併考量租稅效果</li>
<li>少數股東保護：股份轉換需經股東會特別決議，反對股東可行使股份收買請求權在規劃股份轉換時，應考量少數股東權益保護問題</li>
</ol><h2>可轉換公司債注意事項</h2><ol>
<li>章程資本額限制：公司應確保可轉換公司債轉換後不會超過章程所定股份總數若可能超過，應先完成變更章程增加資本額</li>
<li>發行資格限制：公司發行公司債有資格限制，如不得有違約情事，平均淨利須達一定標準等發行前應確認公司是否符合資格要求</li>
<li>私募人數限制：非公開發行公司私募可轉換公司債的應募人不得超過35人(公司法第248條第3項)發行過程中應確實掌握應募人數</li>
<li>會計處理複雜性：可轉換公司債涉及的會計處理較為複雜，包括初始認列及後續轉換建議諮詢專業會計師協助處理相關會計問題</li>
</ol><h2>結語</h2><p>股份轉換與可轉換公司債是企業資本運作的重要工具，適用於不同的策略需求。股份轉換主要用於企業併購與組織重組，通過一次性取得他公司100%股份，形成控股架構；可轉換公司債則兼具債務融資與權益連結的特性，為企業提供了靈活的籌資選擇。在運用這兩種工具進行增資時，企業應充分了解相關法律規定與程序要求，特別是決議機關、程序步驟、資格限制等關鍵事項，並妥善處理會計、稅務等相關問題，以確保增資過程合法有效，達成預期的策略目標。</p><p>下一篇文章將探討資本變更實務常見疑義解析，包括特別股轉換為普通股、無票面金額股、盈餘分派變更等特殊議題的處理方式，敬請期待。</p>
      </div>
      
      <!-- 文章標籤 -->
      <div class="article-footer">
        <div class="article-tags">
          <a href="/blog.html?tag=company" class="article-tag">公司</a>
          <a href="/blog.html?tag=shares" class="article-tag">股份</a>
          <a href="/blog.html?tag=article" class="article-tag">轉換</a>
          <a href="/blog.html?tag=article" class="article-tag">發行</a>
          <a href="/blog.html?tag=article" class="article-tag">企業</a>
        </div>
      </div>
    </article>
    
    <!-- 簡化後的文章導航 - 只保留返回部落格按鈕 -->
    <div class="article-navigation">
      <a href="/blog.html" class="back-to-blog">
        <span class="material-symbols-rounded">view_list</span>
        返回文章列表
      </a>
    </div>
  </div>
</section>

<!-- 頁尾區域 -->
<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-content">
      <!-- Logo與簡介 -->
      <div class="footer-logo">
        <img src="/assets/images/logo-white.png" alt="霍爾果斯會計師事務所" class="footer-logo-img">
        <div class="logo-sub" style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-bottom: 15px;">HorgosCPA</div>
        <p>專業、誠信、創新的財稅顧問夥伴，致力於提供企業與個人最優質的財務與稅務解決方案。</p>
        <!-- 新增LINE按鈕 -->
        <a href="https://line.me/R/ti/p/@208ihted" target="_blank" class="footer-line-btn">
          <span class="line-icon"></span>
          <span>加入LINE好友</span>
        </a>
      </div>
      
      <!-- 聯絡資訊 -->
      <div class="footer-contact">
        <h3>聯絡我們</h3>
        <ul class="contact-info">
          <li>
            <i class="icon-contact"><span class="material-symbols-rounded">location_on</span></i>
            <span>台中市西區建國路21號3樓之1</span>
          </li>
          <li>
            <i class="icon-contact"><span class="material-symbols-rounded">call</span></i>
            <a href="tel:+886422205606">04-2220-5606</a>
          </li>
          <li>
            <i class="icon-contact"><span class="material-symbols-rounded">schedule</span></i>
            <span>週一至週五 8:30-17:30</span>
          </li>
          <li>
            <i class="icon-contact"><span class="material-symbols-rounded">mail</span></i>
            <a href="mailto:contact@horgoscpa.com">contact@horgoscpa.com</a>
          </li>
        </ul>
      </div>
      
      <!-- 快速連結 -->
      <div class="footer-links">
        <h3>快速連結</h3>
        <ul class="quick-links">
          <li><a href="/index.html"><span class="material-symbols-rounded icon-link">home</span> 首頁</a></li>
          <li><a href="/team.html"><span class="material-symbols-rounded icon-link">groups</span> 專業團隊</a></li>
          <li><a href="/blog.html"><span class="material-symbols-rounded icon-link">article</span> 專欄文章</a></li>
          <li><a href="/faq.html"><span class="material-symbols-rounded icon-link">help</span> 常見問題</a></li>
          <li><a href="/video.html"><span class="material-symbols-rounded icon-link">play_circle</span> 影音專區</a></li>
          <li><a href="/contact.html"><span class="material-symbols-rounded icon-link">contact_mail</span> 聯絡資訊</a></li>
        </ul>
      </div>
      
      <!-- 服務項目 - 更新為與首頁一致 -->
      <div class="footer-services">
        <h3>服務項目</h3>
        <ul class="services-list">
          <li><a href="/services/consulting.html"><span class="material-symbols-rounded icon-link">store</span> 工商登記</a></li>
          <li><a href="/services/accounting.html"><span class="material-symbols-rounded icon-link">account_balance_wallet</span> 帳務處理</a></li>
          <li><a href="/services/tax.html"><span class="material-symbols-rounded icon-link">payments</span> 稅務申報</a></li>
          <li><a href="/services/audit.html"><span class="material-symbols-rounded icon-link">verified</span> 財稅簽證</a></li>
          <li><a href="/booking.html"><span class="material-symbols-rounded icon-link">event_available</span> 預約諮詢</a></li>
        </ul>
      </div>
    </div>
    
    <!-- 版權資訊 -->
    <div class="footer-bottom">
      <div class="footer-text">
        <p>&copy; 2025 霍爾果斯會計師事務所</p>
      </div>
    </div>
  </div>
  
  <!-- 返回頂部按鈕 -->
  <div class="back-to-top">
    <span class="material-symbols-rounded">arrow_upward</span>
  </div>
</footer>

<!-- 返回頂部按鈕功能 - 腳本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // 返回頂部按鈕功能
    const backToTopButton = document.querySelector('.back-to-top');
    
    // 初始隱藏按鈕
    backToTopButton.classList.remove('visible');
    
    // 監聽滾動事件
    window.addEventListener('scroll', function() {
      if (window.pageYOffset > 300) {
        backToTopButton.classList.add('visible');
      } else {
        backToTopButton.classList.remove('visible');
      }
    });
    
    // 點擊事件
    backToTopButton.addEventListener('click', function() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
    
    // 清理可能的格式問題
    (function cleanupArticleContent() {
      // 移除標題前的 # 符號
      const headers = document.querySelectorAll('.article-body h1, .article-body h2, .article-body h3, .article-body h4, .article-body h5, .article-body h6');
      headers.forEach(header => {
        header.innerHTML = header.innerHTML.replace(/^#+\s*/, '');
      });
      
      // 移除粗體標記符號
      const allElements = document.querySelectorAll('.article-body h1, .article-body h2, .article-body h3, .article-body p, .article-body li');
      allElements.forEach(el => {
        el.innerHTML = el.innerHTML.replace(/\*\*(.*?)\*\*/g, '$1');
      });
      
      // 如果第一個標題與文章標題相同，則隱藏
      const firstHeader = document.querySelector('.article-body h1:first-child, .article-body h2:first-child');
      const articleTitle = document.querySelector('.article-title');
      
      if (firstHeader && articleTitle && 
          firstHeader.textContent.trim().toLowerCase() === articleTitle.textContent.trim().toLowerCase()) {
        firstHeader.style.display = 'none';
      }
    })();
  });
</script>

<!-- 導航欄功能腳本 -->
<script src="/assets/js/navbar.js"></script>

<!-- 移動版導航欄功能腳本 -->
<script src="/assets/js/mobile-navbar.js"></script>

<!-- 文章閱讀進度指示器 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // 創建閱讀進度條
    const progressIndicator = document.createElement('div');
    progressIndicator.className = 'reading-progress';
    progressIndicator.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: var(--secondary-color);
      width: 0%;
      z-index: 1001;
      transition: width 0.2s ease;
    `;
    document.body.appendChild(progressIndicator);
    
    // 計算閱讀進度
    function updateReadingProgress() {
      const articleContent = document.querySelector('.article-card');
      if (!articleContent) return;
      
      const contentHeight = articleContent.offsetHeight;
      const contentTop = articleContent.offsetTop;
      const contentBottom = contentTop + contentHeight;
      const currentPosition = window.scrollY + window.innerHeight;
      const windowHeight = window.innerHeight;
      
      // 考慮視窗大小，確保內容完全可見時進度為100%
      let progress = 0;
      if (currentPosition > contentTop) {
        progress = Math.min(100, ((currentPosition - contentTop) / (contentHeight)) * 100);
      }
      
      progressIndicator.style.width = `${progress}%`;
      
      // 當閱讀完畢時添加動畫效果
      if (progress >= 99) {
        progressIndicator.style.transition = 'width 0.5s ease, opacity 1s ease';
        progressIndicator.style.opacity = '0.5';
      } else {
        progressIndicator.style.transition = 'width 0.2s ease';
        progressIndicator.style.opacity = '1';
      }
    }
    
    // 滾動時更新進度
    window.addEventListener('scroll', updateReadingProgress);
    window.addEventListener('resize', updateReadingProgress);
    
    // 初始化進度
    updateReadingProgress();
  });
</script>

</body>
</html>