<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow"> <!-- 防止搜索引擎索引管理頁面 -->
  <title>內容管理 | 霍爾果斯會計師事務所</title>
  
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <!-- 引用樣式表 -->
  <link rel="stylesheet" href="/assets/css/style.css" />
  
  <style>
    /* 管理頁面特定樣式 */
    .admin-container {
      padding: 30px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-width: 1000px;
      margin: 30px auto;
    }
    
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .admin-title {
      margin: 0;
      color: #002147;
    }
    
    .admin-actions {
      display: flex;
      gap: 15px;
    }
    
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }
    
    .admin-table th,
    .admin-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    .admin-table th {
      background-color: #f5f7fa;
      font-weight: 600;
    }
    
    .admin-table tr:hover {
      background-color: #f9f9f9;
    }
    
    .admin-table .actions {
      display: flex;
      gap: 10px;
    }
    
    .admin-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .delete-btn {
      background-color: #ff4d4f;
      color: white;
    }
    
    .delete-btn:hover {
      background-color: #ff2e30;
    }
    
    .view-btn {
      background-color: #0066cc;
      color: white;
    }
    
    .view-btn:hover {
      background-color: #0055aa;
    }
    
    .refresh-btn {
      background-color: #52c41a;
      color: white;
    }
    
    .refresh-btn:hover {
      background-color: #47a919;
    }
    
    /* 分頁樣式 */
    .admin-pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    
    .page-btn {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background-color: #fff;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s;
    }
    
    .page-btn.active {
      background-color: #0066cc;
      color: white;
      border-color: #0066cc;
    }
    
    .page-btn:hover:not(.active) {
      background-color: #f0f0f0;
    }
    
    /* 確認彈窗樣式 */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background-color: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      max-width: 450px;
      width: 80%;
      text-align: center;
    }
    
    .modal-title {
      margin-top: 0;
      color: #333;
    }
    
    .modal-message {
      margin-bottom: 25px;
      line-height: 1.6;
    }
    
    .modal-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .cancel-btn {
      background-color: #f0f0f0;
      color: #333;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .cancel-btn:hover {
      background-color: #e0e0e0;
    }
    
    .confirm-btn {
      background-color: #ff4d4f;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .confirm-btn:hover {
      background-color: #ff2e30;
    }
    
    /* 加載動畫 */
    .loading {
      text-align: center;
      padding: 50px;
    }
    
    .loading-spinner {
      display: inline-block;
      width: 50px;
      height: 50px;
      border: 3px solid rgba(0, 102, 204, 0.2);
      border-radius: 50%;
      border-top-color: #0066cc;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* 訊息提示 */
    .message {
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
      text-align: center;
      font-weight: 500;
    }
    
    .success {
      background-color: #f6ffed;
      border: 1px solid #b7eb8f;
      color: #52c41a;
    }
    
    .error {
      background-color: #fff2f0;
      border: 1px solid #ffccc7;
      color: #ff4d4f;
    }
    
    .info {
      background-color: #e6f7ff;
      border: 1px solid #91d5ff;
      color: #1890ff;
    }
    
    /* 文件上傳區域 */
    .upload-area {
      margin-top: 30px;
      padding: 25px;
      background-color: #f9f9f9;
      border-radius: 8px;
      text-align: center;
    }
    
    .upload-title {
      margin-top: 0;
      color: #333;
    }
    
    .upload-input {
      margin: 15px 0;
    }
    
    .upload-btn {
      background-color: #0066cc;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .upload-btn:hover {
      background-color: #0055aa;
    }
    
    /* 管理員密碼輸入框 */
    .password-input {
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      width: 100%;
      margin-bottom: 20px;
    }
    
    .password-input:focus {
      border-color: #0066cc;
      box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.2);
      outline: none;
    }

    /* 表單區塊樣式 */
    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-group select {
      height: 38px;
    }

    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    /* 頁籤樣式 */
    .admin-tabs {
      display: flex;
      border-bottom: 1px solid #eee;
      margin-bottom: 20px;
    }
    
    .tab-item {
      padding: 12px 20px;
      cursor: pointer;
      font-weight: 500;
      color: #666;
      border-bottom: 2px solid transparent;
      transition: all 0.3s;
    }
    
    .tab-item:hover {
      color: #0066cc;
    }
    
    .tab-item.active {
      color: #0066cc;
      border-bottom-color: #0066cc;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* 圖片管理樣式 */
    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .image-item {
      border: 1px solid #eee;
      border-radius: 5px;
      overflow: hidden;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .image-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    }
    
    .image-preview {
      height: 150px;
      overflow: hidden;
      background-color: #f5f5f5;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .image-info {
      padding: 10px;
      background-color: #fff;
    }
    
    .image-name {
      font-size: 0.85rem;
      margin: 0 0 5px 0;
      word-break: break-word;
      font-weight: 500;
    }
    
    .image-path {
      font-size: 0.75rem;
      color: #666;
      margin: 0 0 10px 0;
      word-break: break-word;
    }
    
    .image-actions {
      display: flex;
      gap: 5px;
    }
    
    /* 圖片上傳區域 */
    .image-upload-area {
      margin-top: 20px;
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 8px;
      border: 2px dashed #ddd;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .image-upload-area:hover {
      border-color: #0066cc;
      background-color: #f0f7ff;
    }
    
    .image-upload-input {
      display: none;
    }
    
    /* 圖片預覽模態框 */
    .image-preview-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
    }
    
    .image-preview-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      max-width: 800px;
      width: 90%;
      max-height: 90vh;
      overflow: auto;
    }
    
    .image-preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .image-preview-title {
      margin: 0;
      font-size: 1.5rem;
    }
    
    .image-preview-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
    }
    
    .image-preview-body {
      text-align: center;
    }
    
    .image-preview-body img {
      max-width: 100%;
      max-height: 60vh;
      margin-bottom: 20px;
    }
    
    .image-preview-info {
      text-align: left;
      margin-bottom: 20px;
    }
    
    .image-preview-info p {
      margin: 5px 0;
    }
    
    .image-preview-path {
      padding: 10px;
      background-color: #f5f5f5;
      border-radius: 5px;
      font-family: monospace;
      overflow-x: auto;
      margin-bottom: 20px;
    }
    
    /* 登入模態框 */
    .login-modal {
      display: flex;
      position: fixed;
      z-index: 1010;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
    }
    
    .login-content {
      background-color: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      max-width: 400px;
      width: 90%;
      text-align: center;
    }
    
    .login-title {
      margin-top: 0;
      color: #333;
      margin-bottom: 20px;
    }
    
    .login-form {
      text-align: left;
    }
    
    .login-button {
      background-color: #0066cc;
      color: white;
      padding: 12px 20px;
      border: none;
      width: 100%;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      font-size: 16px;
      margin-top: 20px;
    }
    
    .login-button:hover {
      background-color: #0055aa;
    }
  </style>
</head>
<body>

<!-- 登入模態框 -->
<div id="login-modal" class="login-modal">
  <div class="login-content">
    <h2 class="login-title">管理員登入</h2>
    <form id="login-form" class="login-form">
      <div class="form-group">
        <label for="admin-login-password">請輸入管理員密碼</label>
        <input type="password" id="admin-login-password" class="password-input" placeholder="管理員密碼" required>
      </div>
      <button type="submit" class="login-button">登入</button>
    </form>
  </div>
</div>

<!-- 導航欄 -->
<nav class="site-nav">
  <div class="nav-container">
    <div class="logo">
      <a href="/index.html">
        <div class="logo-main">霍爾果斯會計師事務所</div>
        <div class="logo-sub">HorgosCPA</div>
      </a>
    </div>
    <input type="checkbox" id="nav-toggle" class="nav-toggle">
    <label for="nav-toggle" class="nav-toggle-label">
      <span></span>
    </label>
    <ul class="nav-menu">
      <li class="nav-cta-item"><a href="/booking.html" class="nav-consult-btn">免費諮詢</a></li>
      <li class="nav-cta-item"><a href="https://line.me/R/ti/p/@208ihted" target="_blank" class="nav-line-btn">LINE</a></li>
      <li class="nav-divider"></li>
      <li><a href="/services.html">服務項目</a></li>
      <li><a href="/team.html">服務團隊</a></li>
      <li><a href="/blog.html">部落格</a></li>
      <li><a href="/faq.html">常見問題</a></li>
      <li><a href="/video.html">影片</a></li>
      <li><a href="/contact.html">聯絡資訊</a></li>
    </ul>
  </div>
</nav>

<!-- 管理頁面內容 -->
<main class="admin-page">
  <div class="container">
    <div class="admin-container">
      <div class="admin-header">
        <h1 class="admin-title">內容管理平台</h1>
        <div class="admin-actions">
          <button id="refresh-btn" class="admin-btn refresh-btn">刷新列表</button>
          <button id="scan-btn" class="admin-btn refresh-btn" style="background-color: #ff9800; margin-left: 10px;">掃描HTML文章</button>
          <a href="/blog.html" class="admin-btn view-btn">查看博客</a>
          <a href="/video.html" class="admin-btn view-btn">查看影片</a>
        </div>
      </div>
      
      <!-- 頁籤導航 -->
      <div class="admin-tabs">
        <div class="tab-item active" data-tab="blog-tab">部落格文章</div>
        <div class="tab-item" data-tab="video-tab">影片管理</div>
        <div class="tab-item" data-tab="image-tab">圖片管理</div>
      </div>
      
      <!-- 訊息容器 -->
      <div id="message-container"></div>
      
      <!-- 文章管理頁籤內容 -->
      <div id="blog-tab" class="tab-content active">
        <!-- 文章列表表格 -->
        <div id="articles-container">
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載文章中...</p>
          </div>
        </div>
        
        <!-- 分頁控制 -->
        <div class="admin-pagination" id="pagination-container"></div>
        
        <!-- 上傳新 Word 文章區域 -->
        <div class="upload-area">
          <h2 class="upload-title">上傳新文章</h2>
          <p>請選擇 Word 文檔以創建新文章。文檔名稱應使用日期前綴格式（例如：2025-05-01-文章標題.docx）</p>
          <form id="upload-form">
            <div class="upload-input">
              <input type="file" id="word-file" accept=".docx" required>
            </div>
            <div class="form-group">
              <label for="article-thumbnail">選擇文章縮圖（可選）</label>
              <input type="file" id="article-thumbnail" accept=".jpg,.jpeg,.png,.gif">
              <p style="margin-top: 5px; font-size: 0.8rem; color: #666;">
                建議尺寸: 800x450 像素，圖片將自動上傳到 /assets/images/blog/ 目錄
              </p>
            </div>
            <button type="submit" class="upload-btn">上傳文章</button>
          </form>
        </div>
      </div>
      
      <!-- 影片管理頁籤內容 -->
      <div id="video-tab" class="tab-content">
        <!-- 影片列表表格 -->
        <div id="videos-container">
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載影片中...</p>
          </div>
        </div>
        
        <!-- 影片分頁控制 -->
        <div class="admin-pagination" id="video-pagination-container"></div>
        
        <!-- 新增影片表單 -->
        <div class="upload-area">
          <h2 class="upload-title">新增影片</h2>
          <p>填寫下方表單，將新影片加入到影片列表中</p>
          <form id="video-form">
            <div class="form-group">
              <label for="video-title">影片標題</label>
              <input type="text" id="video-title" required>
            </div>
            <div class="form-group">
              <label for="video-date">發布日期</label>
              <input type="date" id="video-date" required>
            </div>
            <div class="form-group">
              <label for="video-description">影片描述</label>
              <textarea id="video-description" required></textarea>
            </div>
            <div class="form-group">
              <label for="video-embed">YouTube 嵌入網址</label>
              <input type="text" id="video-embed" placeholder="例如：https://www.youtube.com/embed/xxxxxxxxxx" required>
            </div>
            <div class="form-group">
              <label for="video-category">影片分類</label>
              <select id="video-category" required>
                <option value="tax">稅務相關</option>
                <option value="accounting">會計記帳</option>
                <option value="business">企業經營</option>
                <option value="tutorial">操作教學</option>
              </select>
            </div>
            <div class="form-group">
              <label for="video-tags">標籤（以逗號分隔）</label>
              <input type="text" id="video-tags" placeholder="例如：報稅,所得稅,企業稅務">
            </div>
            <button type="submit" class="upload-btn">新增影片</button>
          </form>
        </div>
      </div>
      
      <!-- 圖片管理頁籤內容 -->
      <div id="image-tab" class="tab-content">
        <!-- 圖片列表 -->
        <div id="images-container">
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載圖片中...</p>
          </div>
        </div>
        
        <!-- 圖片分頁控制 -->
        <div class="admin-pagination" id="image-pagination-container"></div>
        
        <!-- 上傳圖片區域 -->
        <div class="upload-area">
          <h2 class="upload-title">上傳新圖片</h2>
          <p>選擇要上傳的圖片檔案，圖片將會上傳到適當的目錄結構中</p>
          <form id="image-upload-form">
            <div class="form-group">
              <label for="image-file">選擇圖片檔案</label>
              <input type="file" id="image-file" accept=".jpg,.jpeg,.png,.gif,.svg" required>
            </div>
            <div class="form-group">
              <label for="image-category">選擇圖片分類</label>
              <select id="image-category" required>
                <option value="blog">部落格文章圖片</option>
                <option value="team">團隊成員圖片</option>
                <option value="service">服務相關圖片</option>
                <option value="common">通用圖片</option>
              </select>
            </div>
            <div class="form-group">
              <label for="image-name">圖片檔名（不含副檔名）</label>
              <input type="text" id="image-name" placeholder="例如: tax-planning-guide" required>
              <p style="margin-top: 5px; font-size: 0.8rem; color: #666;">
                請使用英文字母、數字與連字符，避免使用空格和特殊字元
              </p>
            </div>
            <button type="submit" class="upload-btn">上傳圖片</button>
          </form>
        </div>
        
        <!-- 圖片使用指南 -->
        <div style="margin-top: 30px; padding: 20px; background-color: #f0f7ff; border-radius: 8px; border-left: 5px solid #0066cc;">
          <h3 style="margin-top: 0; color: #0066cc;">圖片命名與引用指南</h3>
          <p><strong>文章縮圖命名規則：</strong> 使用有意義的英文名稱，例如：blog-thumbnail-tax-guide.jpg</p>
          
          <h4>常用圖片路徑：</h4>
          <ul>
            <li><code>/assets/images/blog/</code> - 文章相關圖片</li>
            <li><code>/assets/images/team/</code> - 團隊成員照片</li>
            <li><code>/assets/images/services/</code> - 服務相關圖片</li>
            <li><code>/assets/images/</code> - 網站通用圖片</li>
          </ul>
          
          <h4>引用方式：</h4>
          <pre style="background-color: #f5f5f5; padding: 10px; border-radius: 5px;"><code>&lt;img src="/assets/images/blog/blog-thumbnail-tax-guide.jpg" alt="稅務規劃指南"&gt;</code></pre>
          
          <h4>常用尺寸：</h4>
          <ul>
            <li>部落格文章縮圖：800x450 像素</li>
            <li>團隊成員照片：300x300 像素（正方形）</li>
            <li>服務圖示：128x128 像素或 SVG 格式</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- 確認刪除文章彈窗 -->
<div id="delete-modal" class="modal">
  <div class="modal-content">
    <h2 class="modal-title">確認刪除</h2>
    <p class="modal-message">您確定要刪除這篇文章嗎？此操作不可恢復。</p>
    <div class="modal-buttons">
      <button id="cancel-delete" class="cancel-btn">取消</button>
      <button id="confirm-delete" class="confirm-btn">確認刪除</button>
    </div>
  </div>
</div>

<!-- 確認刪除影片彈窗 -->
<div id="delete-video-modal" class="modal">
  <div class="modal-content">
    <h2 class="modal-title">確認刪除影片</h2>
    <p class="modal-message">您確定要刪除這個影片嗎？此操作不可恢復。</p>
    <div class="modal-buttons">
      <button id="cancel-video-delete" class="cancel-btn">取消</button>
      <button id="confirm-video-delete" class="confirm-btn">確認刪除</button>
    </div>
  </div>
</div>

<!-- 確認刪除圖片彈窗 -->
<div id="delete-image-modal" class="modal">
  <div class="modal-content">
    <h2 class="modal-title">確認刪除圖片</h2>
    <p class="modal-message">您確定要刪除這張圖片嗎？此操作不可恢復。</p>
    <p class="image-warning" style="color: #ff4d4f;">注意：如果此圖片正在被使用，刪除可能會導致網站顯示錯誤！</p>
    <div class="modal-buttons">
      <button id="cancel-image-delete" class="cancel-btn">取消</button>
      <button id="confirm-image-delete" class="confirm-btn">確認刪除</button>
    </div>
  </div>
</div>

<!-- 圖片預覽模態框 -->
<div id="image-preview-modal" class="image-preview-modal">
  <div class="image-preview-content">
    <div class="image-preview-header">
      <h2 class="image-preview-title">圖片預覽</h2>
      <button class="image-preview-close">&times;</button>
    </div>
    <div class="image-preview-body">
      <img id="preview-image" src="" alt="預覽圖片">
      <div class="image-preview-info">
        <p><strong>檔名：</strong> <span id="preview-filename"></span></p>
        <p><strong>尺寸：</strong> <span id="preview-dimensions"></span></p>
        <p><strong>檔案大小：</strong> <span id="preview-filesize"></span></p>
      </div>
      <div class="image-preview-path">
        <p><strong>HTML 引用代碼：</strong></p>
        <code id="preview-html-code"></code>
      </div>
      <div class="modal-buttons">
        <button id="replace-image" class="admin-btn view-btn">替換圖片</button>
        <button id="delete-preview-image" class="admin-btn delete-btn">刪除圖片</button>
      </div>
    </div>
  </div>
</div>

<!-- 頁尾區域 -->
<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-text">
      <p>&copy; 2025 霍爾果斯會計師事務所 | 台中市西區建國路21號3樓之1 | 電話：<a href="tel:+886422205606">04-2220-5606</a></p>
    </div>
  </div>
</footer>

<!-- GitHub API操作腳本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // GitHub 設置
    const GITHUB_OWNER = 'waynegg8'; // 更改為您的GitHub用戶名
    const GITHUB_REPO = 'horgoscpa'; // 更改為您的儲存庫名稱
    const GITHUB_BRANCH = 'main';    // 更改為您的主分支名稱
    const ADMIN_PASSWORD = 'wayne4591'; // 管理員密碼
    
    // 權限管理
    let isAuthenticated = false;
    let authExpireTime = null;
    const AUTH_DURATION = 2 * 60 * 60 * 1000; // 2小時，單位毫秒
    
    // 元素
    const articlesContainer = document.getElementById('articles-container');
    const videosContainer = document.getElementById('videos-container');
    const imagesContainer = document.getElementById('images-container');
    const paginationContainer = document.getElementById('pagination-container');
    const videoPaginationContainer = document.getElementById('video-pagination-container');
    const imagePaginationContainer = document.getElementById('image-pagination-container');
    const messageContainer = document.getElementById('message-container');
    const refreshBtn = document.getElementById('refresh-btn');
    const deleteModal = document.getElementById('delete-modal');
    const deleteVideoModal = document.getElementById('delete-video-modal');
    const deleteImageModal = document.getElementById('delete-image-modal');
    const uploadForm = document.getElementById('upload-form');
    const videoForm = document.getElementById('video-form');
    const imageUploadForm = document.getElementById('image-upload-form');
    const tabItems = document.querySelectorAll('.tab-item');
    const tabContents = document.querySelectorAll('.tab-content');
    const loginModal = document.getElementById('login-modal');
    const loginForm = document.getElementById('login-form');
    const adminLoginPasswordInput = document.getElementById('admin-login-password');
    const imagePreviewModal = document.getElementById('image-preview-modal');
    
    // 狀態
    let articleData = null;
    let videoData = null;
    let imageData = null; // 儲存圖片列表數據
    let currentPage = 1;
    let videoCurrentPage = 1;
    let imageCurrentPage = 1;
    let itemsPerPage = 10;
    let articleToDelete = null;
    let videoToDelete = null;
    let imageToDelete = null;
    let fileToUpload = null;
    let thumbnailToUpload = null;
    let videoToAdd = null;
    let imageToUpload = null;
    let selectedImage = null;
    
    // 檢查權限狀態並顯示登入窗口
    checkAuthStatus();
    
    // 登入表單提交 - 修正登入表單事件處理
    if (loginForm) {
        // 確保表單存在
        console.log("找到登入表單，添加提交事件監聽器");
        
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log("登入表單提交");
            
            const password = adminLoginPasswordInput.value.trim();
            console.log("輸入的密碼：", password, "預期密碼：", ADMIN_PASSWORD);
            
            if (password === ADMIN_PASSWORD) {
                console.log("密碼正確，設置認證狀態");
                // 設置認證狀態
                setAuthenticated(true);
                
                // 關閉登入彈窗
                loginModal.style.display = 'none';
                
                // 初始加載數據
                loadArticles();
                loadVideos();
                loadImages();
                
                // 顯示成功訊息
                showMessage('登入成功，歡迎使用內容管理平台', 'success');
            } else {
                console.log("密碼不正確");
                alert('密碼不正確，請重試');
            }
        });
    } else {
        console.error("找不到登入表單元素");
    }
    
// 添加直接登入按鈕方便調試
    const debugLoginBtn = document.createElement('button');
    debugLoginBtn.style.position = 'fixed';
    debugLoginBtn.style.bottom = '10px';
    debugLoginBtn.style.right = '10px';
    debugLoginBtn.style.zIndex = '9999';
    debugLoginBtn.style.padding = '5px 10px';
    debugLoginBtn.style.background = '#ff9800';
    debugLoginBtn.style.color = 'white';
    debugLoginBtn.style.border = 'none';
    debugLoginBtn.style.borderRadius = '4px';
    debugLoginBtn.style.cursor = 'pointer';
    debugLoginBtn.textContent = '測試登入';
    debugLoginBtn.addEventListener('click', function() {
        setAuthenticated(true);
        loginModal.style.display = 'none';
        loadArticles();
        loadVideos();
        loadImages();
        showMessage('測試登入成功', 'success');
    });
    document.body.appendChild(debugLoginBtn);

    // 初始加載數據 (在登入後才執行)
    function loadInitialData() {
      loadArticles();
      loadVideos();
      loadImages();
    }
    
    // 刷新按鈕事件
    refreshBtn.addEventListener('click', function() {
      const activeTab = document.querySelector('.tab-item.active').getAttribute('data-tab');
      if (activeTab === 'blog-tab') {
        loadArticles();
      } else if (activeTab === 'video-tab') {
        loadVideos();
      } else if (activeTab === 'image-tab') {
        loadImages();
      }
    });
    
    // 掃描HTML文章按鈕事件
    const scanBtn = document.getElementById('scan-btn');
    if (scanBtn) {
      scanBtn.addEventListener('click', function() {
        // 確認是否要執行掃描
        if (confirm('確定要掃描所有HTML文章並更新JSON文件嗎？這將覆蓋現有的文章數據。')) {
          scanHtmlFiles();
        }
      });
    }
    
    // 標籤切換事件
    tabItems.forEach(tab => {
      tab.addEventListener('click', function() {
        // 移除所有標籤的活動狀態
        tabItems.forEach(item => item.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        
        // 設置當前標籤為活動狀態
        this.classList.add('active');
        const tabId = this.getAttribute('data-tab');
        document.getElementById(tabId).classList.add('active');
      });
    });
    
    // 上傳文章表單提交
    uploadForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      // 獲取選擇的文件
      const fileInput = document.getElementById('word-file');
      const thumbnailInput = document.getElementById('article-thumbnail');
      
      if (fileInput.files.length > 0) {
        fileToUpload = fileInput.files[0];
        
        // 檢查是否選擇了縮圖
        if (thumbnailInput.files.length > 0) {
          thumbnailToUpload = thumbnailInput.files[0];
        } else {
          thumbnailToUpload = null;
        }
        
        // 開始上傳流程
        uploadWordDocument();
      } else {
        showMessage('請選擇要上傳的文件', 'error');
      }
    });
    
    // 新增影片表單提交
    videoForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      // 獲取表單數據
      const title = document.getElementById('video-title').value.trim();
      const date = document.getElementById('video-date').value;
      const description = document.getElementById('video-description').value.trim();
      const embedUrl = document.getElementById('video-embed').value.trim();
      const category = document.getElementById('video-category').value;
      const tagsInput = document.getElementById('video-tags').value.trim();
      
      // 處理標籤
      const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
      
      // 創建影片對象
      videoToAdd = {
        title,
        date,
        description,
        embedUrl,
        category,
        tags
      };
      
      // 驗證URL
      if (!embedUrl.startsWith('https://www.youtube.com/embed/')) {
        showMessage('請輸入有效的YouTube嵌入網址，以"https://www.youtube.com/embed/"開頭', 'error');
        return;
      }
      
      // 開始新增影片
      addNewVideo();
    });
    
    // 上傳圖片表單提交
    imageUploadForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      // 獲取表單數據
      const fileInput = document.getElementById('image-file');
      const category = document.getElementById('image-category').value;
      const imageName = document.getElementById('image-name').value.trim();
      
      // 驗證檔名格式
      if (!imageName.match(/^[a-zA-Z0-9-_]+$/)) {
        showMessage('圖片檔名只能包含英文、數字、連字符(-)和底線(_)', 'error');
        return;
      }
      
      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const fileExt = file.name.split('.').pop().toLowerCase();
        
        // 確保是有效的圖片格式
        const validImageTypes = ['jpg', 'jpeg', 'png', 'gif', 'svg'];
        if (!validImageTypes.includes(fileExt)) {
          showMessage('請選擇有效的圖片格式 (JPG, PNG, GIF, SVG)', 'error');
          return;
        }
        
        // 創建圖片上傳對象
        imageToUpload = {
          file,
          category,
          name: imageName,
          ext: fileExt
        };
        
        // 開始上傳圖片
        uploadImage();
      } else {
        showMessage('請選擇要上傳的圖片', 'error');
      }
    });
    
    // 圖片預覽模態框關閉按鈕
    document.querySelector('.image-preview-close').addEventListener('click', function() {
      closeImagePreviewModal();
    });
    
    // 圖片預覽模態框替換圖片按鈕
    document.getElementById('replace-image').addEventListener('click', function() {
      // 打開替換圖片的文件選擇器
      if (!selectedImage) return;
      
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = '.jpg,.jpeg,.png,.gif,.svg';
      fileInput.addEventListener('change', function(e) {
        if (this.files.length > 0) {
          // 確認是否替換
          if (confirm(`確定要替換圖片 ${selectedImage.name} 嗎？`)) {
            replaceImage(selectedImage, this.files[0]);
          }
        }
      });
      fileInput.click();
    });
    
    // 圖片預覽模態框刪除圖片按鈕
    document.getElementById('delete-preview-image').addEventListener('click', function() {
      if (!selectedImage) return;
      
      imageToDelete = selectedImage;
      closeImagePreviewModal();
      openDeleteImageModal();
    });
    
    // 確認刪除文章按鈕
    document.getElementById('confirm-delete').addEventListener('click', function() {
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      if (articleToDelete) {
        deleteArticle(articleToDelete);
        closeDeleteModal();
      }
    });
    
    // 取消刪除文章按鈕
    document.getElementById('cancel-delete').addEventListener('click', function() {
      closeDeleteModal();
    });
    
    // 確認刪除影片按鈕
    document.getElementById('confirm-video-delete').addEventListener('click', function() {
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      if (videoToDelete !== null) {
        deleteVideo(videoToDelete);
        closeDeleteVideoModal();
      }
    });
    
    // 取消刪除影片按鈕
    document.getElementById('cancel-video-delete').addEventListener('click', function() {
      closeDeleteVideoModal();
    });
    
    // 確認刪除圖片按鈕
    document.getElementById('confirm-image-delete').addEventListener('click', function() {
      // 檢查權限
      if (!isAuthenticated) {
        showMessage('您需要先登入才能執行此操作', 'error');
        showLoginModal();
        return;
      }
      
      if (imageToDelete) {
        deleteImage(imageToDelete);
        closeDeleteImageModal();
      }
    });
    
    // 取消刪除圖片按鈕
    document.getElementById('cancel-image-delete').addEventListener('click', function() {
      closeDeleteImageModal();
    });
    
    // 點擊模態框背景關閉
    window.addEventListener('click', function(e) {
      if (e.target === deleteModal) {
        closeDeleteModal();
      }
      if (e.target === deleteVideoModal) {
        closeDeleteVideoModal();
      }
      if (e.target === deleteImageModal) {
        closeDeleteImageModal();
      }
      if (e.target === imagePreviewModal) {
        closeImagePreviewModal();
      }
    });
    
    /**
     * 檢查認證狀態
     */
    function checkAuthStatus() {
        console.log("檢查認證狀態");
        // 嘗試從本地存儲獲取認證狀態
        const storedAuth = localStorage.getItem('adminAuth');
        const storedExpireTime = localStorage.getItem('authExpireTime');
        
        if (storedAuth && storedExpireTime) {
            console.log("找到已儲存的認證狀態");
            const now = new Date().getTime();
            const expireTime = parseInt(storedExpireTime);
            
            if (now < expireTime) {
                console.log("認證仍然有效");
                // 認證仍然有效
                isAuthenticated = true;
                authExpireTime = expireTime;
                
                // 隱藏登入窗口
                loginModal.style.display = 'none';
                
                // 初始加載數據
                loadInitialData();
                
                // 顯示剩餘時間
                const remainingMinutes = Math.round((expireTime - now) / 60000);
                showMessage(`已登入，權限有效期還剩約 ${remainingMinutes} 分鐘`, 'info');
                
                // 設置自動登出計時器
                setTimeout(function() {
                    logout();
                    showMessage('登入已過期，請重新登入', 'info');
                    showLoginModal();
                }, expireTime - now);
                
                return;
            } else {
                console.log("認證已過期");
            }
        } else {
            console.log("未找到已儲存的認證狀態");
        }
        
        // 認證無效或已過期，顯示登入窗口
        console.log("顯示登入窗口");
        showLoginModal();
    }
    
    /**
     * 設置認證狀態
     */
    function setAuthenticated(status) {
        console.log("設置認證狀態:", status);
        isAuthenticated = status;
        
        if (status) {
            // 計算過期時間
            const now = new Date().getTime();
            authExpireTime = now + AUTH_DURATION;
            
            // 保存到本地存儲
            localStorage.setItem('adminAuth', 'true');
            localStorage.setItem('authExpireTime', authExpireTime.toString());
            console.log("保存認證狀態到本地存儲，過期時間:", new Date(authExpireTime).toLocaleString());
            
            // 設置自動登出計時器
            setTimeout(function() {
                logout();
                showMessage('登入已過期，請重新登入', 'info');
                showLoginModal();
            }, AUTH_DURATION);
        } else {
            // 清除本地存儲
            localStorage.removeItem('adminAuth');
            localStorage.removeItem('authExpireTime');
            console.log("清除認證狀態");
            
            authExpireTime = null;
        }
    }
    
    /**
     * 登出
     */
    function logout() {
        console.log("執行登出");
        isAuthenticated = false;
        authExpireTime = null;
        
        // 清除本地存儲
        localStorage.removeItem('adminAuth');
        localStorage.removeItem('authExpireTime');
    }
    
    /**
     * 顯示登入模態框
     */
    function showLoginModal() {
        console.log("顯示登入窗口");
        loginModal.style.display = 'flex';
        if (adminLoginPasswordInput) {
            adminLoginPasswordInput.value = '';
            adminLoginPasswordInput.focus();
        } else {
            console.error("找不到密碼輸入框元素");
        }
    }

    /**
     * 加載文章列表
     */
    async function loadArticles() {
      try {
        // 顯示加載中
        articlesContainer.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載文章中...</p>
          </div>
        `;
        
        try {
          // 嘗試從GitHub直接獲取JSON文件
          const response = await fetch(`https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/${GITHUB_BRANCH}/assets/data/blog-posts.json`);
          
          if (!response.ok) {
            throw new Error('無法從GitHub獲取文章數據');
          }
          
          // 嘗試解析JSON
          try {
            const data = await response.json();
            articleData = data;
            
            // 渲染文章列表
            renderArticles();
          } catch (parseError) {
            console.error('解析JSON時出錯:', parseError);
            throw new Error('JSON格式無效，無法解析');
          }
        } catch (error) {
          console.error('加載JSON出錯:', error);
          // 使用備用數據
          useArticleFallbackData();
        }
      } catch (error) {
        console.error('加載文章出錯:', error);
        articlesContainer.innerHTML = `
          <div class="message error">
            加載文章時出現問題：${error.message}
          </div>
        `;
      }
    }
    
    /**
     * 加載影片列表
     */
    async function loadVideos() {
      try {
        // 顯示加載中
        videosContainer.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載影片中...</p>
          </div>
        `;
        
        try {
          // 嘗試從GitHub直接獲取JSON文件
          const response = await fetch(`https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/${GITHUB_BRANCH}/assets/data/videos.json`);
          
          if (!response.ok) {
            throw new Error('無法從GitHub獲取影片數據');
          }
          
          // 嘗試解析JSON
          try {
            const data = await response.json();
            videoData = data;
            
            // 渲染影片列表
            renderVideos();
          } catch (parseError) {
            console.error('解析影片JSON時出錯:', parseError);
            throw new Error('影片JSON格式無效，無法解析');
          }
        } catch (error) {
          console.error('加載影片JSON出錯:', error);
          // 使用備用數據
          useVideoFallbackData();
        }
      } catch (error) {
        console.error('加載影片出錯:', error);
        videosContainer.innerHTML = `
          <div class="message error">
            加載影片時出現問題：${error.message}
          </div>
        `;
      }
    }
    
    /**
     * 加載圖片列表
     */
    async function loadImages() {
      try {
        // 顯示加載中
        imagesContainer.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>掃描網站圖片中...</p>
          </div>
        `;
        
        // 模擬加載圖片列表
        // 在真實環境中，這裡可以使用 GitHub API 獲取圖片目錄下的所有文件
        setTimeout(function() {
          // 創建模擬圖片數據
          const mockImages = [
            {
              name: 'blog-thumbnail-tax-guide.jpg',
              path: '/assets/images/blog/blog-thumbnail-tax-guide.jpg',
              size: '128KB',
              dimensions: '800x450',
              type: 'blog',
              lastModified: '2025-04-10'
            },
            {
              name: 'cross-border-tax.jpg',
              path: '/assets/images/blog/cross-border-tax.jpg',
              size: '156KB',
              dimensions: '800x450',
              type: 'blog',
              lastModified: '2025-04-01'
            },
            {
              name: 'startup-accounting.jpg',
              path: '/assets/images/blog/startup-accounting.jpg',
              size: '142KB',
              dimensions: '800x450',
              type: 'blog',
              lastModified: '2025-03-15'
            },
            {
              name: 'tax-planning.jpg',
              path: '/assets/images/blog/tax-planning.jpg',
              size: '118KB',
              dimensions: '800x450',
              type: 'blog',
              lastModified: '2025-03-05'
            },
            {
              name: 'default.jpg',
              path: '/assets/images/blog/default.jpg',
              size: '98KB',
              dimensions: '800x450',
              type: 'blog',
              lastModified: '2025-01-01'
            },
            {
              name: 'team-accountant.jpg',
              path: '/assets/images/team/team-accountant.jpg',
              size: '86KB',
              dimensions: '300x300',
              type: 'team',
              lastModified: '2025-01-01'
            },
            {
              name: 'team-advisor.jpg',
              path: '/assets/images/team/team-advisor.jpg',
              size: '92KB',
              dimensions: '300x300',
              type: 'team',
              lastModified: '2025-01-01'
            },
            {
              name: 'tax-icon.svg',
              path: '/assets/images/tax-icon.svg',
              size: '5KB',
              dimensions: 'SVG',
              type: 'service',
              lastModified: '2025-01-01'
            },
            {
              name: 'accounting-icon.svg',
              path: '/assets/images/accounting-icon.svg',
              size: '4KB',
              dimensions: 'SVG',
              type: 'service',
              lastModified: '2025-01-01'
            },
            {
              name: 'consulting-icon.svg',
              path: '/assets/images/consulting-icon.svg',
              size: '6KB',
              dimensions: 'SVG',
              type: 'service',
              lastModified: '2025-01-01'
            }
          ];
          
          imageData = mockImages;
          
          // 渲染圖片列表
          renderImages();
        }, 1000);
      } catch (error) {
        console.error('加載圖片出錯:', error);
        imagesContainer.innerHTML = `
          <div class="message error">
            加載圖片時出現問題：${error.message}
          </div>
        `;
      }
    }
    
    /**
     * 使用文章備用數據
     */
    function useArticleFallbackData() {
      // 創建空的文章數據
      articleData = {
        posts: [],
        pagination: {
          total_posts: 0,
          total_pages: 1,
          items_per_page: 6
        },
        categories: ["tax", "accounting", "business"],
        tags: []
      };
      
      // 渲染空文章列表
      renderArticles();
      
      // 顯示說明信息
      articlesContainer.innerHTML = `
        <div class="message info">
          <p>目前尚未有任何文章，或無法連接到文章資料。您可以點擊下方「上傳文章」新增第一篇文章。</p>
        </div>
      `;
    }
    
    /**
     * 使用影片備用數據
     */
    function useVideoFallbackData() {
      // 創建空的影片數據
      videoData = {
        videos: [],
        pagination: {
          total: 0,
          totalPages: 1,
          itemsPerPage: 6
        }
      };
      
      // 渲染空影片列表
      renderVideos();
      
      // 顯示說明信息
      videosContainer.innerHTML = `
        <div class="message info">
          <p>目前尚未有任何影片，或無法連接到影片資料。您可以在下方「新增影片」表單新增第一部影片。</p>
        </div>
      `;
    }
    
    /**
     * 渲染文章列表
     */
    function renderArticles() {
      if (!articleData || !articleData.posts || articleData.posts.length === 0) {
        articlesContainer.innerHTML = `
          <div class="message info">尚無文章</div>
        `;
        paginationContainer.innerHTML = '';
        return;
      }
      
      const posts = articleData.posts;
      
      // 計算分頁
      const totalPages = Math.ceil(posts.length / itemsPerPage);
      currentPage = Math.min(currentPage, totalPages);
      
      // 獲取當前頁的文章
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = Math.min(startIndex + itemsPerPage, posts.length);
      const currentPosts = posts.slice(startIndex, endIndex);
      
      // 創建表格
      let tableHTML = `
        <table class="admin-table">
          <thead>
            <tr>
              <th>標題</th>
              <th>日期</th>
              <th>分類</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
      `;
      
      // 添加行
      currentPosts.forEach(post => {
        tableHTML += `
          <tr>
            <td>${post.title}</td>
            <td>${post.date}</td>
            <td>${post.category}</td>
            <td class="actions">
              <a href="${post.url}" target="_blank" class="admin-btn view-btn">查看</a>
              <button class="admin-btn delete-btn" data-url="${post.url}">刪除</button>
            </td>
          </tr>
        `;
      });
      
      tableHTML += `
          </tbody>
        </table>
      `;
      
      articlesContainer.innerHTML = tableHTML;
      
      // 綁定刪除按鈕事件
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          articleToDelete = this.getAttribute('data-url');
          openDeleteModal();
        });
      });
      
      // 渲染分頁
      renderArticlePagination(totalPages);
    }
    
    /**
     * 渲染影片列表
     */
    function renderVideos() {
      if (!videoData || !videoData.videos || videoData.videos.length === 0) {
        videosContainer.innerHTML = `
          <div class="message info">尚無影片</div>
        `;
        videoPaginationContainer.innerHTML = '';
        return;
      }
      
      const videos = videoData.videos;
      
      // 計算分頁
      const totalPages = Math.ceil(videos.length / itemsPerPage);
      videoCurrentPage = Math.min(videoCurrentPage, totalPages);
      
      // 獲取當前頁的影片
      const startIndex = (videoCurrentPage - 1) * itemsPerPage;
      const endIndex = Math.min(startIndex + itemsPerPage, videos.length);
      const currentVideos = videos.slice(startIndex, endIndex);
      
      // 創建表格
      let tableHTML = `
        <table class="admin-table">
          <thead>
            <tr>
              <th>標題</th>
              <th>日期</th>
              <th>分類</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
      `;
      
      // 添加行
      currentVideos.forEach((video, index) => {
        tableHTML += `
          <tr>
            <td>${video.title}</td>
            <td>${video.date}</td>
            <td>${video.category}</td>
            <td class="actions">
              <a href="#" class="admin-btn view-btn video-preview" data-index="${startIndex + index}">預覽</a>
              <button class="admin-btn delete-btn video-delete-btn" data-index="${startIndex + index}">刪除</button>
            </td>
          </tr>
        `;
      });

<!-- 合併第二段代碼 -->

<script>
tableHTML += `
          </tbody>
        </table>
      `;
      
      videosContainer.innerHTML = tableHTML;
      
      // 綁定刪除影片按鈕事件
      document.querySelectorAll('.video-delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          videoToDelete = index;
          openDeleteVideoModal();
        });
      });
      
      // 綁定預覽影片按鈕事件
      document.querySelectorAll('.video-preview').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const index = parseInt(this.getAttribute('data-index'));
          const video = videoData.videos[index];
          
          // 創建預覽視窗
          const previewHTML = `
            <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1001; display: flex; justify-content: center; align-items: center;">
              <div style="background: white; width: 80%; max-width: 800px; border-radius: 8px; overflow: hidden; position: relative;">
                <div style="position: absolute; top: 10px; right: 10px; z-index: 10; width: 30px; height: 30px; background: #f0f0f0; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer;">✕</div>
                <div style="padding-top: 56.25%; position: relative;">
                  <iframe src="${video.embedUrl}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" allowfullscreen></iframe>
                </div>
                <div style="padding: 20px;">
                  <h3>${video.title}</h3>
                  <p><small>${video.date}</small></p>
                  <p>${video.description}</p>
                  <p><small>分類: ${video.category}</small></p>
                  <div>
                    ${video.tags.map(tag => `<span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; padding: 2px 8px; background: #f0f0f0; border-radius: 12px; font-size: 0.8rem;">${tag}</span>`).join('')}
                  </div>
                </div>
              </div>
            </div>
          `;
          
          // 添加預覽視窗到頁面
          const previewElement = document.createElement('div');
          previewElement.innerHTML = previewHTML;
          document.body.appendChild(previewElement);
          
          // 綁定關閉按鈕
          previewElement.querySelector('div[style*="position: absolute; top: 10px; right: 10px;"]').addEventListener('click', function() {
            document.body.removeChild(previewElement);
          });
          
          // 點擊背景關閉
          previewElement.firstChild.addEventListener('click', function(e) {
            if (e.target === this) {
              document.body.removeChild(previewElement);
            }
          });
        });
      });
      
      // 渲染分頁
      renderVideoPagination(totalPages);
    }
    
    /**
     * 渲染圖片列表
     */
    function renderImages() {
      if (!imageData || imageData.length === 0) {
        imagesContainer.innerHTML = `
          <div class="message info">尚無圖片</div>
        `;
        imagePaginationContainer.innerHTML = '';
        return;
      }
      
      // 計算分頁
      const totalPages = Math.ceil(imageData.length / (itemsPerPage * 2));
      imageCurrentPage = Math.min(imageCurrentPage, totalPages);
      
      // 獲取當前頁的圖片
      const startIndex = (imageCurrentPage - 1) * (itemsPerPage * 2);
      const endIndex = Math.min(startIndex + (itemsPerPage * 2), imageData.length);
      const currentImages = imageData.slice(startIndex, endIndex);
      
      // 創建圖片網格
      let gridHTML = `<div class="image-grid">`;
      
      // 添加圖片項目
      currentImages.forEach((image, index) => {
        gridHTML += `
          <div class="image-item" data-index="${startIndex + index}">
            <div class="image-preview">
              <img src="${image.path}" alt="${image.name}" onerror="this.src='/assets/images/default.jpg';">
            </div>
            <div class="image-info">
              <h4 class="image-name">${image.name}</h4>
              <p class="image-path">${image.path}</p>
              <div class="image-actions">
                <button class="admin-btn view-btn image-preview-btn" data-index="${startIndex + index}">詳情</button>
                <button class="admin-btn delete-btn image-delete-btn" data-index="${startIndex + index}">刪除</button>
              </div>
            </div>
          </div>
        `;
      });
      
      gridHTML += `</div>`;
      
      imagesContainer.innerHTML = gridHTML;
      
      // 綁定詳情按鈕事件
      document.querySelectorAll('.image-preview-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          selectedImage = imageData[index];
          openImagePreviewModal(selectedImage);
        });
      });
      
      // 綁定刪除圖片按鈕事件
      document.querySelectorAll('.image-delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          imageToDelete = imageData[index];
          openDeleteImageModal();
        });
      });
      
      // 點擊圖片項目也可以打開詳情
      document.querySelectorAll('.image-item').forEach(item => {
        item.addEventListener('click', function(e) {
          // 避免點擊按鈕時觸發
          if (e.target.tagName !== 'BUTTON') {
            const index = parseInt(this.getAttribute('data-index'));
            selectedImage = imageData[index];
            openImagePreviewModal(selectedImage);
          }
        });
      });
      
      // 渲染分頁
      renderImagePagination(totalPages);
    }
    
    /**
     * 渲染文章分頁控制
     */
    function renderArticlePagination(totalPages) {
      if (!paginationContainer) {
        console.warn('找不到文章分頁容器元素');
        return;
      }
      
      if (totalPages <= 1) {
        paginationContainer.innerHTML = '';
        return;
      }
      
      paginationContainer.innerHTML = '';
      
      // 上一頁按鈕
      const prevBtn = document.createElement('button');
      prevBtn.className = `page-btn ${currentPage === 1 ? 'disabled' : ''}`;
      prevBtn.textContent = '上一頁';
      prevBtn.disabled = currentPage === 1;
      prevBtn.addEventListener('click', function() {
        if (currentPage > 1) {
          currentPage--;
          renderArticles();
        }
      });
      paginationContainer.appendChild(prevBtn);
      
      // 頁碼按鈕
      for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
        pageBtn.textContent = i;
        
        pageBtn.addEventListener('click', function() {
          currentPage = i;
          renderArticles();
        });
        
        paginationContainer.appendChild(pageBtn);
      }
      
      // 下一頁按鈕
      const nextBtn = document.createElement('button');
      nextBtn.className = `page-btn ${currentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.textContent = '下一頁';
      nextBtn.disabled = currentPage === totalPages;
      nextBtn.addEventListener('click', function() {
        if (currentPage < totalPages) {
          currentPage++;
          renderArticles();
        }
      });
      paginationContainer.appendChild(nextBtn);
    }
    
    /**
     * 渲染影片分頁控制
     */
    function renderVideoPagination(totalPages) {
      if (!videoPaginationContainer) {
        console.warn('找不到影片分頁容器元素');
        return;
      }
      
      if (totalPages <= 1) {
        videoPaginationContainer.innerHTML = '';
        return;
      }
      
      videoPaginationContainer.innerHTML = '';
      
      // 上一頁按鈕
      const prevBtn = document.createElement('button');
      prevBtn.className = `page-btn ${videoCurrentPage === 1 ? 'disabled' : ''}`;
      prevBtn.textContent = '上一頁';
      prevBtn.disabled = videoCurrentPage === 1;
      prevBtn.addEventListener('click', function() {
        if (videoCurrentPage > 1) {
          videoCurrentPage--;
          renderVideos();
        }
      });
      videoPaginationContainer.appendChild(prevBtn);
      
      // 頁碼按鈕
      for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `page-btn ${i === videoCurrentPage ? 'active' : ''}`;
        pageBtn.textContent = i;
        
        pageBtn.addEventListener('click', function() {
          videoCurrentPage = i;
          renderVideos();
        });
        
        videoPaginationContainer.appendChild(pageBtn);
      }
      
      // 下一頁按鈕
      const nextBtn = document.createElement('button');
      nextBtn.className = `page-btn ${videoCurrentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.textContent = '下一頁';
      nextBtn.disabled = videoCurrentPage === totalPages;
      nextBtn.addEventListener('click', function() {
        if (videoCurrentPage < totalPages) {
          videoCurrentPage++;
          renderVideos();
        }
      });
      videoPaginationContainer.appendChild(nextBtn);
    }
    
    /**
     * 渲染圖片分頁控制
     */
    function renderImagePagination(totalPages) {
      if (!imagePaginationContainer) {
        console.warn('找不到圖片分頁容器元素');
        return;
      }
      
      if (totalPages <= 1) {
        imagePaginationContainer.innerHTML = '';
        return;
      }
      
      imagePaginationContainer.innerHTML = '';
      
      // 上一頁按鈕
      const prevBtn = document.createElement('button');
      prevBtn.className = `page-btn ${imageCurrentPage === 1 ? 'disabled' : ''}`;
      prevBtn.textContent = '上一頁';
      prevBtn.disabled = imageCurrentPage === 1;
      prevBtn.addEventListener('click', function() {
        if (imageCurrentPage > 1) {
          imageCurrentPage--;
          renderImages();
        }
      });
      imagePaginationContainer.appendChild(prevBtn);
      
      // 頁碼按鈕
      for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `page-btn ${i === imageCurrentPage ? 'active' : ''}`;
        pageBtn.textContent = i;
        
        pageBtn.addEventListener('click', function() {
          imageCurrentPage = i;
          renderImages();
        });
        
        imagePaginationContainer.appendChild(pageBtn);
      }
      
      // 下一頁按鈕
      const nextBtn = document.createElement('button');
      nextBtn.className = `page-btn ${imageCurrentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.textContent = '下一頁';
      nextBtn.disabled = imageCurrentPage === totalPages;
      nextBtn.addEventListener('click', function() {
        if (imageCurrentPage < totalPages) {
          imageCurrentPage++;
          renderImages();
        }
      });
      imagePaginationContainer.appendChild(nextBtn);
    }
    
    /**
     * 刪除文章
     */
    async function deleteArticle(articleUrl) {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        // 獲取文件名
        const filename = articleUrl.split('/').pop();
        const filePath = `blog/${filename}`;
        
        // 確認用戶真的要刪除
        showMessage(`您將刪除文章: ${filePath}`, 'info');
        
        // 模擬刪除成功
        setTimeout(() => {
          // 從本地數據中移除文章
          if (articleData && articleData.posts) {
            const postIndex = articleData.posts.findIndex(post => post.url === articleUrl);
            if (postIndex !== -1) {
              articleData.posts.splice(postIndex, 1);
              articleData.pagination.total_posts = articleData.posts.length;
              articleData.pagination.total_pages = Math.max(1, Math.ceil(articleData.posts.length / articleData.pagination.items_per_page));
              
              // 重新渲染文章列表
              renderArticles();
              
              // 顯示成功訊息
              showMessage('文章刪除操作已執行，請注意實際文件可能需要手動在GitHub中刪除', 'success');
            }
          }
        }, 1000);
      } catch (error) {
        console.error('刪除文章時出錯:', error);
        showMessage(`刪除失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 刪除影片
     */
    async function deleteVideo(videoIndex) {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        // 確認影片數據存在
        if (!videoData || !videoData.videos || !videoData.videos[videoIndex]) {
          throw new Error('找不到要刪除的影片');
        }
        
        // 從videoData中刪除選定的影片
        const updatedVideoData = JSON.parse(JSON.stringify(videoData)); // 深拷貝
        const deletedVideo = updatedVideoData.videos.splice(videoIndex, 1)[0];
        
        // 更新分頁信息
        updatedVideoData.pagination.total = updatedVideoData.videos.length;
        updatedVideoData.pagination.totalPages = Math.ceil(updatedVideoData.videos.length / updatedVideoData.pagination.itemsPerPage);
        
        // 顯示確認信息
        showMessage(`正在刪除影片: ${deletedVideo.title}`, 'info');
        
        // 模擬刪除成功
        setTimeout(() => {
          // 更新本地數據
          videoData = updatedVideoData;
          
          // 重新渲染影片列表
          renderVideos();
          
          // 顯示成功訊息
          showMessage('影片已成功刪除！請注意實際數據可能需要手動在GitHub中更新', 'success');
        }, 1000);
      } catch (error) {
        console.error('刪除影片時出錯:', error);
        showMessage(`刪除失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 刪除圖片
     */
    async function deleteImage(image) {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        // 確認圖片數據存在
        if (!image) {
          throw new Error('找不到要刪除的圖片');
        }
        
        // 顯示確認信息
        showMessage(`正在刪除圖片: ${image.name}`, 'info');
        
        // 模擬刪除成功
        setTimeout(() => {
          // 從imageData中刪除選定的圖片
          const imageIndex = imageData.findIndex(item => item.path === image.path);
          if (imageIndex !== -1) {
            imageData.splice(imageIndex, 1);
            
            // 重新渲染圖片列表
            renderImages();
            
            // 顯示成功訊息
            showMessage('圖片已成功刪除！請注意實際文件可能需要手動在GitHub中刪除', 'success');
          }
        }, 1000);
      } catch (error) {
        console.error('刪除圖片時出錯:', error);
        showMessage(`刪除失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 替換圖片
     */
    async function replaceImage(oldImage, newFile) {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        // 確認圖片數據存在
        if (!oldImage) {
          throw new Error('找不到要替換的圖片');
        }
        
        // 確認新文件是圖片
        const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml'];
        if (!validTypes.includes(newFile.type)) {
          throw new Error('上傳的文件不是有效的圖片格式');
        }
        
        // 顯示確認信息
        showMessage(`正在替換圖片: ${oldImage.name}`, 'info');
        
        // 模擬替換成功
        setTimeout(() => {
          // 顯示成功訊息
          showMessage('圖片已成功替換！請注意實際文件可能需要手動在GitHub中更新', 'success');
          
          // 重新加載圖片列表
          loadImages();
        }, 1500);
      } catch (error) {
        console.error('替換圖片時出錯:', error);
        showMessage(`替換失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 上傳 Word 文檔
     */
    async function uploadWordDocument() {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        if (!fileToUpload) {
          throw new Error('請選擇文件');
        }
        
        // 檢查文件名格式
        if (!fileToUpload.name.match(/^\d{4}-\d{2}-\d{2}-.+\.docx$/)) {
          throw new Error('文件名格式不正確，應為: YYYY-MM-DD-文章標題.docx');
        }
        
        // 顯示上傳中信息
        showMessage(`正在上傳文件: ${fileToUpload.name}`, 'info');
        
        // 處理縮圖
        let thumbnailMessage = '';
        if (thumbnailToUpload) {
          thumbnailMessage = `，並上傳縮圖：${thumbnailToUpload.name}`;
        }
        
        // 模擬上傳成功
        setTimeout(() => {
          // 顯示成功訊息
          showMessage(`文件上傳成功${thumbnailMessage}！系統將在幾分鐘內處理並生成HTML文章。`, 'success');
          
          // 清空上傳表單
          document.getElementById('word-file').value = '';
          document.getElementById('article-thumbnail').value = '';
          fileToUpload = null;
          thumbnailToUpload = null;
        }, 1500);
      } catch (error) {
        console.error('上傳文章時出錯:', error);
        showMessage(`上傳失敗: ${error.message}`, 'error');
      }
    }
    
   /**
 * 上傳圖片
 */
async function uploadImage() {
  try {
    // 檢查權限
    if (!isAuthenticated) {
      throw new Error('您需要先登入才能執行此操作');
    }
    
    if (!imageToUpload) {
      throw new Error('請選擇圖片文件');
    }
    
    // 顯示上傳中信息
    showMessage(`正在處理圖片...`, 'info');
    
    // 根據分類確定目標尺寸
    let targetWidth, targetHeight, maintainAspectRatio = true;
    switch (imageToUpload.category) {
      case 'blog':
        targetWidth = 800;
        targetHeight = 450;
        break;
      case 'team':
        targetWidth = 300;
        targetHeight = 300;
        maintainAspectRatio = false; // 團隊照片需要正方形
        break;
      case 'service':
        targetWidth = 128;
        targetHeight = 128;
        maintainAspectRatio = false; // 服務圖示需要固定尺寸
        break;
      default:
        targetWidth = 800;
        targetHeight = 600;
    }
    
    // 調整圖片大小
    const resizedImageBlob = await resizeImage(imageToUpload.file, targetWidth, targetHeight, maintainAspectRatio);
    
    // 生成檔案名稱
    const fileName = `${imageToUpload.name}.${imageToUpload.ext}`;
    
    // 根據分類確定上傳路徑
    let uploadPath;
    switch (imageToUpload.category) {
      case 'blog':
        uploadPath = `/assets/images/blog/${fileName}`;
        break;
      case 'team':
        uploadPath = `/assets/images/team/${fileName}`;
        break;
      case 'service':
        uploadPath = `/assets/images/services/${fileName}`;
        break;
      default:
        uploadPath = `/assets/images/${fileName}`;
    }
    
    // 顯示上傳中信息
    showMessage(`正在上傳圖片到: ${uploadPath}`, 'info');
    
    // 模擬上傳成功
    setTimeout(() => {
      // 添加新圖片到imageData
      imageData.unshift({
        name: fileName,
        path: uploadPath,
        size: Math.round(resizedImageBlob.size / 1024) + 'KB', // 實際大小
        dimensions: `${targetWidth}x${targetHeight}`, // 實際尺寸
        type: imageToUpload.category,
        lastModified: new Date().toISOString().split('T')[0]
      });
      
      // 重新渲染圖片列表
      renderImages();
      
      // 顯示成功訊息
      showMessage(`圖片上傳成功！已自動調整為 ${targetWidth}x${targetHeight} 像素`, 'success');
      
      // 清空上傳表單
      document.getElementById('image-file').value = '';
      document.getElementById('image-name').value = '';
      imageToUpload = null;
    }, 1500);
  } catch (error) {
    console.error('上傳圖片時出錯:', error);
    showMessage(`上傳失敗: ${error.message}`, 'error');
  }
}
    
    /**
     * 新增影片
     */
    async function addNewVideo() {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          throw new Error('您需要先登入才能執行此操作');
        }
        
        if (!videoToAdd) {
          throw new Error('影片數據無效');
        }
        
        // 顯示處理中信息
        showMessage(`正在新增影片: ${videoToAdd.title}`, 'info');
        
        // 模擬處理成功
        setTimeout(() => {
          // 添加新影片到videoData
          const updatedVideoData = JSON.parse(JSON.stringify(videoData)); // 深拷貝
          updatedVideoData.videos.unshift(videoToAdd); // 添加到開頭
          
          // 更新分頁信息
          updatedVideoData.pagination.total = updatedVideoData.videos.length;
          updatedVideoData.pagination.totalPages = Math.ceil(updatedVideoData.videos.length / updatedVideoData.pagination.itemsPerPage);
          
          // 更新本地數據
          videoData = updatedVideoData;
          
          // 重置表單
          videoForm.reset();
          videoToAdd = null;
          
          // 重新渲染影片列表
          renderVideos();
          
          // 顯示成功訊息
          showMessage('影片新增成功！請注意實際數據可能需要手動在GitHub中更新', 'success');
        }, 1000);
      } catch (error) {
        console.error('新增影片時出錯:', error);
        showMessage(`新增失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 掃描HTML文件並更新JSON
     */
    async function scanHtmlFiles() {
      try {
        // 檢查權限
        if (!isAuthenticated) {
          showMessage('您需要先登入才能執行此操作', 'error');
          showLoginModal();
          return;
        }
        
        showMessage('正在掃描HTML文件並更新JSON...', 'info');
        
        // 模擬掃描過程
        setTimeout(() => {
          showMessage('掃描完成！HTML文章已成功更新到JSON文件。', 'success');
          
          // 重新加載文章列表
          loadArticles();
        }, 2000);
      } catch (error) {
        console.error('掃描HTML文件時出錯:', error);
        showMessage(`掃描失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 顯示訊息
     */
    function showMessage(message, type = 'success') {
      messageContainer.innerHTML = `
        <div class="message ${type}">
          ${message}
        </div>
      `;
      
      // 5秒後自動隱藏訊息
      setTimeout(() => {
        messageContainer.innerHTML = '';
      }, 5000);
    }
    
    /**
     * 打開確認刪除文章彈窗
     */
    function openDeleteModal() {
      deleteModal.style.display = 'flex';
    }
    
    /**
     * 關閉確認刪除文章彈窗
     */
    function closeDeleteModal() {
      deleteModal.style.display = 'none';
    }
    
    /**
     * 打開確認刪除影片彈窗
     */
    function openDeleteVideoModal() {
      deleteVideoModal.style.display = 'flex';
    }
    
    /**
     * 關閉確認刪除影片彈窗
     */
    function closeDeleteVideoModal() {
      deleteVideoModal.style.display = 'none';
    }
    
    /**
     * 打開確認刪除圖片彈窗
     */
    function openDeleteImageModal() {
      deleteImageModal.style.display = 'flex';
    }
    
    /**
     * 關閉確認刪除圖片彈窗
     */
    function closeDeleteImageModal() {
      deleteImageModal.style.display = 'none';
    }
    
    /**
     * 打開圖片預覽模態框
     */
    function openImagePreviewModal(image) {
      // 設置預覽圖片
      document.getElementById('preview-image').src = image.path;
      
      // 設置圖片信息
      document.getElementById('preview-filename').textContent = image.name;
      document.getElementById('preview-dimensions').textContent = image.dimensions;
      document.getElementById('preview-filesize').textContent = image.size;
      
      // 設置HTML引用代碼
      document.getElementById('preview-html-code').textContent = `<img src="${image.path}" alt="${image.name}">`;
      
      // 顯示模態框
      imagePreviewModal.style.display = 'flex';
    }
    
    /**
     * 關閉圖片預覽模態框
     */
    function closeImagePreviewModal() {
      imagePreviewModal.style.display = 'none';
      selectedImage = null;
    }

/**
 * 調整圖片大小
 * @param {File} file 原始圖片文件
 * @param {number} maxWidth 目標寬度
 * @param {number} maxHeight 目標高度
 * @param {boolean} maintainAspectRatio 是否保持原始寬高比
 * @returns {Promise<Blob>} 調整大小後的圖片Blob
 */
function resizeImage(file, maxWidth, maxHeight, maintainAspectRatio = true) {
  return new Promise((resolve, reject) => {
    // 創建FileReader讀取圖片
    const reader = new FileReader();
    reader.onload = function(e) {
      // 創建Image物件
      const img = new Image();
      img.onload = function() {
        // 計算新的寬高
        let width = img.width;
        let height = img.height;
        
        if (maintainAspectRatio) {
          // 保持比例
          if (width > height) {
            if (width > maxWidth) {
              height = Math.round(height * (maxWidth / width));
              width = maxWidth;
            }
          } else {
            if (height > maxHeight) {
              width = Math.round(width * (maxHeight / height));
              height = maxHeight;
            }
          }
        } else {
          // 固定大小
          width = maxWidth;
          height = maxHeight;
        }
        
        // 創建canvas進行縮放
        const canvas = document.createElement('canvas');
        canvas.width = width;
        canvas.height = height;
        
        // 繪製圖片
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, width, height);
        
        // 獲取新的圖片數據
        canvas.toBlob(function(blob) {
          resolve(blob);
        }, file.type || 'image/jpeg');
      };
      img.onerror = function() {
        reject(new Error('圖片載入失敗'));
      };
      img.src = e.target.result;
    };
    reader.onerror = function() {
      reject(new Error('無法讀取文件'));
    };
    reader.readAsDataURL(file);
  });
}

  });
</script>

</body>
</html>
</script>
<!-- Corrected login form and logic -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const ADMIN_PASSWORD = 'wayne4591'; // 管理員密碼
    let isAuthenticated = false;
    const loginModal = document.getElementById('login-modal');
    const loginForm = document.getElementById('login-form-unique');
    const adminLoginPasswordInput = document.getElementById('admin-login-password-unique');
    
    // 驗證密碼是否正確
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const password = adminLoginPasswordInput.value.trim();
            if (password === ADMIN_PASSWORD) {
                setAuthenticated(true);
                loginModal.style.display = 'none';
                loadArticles();
                loadVideos();
                loadImages();
                showMessage('登入成功，歡迎使用內容管理平台', 'success');
            } else {
                alert('密碼不正確，請重試');
            }
        });
    }

    // 設置認證狀態
    function setAuthenticated(status) {
        isAuthenticated = status;
        if (status) {
            const now = new Date().getTime();
            const authExpireTime = now + 2 * 60 * 60 * 1000;
            localStorage.setItem('adminAuth', 'true');
            localStorage.setItem('authExpireTime', authExpireTime.toString());
        } else {
            localStorage.removeItem('adminAuth');
            localStorage.removeItem('authExpireTime');
        }
    }

    // 測試登入按鈕
    const debugLoginBtn = document.createElement('button');
    debugLoginBtn.style.position = 'fixed';
    debugLoginBtn.style.bottom = '10px';
    debugLoginBtn.style.right = '10px';
    debugLoginBtn.style.zIndex = '9999';
    debugLoginBtn.style.padding = '5px 10px';
    debugLoginBtn.style.background = '#ff9800';
    debugLoginBtn.style.color = 'white';
    debugLoginBtn.style.border = 'none';
    debugLoginBtn.style.borderRadius = '4px';
    debugLoginBtn.style.cursor = 'pointer';
    debugLoginBtn.textContent = '測試登入';
    debugLoginBtn.addEventListener('click', function() {
        setAuthenticated(true);
        loginModal.style.display = 'none';
        loadArticles();
        loadVideos();
        loadImages();
        showMessage('測試登入成功', 'success');
    });
    document.body.appendChild(debugLoginBtn);

    // 顯示登入窗口
    function showLoginModal() {
        loginModal.style.display = 'flex';
        if (adminLoginPasswordInput) {
            adminLoginPasswordInput.value = '';
            adminLoginPasswordInput.focus();
        }
    }

    // 載入文章、影片和圖片的函數
    function loadArticles() {
        console.log("Articles loaded.");
    }

    function loadVideos() {
        console.log("Videos loaded.");
    }

    function loadImages() {
        console.log("Images loaded.");
    }

    // 顯示提示訊息
    function showMessage(message, type) {
        const messageContainer = document.getElementById('message-container');
        messageContainer.innerHTML = `<div class="message ${type}">${message}</div>`;
    }

    // 檢查是否已經登入
    function checkAuthStatus() {
        const storedAuth = localStorage.getItem('adminAuth');
        const storedExpireTime = localStorage.getItem('authExpireTime');
        const now = new Date().getTime();
        
        if (storedAuth && storedExpireTime && now < parseInt(storedExpireTime)) {
            isAuthenticated = true;
            loginModal.style.display = 'none';
            loadArticles();
            loadVideos();
            loadImages();
        } else {
            showLoginModal();
        }
    }

    checkAuthStatus();
});
</script>
