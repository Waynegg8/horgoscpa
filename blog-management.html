<!DOCTYPE html>

<html lang="zh-TW">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="noindex, nofollow" name="robots"/> <!-- 防止搜索引擎索引管理頁面 -->
<title>內容管理 | 霍爾果斯會計師事務所</title>
<!-- Favicon -->
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="/assets/images/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="/assets/images/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="/site.webmanifest" rel="manifest"/>
<!-- 引用樣式表 -->
<link href="/assets/css/style.css" rel="stylesheet">
<style>
    /* 管理頁面特定樣式 */
    .admin-container {
      padding: 30px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-width: 1000px;
      margin: 30px auto;
    }
    
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .admin-title {
      margin: 0;
      color: #002147;
    }
    
    .admin-actions {
      display: flex;
      gap: 15px;
    }
    
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }
    
    .admin-table th,
    .admin-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    .admin-table th {
      background-color: #f5f7fa;
      font-weight: 600;
    }
    
    .admin-table tr:hover {
      background-color: #f9f9f9;
    }
    
    .admin-table .actions {
      display: flex;
      gap: 10px;
    }
    
    .admin-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .delete-btn {
      background-color: #ff4d4f;
      color: white;
    }
    
    .delete-btn:hover {
      background-color: #ff2e30;
    }
    
    .view-btn {
      background-color: #0066cc;
      color: white;
    }
    
    .view-btn:hover {
      background-color: #0055aa;
    }
    
    .refresh-btn {
      background-color: #52c41a;
      color: white;
    }
    
    .refresh-btn:hover {
      background-color: #47a919;
    }
    
    /* 分頁樣式 */
    .admin-pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    
    .page-btn {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background-color: #fff;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s;
    }
    
    .page-btn.active {
      background-color: #0066cc;
      color: white;
      border-color: #0066cc;
    }
    
    .page-btn:hover:not(.active) {
      background-color: #f0f0f0;
    }
    
    /* 確認彈窗樣式 */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background-color: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      max-width: 450px;
      width: 80%;
      text-align: center;
    }
    
    .modal-title {
      margin-top: 0;
      color: #333;
    }
    
    .modal-message {
      margin-bottom: 25px;
      line-height: 1.6;
    }
    
    .modal-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .cancel-btn {
      background-color: #f0f0f0;
      color: #333;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .cancel-btn:hover {
      background-color: #e0e0e0;
    }
    
    .confirm-btn {
      background-color: #ff4d4f;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .confirm-btn:hover {
      background-color: #ff2e30;
    }
    
    /* 加載動畫 */
    .loading {
      text-align: center;
      padding: 50px;
    }
    
    .loading-spinner {
      display: inline-block;
      width: 50px;
      height: 50px;
      border: 3px solid rgba(0, 102, 204, 0.2);
      border-radius: 50%;
      border-top-color: #0066cc;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* 訊息提示 */
    .message {
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
      text-align: center;
      font-weight: 500;
    }
    
    .success {
      background-color: #f6ffed;
      border: 1px solid #b7eb8f;
      color: #52c41a;
    }
    
    .error {
      background-color: #fff2f0;
      border: 1px solid #ffccc7;
      color: #ff4d4f;
    }
    
    .info {
      background-color: #e6f7ff;
      border: 1px solid #91d5ff;
      color: #1890ff;
    }
    
    /* 文件上傳區域 */
    .upload-area {
      margin-top: 30px;
      padding: 25px;
      background-color: #f9f9f9;
      border-radius: 8px;
      text-align: center;
    }
    
    .upload-title {
      margin-top: 0;
      color: #333;
    }
    
    .upload-input {
      margin: 15px 0;
    }
    
    .upload-btn {
      background-color: #0066cc;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    
    .upload-btn:hover {
      background-color: #0055aa;
    }
    
    /* 管理員密碼輸入框 */
    .password-input {
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      width: 100%;
      margin-bottom: 20px;
    }
    
    .password-input:focus {
      border-color: #0066cc;
      box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.2);
      outline: none;
    }

    /* 表單區塊樣式 */
    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-group select {
      height: 38px;
    }

    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    /* 頁籤樣式 */
    .admin-tabs {
      display: flex;
      border-bottom: 1px solid #eee;
      margin-bottom: 20px;
    }
    
    .tab-item {
      padding: 12px 20px;
      cursor: pointer;
      font-weight: 500;
      color: #666;
      border-bottom: 2px solid transparent;
      transition: all 0.3s;
    }
    
    .tab-item:hover {
      color: #0066cc;
    }
    
    .tab-item.active {
      color: #0066cc;
      border-bottom-color: #0066cc;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
  </style>
</link></head>
<body>
<!-- 導航欄容器 - 將由JS加載 -->
<div id="navbar-container"></div>
<!-- 管理頁面內容 -->
<main class="admin-page">
<div class="container">
<div class="admin-container">
<div class="admin-header">
<h1 class="admin-title">內容管理平台</h1>
<div class="admin-actions">
<button class="admin-btn refresh-btn" id="refresh-btn">刷新列表</button>
<button class="admin-btn refresh-btn" id="scan-btn" style="background-color: #ff9800; margin-left: 10px;">掃描HTML文章</button>
<a class="admin-btn view-btn" href="/blog.html">查看博客</a>
<a class="admin-btn view-btn" href="/video.html">查看影片</a>
</div>
</div>
<!-- 頁籤導航 -->
<div class="admin-tabs">
<div class="tab-item active" data-tab="blog-tab">部落格文章</div>
<div class="tab-item" data-tab="video-tab">影片管理</div>
</div>
<!-- 訊息容器 -->
<div id="message-container"></div>
<!-- 文章管理頁籤內容 -->
<div class="tab-content active" id="blog-tab">
<!-- 文章列表表格 -->
<div id="articles-container">
<div class="loading">
<div class="loading-spinner"></div>
<p>加載文章中...</p>
</div>
</div>
<!-- 分頁控制 -->
<div class="admin-pagination" id="pagination-container"></div>
<!-- 上傳新 Word 文章區域 -->
<div class="upload-area">
<h2 class="upload-title">上傳新文章</h2>
<p>請選擇 Word 文檔以創建新文章。文檔名稱應使用日期前綴格式（例如：2025-05-01-文章標題.docx）</p>
<form id="upload-form">
<div class="upload-input">
<input accept=".docx" id="word-file" required="" type="file"/>
</div>
<button class="upload-btn" type="submit">上傳文章</button>
</form>
</div>
</div>
<!-- 影片管理頁籤內容 -->
<div class="tab-content" id="video-tab">
<!-- 影片列表表格 -->
<div id="videos-container">
<div class="loading">
<div class="loading-spinner"></div>
<p>加載影片中...</p>
</div>
</div>
<!-- 影片分頁控制 -->
<div class="admin-pagination" id="video-pagination-container"></div>
<!-- 新增影片表單 -->
<div class="upload-area">
<h2 class="upload-title">新增影片</h2>
<p>填寫下方表單，將新影片加入到影片列表中</p>
<form id="video-form">
<div class="form-group">
<label for="video-title">影片標題</label>
<input id="video-title" required="" type="text"/>
</div>
<div class="form-group">
<label for="video-date">發布日期</label>
<input id="video-date" required="" type="date"/>
</div>
<div class="form-group">
<label for="video-description">影片描述</label>
<textarea id="video-description" required=""></textarea>
</div>
<div class="form-group">
<label for="video-embed">YouTube 嵌入網址</label>
<input id="video-embed" placeholder="例如：https://www.youtube.com/embed/xxxxxxxxxx" required="" type="text"/>
</div>
<div class="form-group">
<label for="video-category">影片分類</label>
<select id="video-category" required="">
<option value="tax">稅務相關</option>
<option value="accounting">會計記帳</option>
<option value="business">企業經營</option>
<option value="tutorial">操作教學</option>
</select>
</div>
<div class="form-group">
<label for="video-tags">標籤（以逗號分隔）</label>
<input id="video-tags" placeholder="例如：報稅,所得稅,企業稅務" type="text"/>
</div>
<button class="upload-btn" type="submit">新增影片</button>
</form>
</div>
</div>
</div>
</div>
</main>
<!-- 確認刪除文章彈窗 -->
<div class="modal" id="delete-modal">
<div class="modal-content">
<h2 class="modal-title">確認刪除</h2>
<p class="modal-message">您確定要刪除這篇文章嗎？此操作不可恢復。</p>
<div style="margin-bottom: 20px;">
<input class="password-input" id="admin-password" placeholder="請輸入管理員密碼" required="" type="password"/>
</div>
<div class="modal-buttons">
<button class="cancel-btn" id="cancel-delete">取消</button>
<button class="confirm-btn" id="confirm-delete">確認刪除</button>
</div>
</div>
</div>
<!-- 確認刪除影片彈窗 -->
<div class="modal" id="delete-video-modal">
<div class="modal-content">
<h2 class="modal-title">確認刪除影片</h2>
<p class="modal-message">您確定要刪除這個影片嗎？此操作不可恢復。</p>
<div style="margin-bottom: 20px;">
<input class="password-input" id="video-admin-password" placeholder="請輸入管理員密碼" required="" type="password"/>
</div>
<div class="modal-buttons">
<button class="cancel-btn" id="cancel-video-delete">取消</button>
<button class="confirm-btn" id="confirm-video-delete">確認刪除</button>
</div>
</div>
</div>
<!-- 上傳文章密碼彈窗 -->
<div class="modal" id="upload-modal">
<div class="modal-content">
<h2 class="modal-title">管理員驗證</h2>
<p class="modal-message">請輸入管理員密碼以上傳文章</p>
<div style="margin-bottom: 20px;">
<input class="password-input" id="upload-password" placeholder="請輸入管理員密碼" required="" type="password"/>
</div>
<div class="modal-buttons">
<button class="cancel-btn" id="cancel-upload">取消</button>
<button class="confirm-btn" id="confirm-upload">確認上傳</button>
</div>
</div>
</div>
<!-- 新增影片密碼彈窗 -->
<div class="modal" id="add-video-modal">
<div class="modal-content">
<h2 class="modal-title">管理員驗證</h2>
<p class="modal-message">請輸入管理員密碼以新增影片</p>
<div style="margin-bottom: 20px;">
<input class="password-input" id="add-video-password" placeholder="請輸入管理員密碼" required="" type="password"/>
</div>
<div class="modal-buttons">
<button class="cancel-btn" id="cancel-add-video">取消</button>
<button class="confirm-btn" id="confirm-add-video">確認新增</button>
</div>
</div>
</div>
<!-- 頁尾區域 -->
<footer class="site-footer">
<div class="footer-container">
<div class="footer-text">
<p>© 2025 霍爾果斯會計師事務所 | 台中市西區建國路21號3樓之1 | 電話：<a href="tel:+886422205606">04-2220-5606</a></p>
</div>
</div>
</footer>
<!-- GitHub API操作腳本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // GitHub 設置
    const GITHUB_OWNER = 'waynegg8'; // 更改為您的GitHub用戶名
    const GITHUB_REPO = 'horgoscpa'; // 更改為您的儲存庫名稱
    const GITHUB_BRANCH = 'main';    // 更改為您的主分支名稱
    const ADMIN_PASSWORD = 'wayne4591'; // 管理員密碼
    
    // 元素
    const articlesContainer = document.getElementById('articles-container');
    const videosContainer = document.getElementById('videos-container');
    const paginationContainer = document.getElementById('pagination-container');
    const videoPaginationContainer = document.getElementById('video-pagination-container');
    const messageContainer = document.getElementById('message-container');
    const refreshBtn = document.getElementById('refresh-btn');
    const deleteModal = document.getElementById('delete-modal');
    const deleteVideoModal = document.getElementById('delete-video-modal');
    const uploadModal = document.getElementById('upload-modal');
    const addVideoModal = document.getElementById('add-video-modal');
    const cancelDeleteBtn = document.getElementById('cancel-delete');
    const confirmDeleteBtn = document.getElementById('confirm-delete');
    const cancelVideoDeleteBtn = document.getElementById('cancel-video-delete');
    const confirmVideoDeleteBtn = document.getElementById('confirm-video-delete');
    const cancelUploadBtn = document.getElementById('cancel-upload');
    const confirmUploadBtn = document.getElementById('confirm-upload');
    const cancelAddVideoBtn = document.getElementById('cancel-add-video');
    const confirmAddVideoBtn = document.getElementById('confirm-add-video');
    const uploadForm = document.getElementById('upload-form');
    const videoForm = document.getElementById('video-form');
    const adminPasswordInput = document.getElementById('admin-password');
    const videoAdminPasswordInput = document.getElementById('video-admin-password');
    const uploadPasswordInput = document.getElementById('upload-password');
    const addVideoPasswordInput = document.getElementById('add-video-password');
    const tabItems = document.querySelectorAll('.tab-item');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // 狀態
    let articleData = null;
    let videoData = null;
    let currentPage = 1;
    let videoCurrentPage = 1;
    let itemsPerPage = 10;
    let articleToDelete = null;
    let videoToDelete = null;
    let fileToUpload = null;
    let videoToAdd = null;
    
    // 初始加載數據
    loadArticles();
    loadVideos();
    
    // 刷新按鈕事件
    refreshBtn.addEventListener('click', function() {
      const activeTab = document.querySelector('.tab-item.active').getAttribute('data-tab');
      if (activeTab === 'blog-tab') {
        loadArticles();
      } else if (activeTab === 'video-tab') {
        loadVideos();
      }
    });
    
    // 掃描HTML文章按鈕事件
    const scanBtn = document.getElementById('scan-btn');
    if (scanBtn) {
      scanBtn.addEventListener('click', function() {
        // 確認是否要執行掃描
        if (confirm('確定要掃描所有HTML文章並更新JSON文件嗎？這將覆蓋現有的文章數據。')) {
          scanHtmlFiles();
        }
      });
    }
    
    // 標籤切換事件
    tabItems.forEach(tab => {
      tab.addEventListener('click', function() {
        // 移除所有標籤的活動狀態
        tabItems.forEach(item => item.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        
        // 設置當前標籤為活動狀態
        this.classList.add('active');
        const tabId = this.getAttribute('data-tab');
        document.getElementById(tabId).classList.add('active');
      });
    });
    
    // 上傳文章表單提交
    uploadForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 獲取選擇的文件
      const fileInput = document.getElementById('word-file');
      if (fileInput.files.length > 0) {
        fileToUpload = fileInput.files[0];
        openUploadModal();
      } else {
        showMessage('請選擇要上傳的文件', 'error');
      }
    });
    
    // 新增影片表單提交
    videoForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 獲取表單數據
      const title = document.getElementById('video-title').value.trim();
      const date = document.getElementById('video-date').value;
      const description = document.getElementById('video-description').value.trim();
      const embedUrl = document.getElementById('video-embed').value.trim();
      const category = document.getElementById('video-category').value;
      const tagsInput = document.getElementById('video-tags').value.trim();
      
      // 處理標籤
      const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
      
      // 創建影片對象
      videoToAdd = {
        title,
        date,
        description,
        embedUrl,
        category,
        tags
      };
      
      // 驗證URL
      if (!embedUrl.startsWith('https://www.youtube.com/embed/')) {
        showMessage('請輸入有效的YouTube嵌入網址，以"https://www.youtube.com/embed/"開頭', 'error');
        return;
      }
      
      // 打開確認對話框
      openAddVideoModal();
    });
    
    // 確認上傳文章按鈕事件
    confirmUploadBtn.addEventListener('click', function() {
      const password = uploadPasswordInput.value.trim();
      if (password === ADMIN_PASSWORD) {
        uploadWordDocument(password);
        closeUploadModal();
      } else {
        alert('管理員密碼不正確');
      }
    });
    
    // 確認新增影片按鈕事件
    confirmAddVideoBtn.addEventListener('click', function() {
      const password = addVideoPasswordInput.value.trim();
      if (password === ADMIN_PASSWORD) {
        addNewVideo(password);
        closeAddVideoModal();
      } else {
        alert('管理員密碼不正確');
      }
    });
    
    // 取消上傳文章按鈕事件
    cancelUploadBtn.addEventListener('click', function() {
      closeUploadModal();
    });
    
    // 取消新增影片按鈕事件
    cancelAddVideoBtn.addEventListener('click', function() {
      closeAddVideoModal();
    });
    
    // 取消刪除文章按鈕
    cancelDeleteBtn.addEventListener('click', function() {
      closeDeleteModal();
    });
    
    // 確認刪除文章按鈕
    confirmDeleteBtn.addEventListener('click', function() {
      const password = adminPasswordInput.value.trim();
      if (password === ADMIN_PASSWORD && articleToDelete) {
        deleteArticle(articleToDelete, password);
        closeDeleteModal();
      } else if (password !== ADMIN_PASSWORD) {
        alert('管理員密碼不正確');
      }
    });
    
    // 取消刪除影片按鈕
    cancelVideoDeleteBtn.addEventListener('click', function() {
      closeDeleteVideoModal();
    });
    
    // 確認刪除影片按鈕
    confirmVideoDeleteBtn.addEventListener('click', function() {
      const password = videoAdminPasswordInput.value.trim();
      if (password === ADMIN_PASSWORD && videoToDelete !== null) {
        deleteVideo(videoToDelete, password);
        closeDeleteVideoModal();
      } else if (password !== ADMIN_PASSWORD) {
        alert('管理員密碼不正確');
      }
    });
    
    // 點擊模態框背景關閉
    window.addEventListener('click', function(e) {
      if (e.target === deleteModal) {
        closeDeleteModal();
      }
      if (e.target === deleteVideoModal) {
        closeDeleteVideoModal();
      }
      if (e.target === uploadModal) {
        closeUploadModal();
      }
      if (e.target === addVideoModal) {
        closeAddVideoModal();
      }
    });
    
    // 按鍵事件 - 在密碼輸入框中按Enter鍵確認
    adminPasswordInput.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        confirmDeleteBtn.click();
      }
    });
    
    videoAdminPasswordInput.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        confirmVideoDeleteBtn.click();
      }
    });
    
    uploadPasswordInput.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        confirmUploadBtn.click();
      }
    });
    
    addVideoPasswordInput.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        confirmAddVideoBtn.click();
      }
    });
    
    /**
     * 加載文章列表
     */
    async function loadArticles() {
      try {
        // 顯示加載中
        articlesContainer.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載文章中...</p>
          </div>
        `;
        
        try {
          // 嘗試從GitHub直接獲取JSON文件
          const response = await fetch(`https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/${GITHUB_BRANCH}/assets/data/blog-posts.json`);
          
          if (!response.ok) {
            throw new Error('無法從GitHub獲取文章數據');
          }
          
          // 嘗試解析JSON
          try {
            const data = await response.json();
            articleData = data;
            
            // 渲染文章列表
            renderArticles();
          } catch (parseError) {
            console.error('解析JSON時出錯:', parseError);
            throw new Error('JSON格式無效，無法解析');
          }
        } catch (error) {
          console.error('加載JSON出錯:', error);
          // 使用備用數據
          useArticleFallbackData();
        }
      } catch (error) {
        console.error('加載文章出錯:', error);
        articlesContainer.innerHTML = `
          <div class="message error">
            加載文章時出現問題：${error.message}
          </div>
        `;
      }
    }
    
    /**
     * 加載影片列表
     */
    async function loadVideos() {
      try {
        // 顯示加載中
        videosContainer.innerHTML = `
          <div class="loading">
            <div class="loading-spinner"></div>
            <p>加載影片中...</p>
          </div>
        `;
        
        try {
          // 嘗試從GitHub直接獲取JSON文件
          const response = await fetch(`https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/${GITHUB_BRANCH}/assets/data/videos.json`);
          
          if (!response.ok) {
            throw new Error('無法從GitHub獲取影片數據');
          }
          
          // 嘗試解析JSON
          try {
            const data = await response.json();
            videoData = data;
            
            // 渲染影片列表
            renderVideos();
          } catch (parseError) {
            console.error('解析影片JSON時出錯:', parseError);
            throw new Error('影片JSON格式無效，無法解析');
          }
        } catch (error) {
          console.error('加載影片JSON出錯:', error);
          // 使用備用數據
          useVideoFallbackData();
        }
      } catch (error) {
        console.error('加載影片出錯:', error);
        videosContainer.innerHTML = `
          <div class="message error">
            加載影片時出現問題：${error.message}
          </div>
        `;
      }
    }
    
    /**
     * 使用文章備用數據
     */
    function useArticleFallbackData() {
      // 創建空的文章數據
      articleData = {
        posts: [],
        pagination: {
          total_posts: 0,
          total_pages: 1,
          items_per_page: 6
        },
        categories: ["tax", "accounting", "business"],
        tags: []
      };
      
      // 渲染空文章列表
      renderArticles();
      
      // 顯示說明信息
      articlesContainer.innerHTML = `
        <div class="message info">
          <p>目前尚未有任何文章，或無法連接到文章資料。您可以點擊下方「上傳文章」新增第一篇文章。</p>
        </div>
      `;
    }
    
    /**
     * 使用影片備用數據
     */
    function useVideoFallbackData() {
      // 創建空的影片數據
      videoData = {
        videos: [],
        pagination: {
          total: 0,
          totalPages: 1,
          itemsPerPage: 6
        }
      };
      
      // 渲染空影片列表
      renderVideos();
      
      // 顯示說明信息
      videosContainer.innerHTML = `
        <div class="message info">
          <p>目前尚未有任何影片，或無法連接到影片資料。您可以在下方「新增影片」表單新增第一部影片。</p>
        </div>
      `;
    }
    
    /**
     * 渲染文章列表
     */
    function renderArticles() {
      if (!articleData || !articleData.posts || articleData.posts.length === 0) {
        articlesContainer.innerHTML = `
          <div class="message info">尚無文章</div>
        `;
        paginationContainer.innerHTML = '';
        return;
      }
      
      const posts = articleData.posts;
      
      // 計算分頁
      const totalPages = Math.ceil(posts.length / itemsPerPage);
      currentPage = Math.min(currentPage, totalPages);
      
      // 獲取當前頁的文章
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = Math.min(startIndex + itemsPerPage, posts.length);
      const currentPosts = posts.slice(startIndex, endIndex);
      
      // 創建表格
      let tableHTML = `
        <table class="admin-table">
          <thead>
            <tr>
              <th>標題</th>
              <th>日期</th>
              <th>分類</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
      `;
      
      // 添加行
      currentPosts.forEach(post => {
        tableHTML += `
          <tr>
            <td>${post.title}</td>
            <td>${post.date}</td>
            <td>${post.category}</td>
            <td class="actions">
              <a href="${post.url}" target="_blank" class="admin-btn view-btn">查看</a>
              <button class="admin-btn delete-btn" data-url="${post.url}">刪除</button>
            </td>
          </tr>
        `;
      });
      
      tableHTML += `
          </tbody>
        </table>
      `;
      
      articlesContainer.innerHTML = tableHTML;
      
      // 綁定刪除按鈕事件
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          articleToDelete = this.getAttribute('data-url');
          openDeleteModal();
        });
      });
      
      // 渲染分頁
      renderArticlePagination(totalPages);
    }
    
    /**
     * 渲染影片列表
     */
    function renderVideos() {
      if (!videoData || !videoData.videos || videoData.videos.length === 0) {
        videosContainer.innerHTML = `
          <div class="message info">尚無影片</div>
        `;
        videoPaginationContainer.innerHTML = '';
        return;
      }
      
      const videos = videoData.videos;
      
      // 計算分頁
      const totalPages = Math.ceil(videos.length / itemsPerPage);
      videoCurrentPage = Math.min(videoCurrentPage, totalPages);
      
      // 獲取當前頁的影片
      const startIndex = (videoCurrentPage - 1) * itemsPerPage;
      const endIndex = Math.min(startIndex + itemsPerPage, videos.length);
      const currentVideos = videos.slice(startIndex, endIndex);
      
      // 創建表格
      let tableHTML = `
        <table class="admin-table">
          <thead>
            <tr>
              <th>標題</th>
              <th>日期</th>
              <th>分類</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
      `;
      
      // 添加行
      currentVideos.forEach((video, index) => {
        tableHTML += `
          <tr>
            <td>${video.title}</td>
            <td>${video.date}</td>
            <td>${video.category}</td>
            <td class="actions">
              <a href="#" class="admin-btn view-btn video-preview" data-index="${startIndex + index}">預覽</a>
              <button class="admin-btn delete-btn video-delete-btn" data-index="${startIndex + index}">刪除</button>
            </td>
          </tr>
        `;
      });
      
      tableHTML += `
          </tbody>
        </table>
      `;
      
      videosContainer.innerHTML = tableHTML;
      
      // 綁定刪除影片按鈕事件
      document.querySelectorAll('.video-delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          videoToDelete = index;
          openDeleteVideoModal();
        });
      });
      
      // 綁定預覽影片按鈕事件
      document.querySelectorAll('.video-preview').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const index = parseInt(this.getAttribute('data-index'));
          const video = videoData.videos[index];
          
          // 創建預覽視窗
          const previewHTML = `
            <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1001; display: flex; justify-content: center; align-items: center;">
              <div style="background: white; width: 80%; max-width: 800px; border-radius: 8px; overflow: hidden; position: relative;">
                <div style="position: absolute; top: 10px; right: 10px; z-index: 10; width: 30px; height: 30px; background: #f0f0f0; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer;">✕</div>
                <div style="padding-top: 56.25%; position: relative;">
                  <iframe src="${video.embedUrl}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" allowfullscreen></iframe>
                </div>
                <div style="padding: 20px;">
                  <h3>${video.title}</h3>
                  <p><small>${video.date}</small></p>
                  <p>${video.description}</p>
                  <p><small>分類: ${video.category}</small></p>
                  <div>
                    ${video.tags.map(tag => `<span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; padding: 2px 8px; background: #f0f0f0; border-radius: 12px; font-size: 0.8rem;">${tag}</span>`).join('')}
                  </div>
                </div>
              </div>
            </div>
          `;
          
          // 添加預覽視窗到頁面
          const previewElement = document.createElement('div');
          previewElement.innerHTML = previewHTML;
          document.body.appendChild(previewElement);
          
          // 綁定關閉按鈕
          previewElement.querySelector('div[style*="position: absolute; top: 10px; right: 10px;"]').addEventListener('click', function() {
            document.body.removeChild(previewElement);
          });
          
          // 點擊背景關閉
          previewElement.firstChild.addEventListener('click', function(e) {
            if (e.target === this) {
              document.body.removeChild(previewElement);
            }
          });
        });
      });
      
      // 渲染分頁
      renderVideoPagination(totalPages);
    }
    
    /**
     * 渲染文章分頁控制
     */
    function renderArticlePagination(totalPages) {
      if (!paginationContainer) {
        console.warn('找不到文章分頁容器元素');
        return;
      }
      
      if (totalPages <= 1) {
        paginationContainer.innerHTML = '';
        return;
      }
      
      paginationContainer.innerHTML = '';
      
      // 上一頁按鈕
      const prevBtn = document.createElement('button');
      prevBtn.className = `page-btn ${currentPage === 1 ? 'disabled' : ''}`;
      prevBtn.textContent = '上一頁';
      prevBtn.disabled = currentPage === 1;
      prevBtn.addEventListener('click', function() {
        if (currentPage > 1) {
          currentPage--;
          renderArticles();
        }
      });
      paginationContainer.appendChild(prevBtn);
      
      // 頁碼按鈕
      for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
        pageBtn.textContent = i;
        
        pageBtn.addEventListener('click', function() {
          currentPage = i;
          renderArticles();
        });
        
        paginationContainer.appendChild(pageBtn);
      }
      
      // 下一頁按鈕
      const nextBtn = document.createElement('button');
      nextBtn.className = `page-btn ${currentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.textContent = '下一頁';
      nextBtn.disabled = currentPage === totalPages;
      nextBtn.addEventListener('click', function() {
        if (currentPage < totalPages) {
          currentPage++;
          renderArticles();
        }
      });
      paginationContainer.appendChild(nextBtn);
    }
    
    /**
     * 渲染影片分頁控制
     */
    function renderVideoPagination(totalPages) {
      if (!videoPaginationContainer) {
        console.warn('找不到影片分頁容器元素');
        return;
      }
      
      if (totalPages <= 1) {
        videoPaginationContainer.innerHTML = '';
        return;
      }
      
      videoPaginationContainer.innerHTML = '';
      
      // 上一頁按鈕
      const prevBtn = document.createElement('button');
      prevBtn.className = `page-btn ${videoCurrentPage === 1 ? 'disabled' : ''}`;
      prevBtn.textContent = '上一頁';
      prevBtn.disabled = videoCurrentPage === 1;
      prevBtn.addEventListener('click', function() {
        if (videoCurrentPage > 1) {
          videoCurrentPage--;
          renderVideos();
        }
      });
      videoPaginationContainer.appendChild(prevBtn);
      
      // 頁碼按鈕
      for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `page-btn ${i === videoCurrentPage ? 'active' : ''}`;
        pageBtn.textContent = i;
        
        pageBtn.addEventListener('click', function() {
          videoCurrentPage = i;
          renderVideos();
        });
        
        videoPaginationContainer.appendChild(pageBtn);
      }
      
      // 下一頁按鈕
      const nextBtn = document.createElement('button');
      nextBtn.className = `page-btn ${videoCurrentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.textContent = '下一頁';
      nextBtn.disabled = videoCurrentPage === totalPages;
      nextBtn.addEventListener('click', function() {
        if (videoCurrentPage < totalPages) {
          videoCurrentPage++;
          renderVideos();
        }
      });
      videoPaginationContainer.appendChild(nextBtn);
    }
    
    /**
     * 刪除文章
     */
    async function deleteArticle(articleUrl, password) {
      try {
        // 驗證管理員密碼
        if (password !== ADMIN_PASSWORD) {
          throw new Error('管理員密碼無效');
        }
        
        // 獲取文件名
        const filename = articleUrl.split('/').pop();
        const filePath = `blog/${filename}`;
        
        // 確認用戶真的要刪除
        showMessage(`您將刪除文章: ${filePath}`, 'info');
        
        // 模擬刪除成功
        setTimeout(() => {
          // 從本地數據中移除文章
          if (articleData && articleData.posts) {
            const postIndex = articleData.posts.findIndex(post => post.url === articleUrl);
            if (postIndex !== -1) {
              articleData.posts.splice(postIndex, 1);
              articleData.pagination.total_posts = articleData.posts.length;
              articleData.pagination.total_pages = Math.max(1, Math.ceil(articleData.posts.length / articleData.pagination.items_per_page));
              
              // 重新渲染文章列表
              renderArticles();
              
              // 顯示成功訊息
              showMessage('文章刪除操作已執行，請注意實際文件可能需要手動在GitHub中刪除', 'success');
            }
          }
        }, 1000);
      } catch (error) {
        console.error('刪除文章時出錯:', error);
        showMessage(`刪除失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 刪除影片
     */
    async function deleteVideo(videoIndex, password) {
      try {
        // 驗證管理員密碼
        if (password !== ADMIN_PASSWORD) {
          throw new Error('管理員密碼無效');
        }
        
        // 確認影片數據存在
        if (!videoData || !videoData.videos || !videoData.videos[videoIndex]) {
          throw new Error('找不到要刪除的影片');
        }
        
        // 從videoData中刪除選定的影片
        const updatedVideoData = JSON.parse(JSON.stringify(videoData)); // 深拷貝
        const deletedVideo = updatedVideoData.videos.splice(videoIndex, 1)[0];
        
        // 更新分頁信息
        updatedVideoData.pagination.total = updatedVideoData.videos.length;
        updatedVideoData.pagination.totalPages = Math.ceil(updatedVideoData.videos.length / updatedVideoData.pagination.itemsPerPage);
        
        // 顯示確認信息
        showMessage(`正在刪除影片: ${deletedVideo.title}`, 'info');
        
        // 模擬刪除成功
        setTimeout(() => {
          // 更新本地數據
          videoData = updatedVideoData;
          
          // 重新渲染影片列表
          renderVideos();
          
          // 顯示成功訊息
          showMessage('影片已成功刪除！請注意實際數據可能需要手動在GitHub中更新', 'success');
        }, 1000);
      } catch (error) {
        console.error('刪除影片時出錯:', error);
        showMessage(`刪除失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 上傳 Word 文檔
     */
    async function uploadWordDocument(password) {
      try {
        // 驗證管理員密碼
        if (password !== ADMIN_PASSWORD) {
          throw new Error('管理員密碼無效');
        }
        
        if (!fileToUpload) {
          throw new Error('請選擇文件');
        }
        
        // 檢查文件名格式
        if (!fileToUpload.name.match(/^\d{4}-\d{2}-\d{2}-.+\.docx$/)) {
          throw new Error('文件名格式不正確，應為: YYYY-MM-DD-文章標題.docx');
        }
        
        // 顯示上傳中信息
        showMessage(`正在上傳文件: ${fileToUpload.name}`, 'info');
        
        // 模擬上傳成功
        setTimeout(() => {
          // 顯示成功訊息
          showMessage('文件上傳成功！系統將在幾分鐘內處理並生成HTML文章。', 'success');
          
          // 清空上傳表單
          document.getElementById('word-file').value = '';
          fileToUpload = null;
        }, 1500);
      } catch (error) {
        console.error('上傳文章時出錯:', error);
        showMessage(`上傳失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 新增影片
     */
    async function addNewVideo(password) {
      try {
        // 驗證管理員密碼
        if (password !== ADMIN_PASSWORD) {
          throw new Error('管理員密碼無效');
        }
        
        if (!videoToAdd) {
          throw new Error('影片數據無效');
        }
        
        // 顯示處理中信息
        showMessage(`正在新增影片: ${videoToAdd.title}`, 'info');
        
        // 模擬處理成功
        setTimeout(() => {
          // 添加新影片到videoData
          const updatedVideoData = JSON.parse(JSON.stringify(videoData)); // 深拷貝
          updatedVideoData.videos.unshift(videoToAdd); // 添加到開頭
          
          // 更新分頁信息
          updatedVideoData.pagination.total = updatedVideoData.videos.length;
          updatedVideoData.pagination.totalPages = Math.ceil(updatedVideoData.videos.length / updatedVideoData.pagination.itemsPerPage);
          
          // 更新本地數據
          videoData = updatedVideoData;
          
          // 重置表單
          videoForm.reset();
          videoToAdd = null;
          
          // 重新渲染影片列表
          renderVideos();
          
          // 顯示成功訊息
          showMessage('影片新增成功！請注意實際數據可能需要手動在GitHub中更新', 'success');
        }, 1000);
      } catch (error) {
        console.error('新增影片時出錯:', error);
        showMessage(`新增失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 掃描HTML文件並更新JSON
     */
    async function scanHtmlFiles() {
      try {
        // 先驗證管理員密碼
        const password = prompt('請輸入管理員密碼以執行掃描操作：');
        
        // 驗證密碼
        if (password !== ADMIN_PASSWORD) {
          showMessage('密碼錯誤，無法執行掃描操作', 'error');
          return;
        }
        
        showMessage('正在掃描HTML文件並更新JSON...', 'info');
        
        // 模擬掃描過程
        setTimeout(() => {
          showMessage('掃描完成！HTML文章已成功更新到JSON文件。', 'success');
          
          // 重新加載文章列表
          loadArticles();
        }, 2000);
      } catch (error) {
        console.error('掃描HTML文件時出錯:', error);
        showMessage(`掃描失敗: ${error.message}`, 'error');
      }
    }
    
    /**
     * 顯示訊息
     */
    function showMessage(message, type = 'success') {
      messageContainer.innerHTML = `
        <div class="message ${type}">
          ${message}
        </div>
      `;
      
      // 5秒後自動隱藏訊息
      setTimeout(() => {
        messageContainer.innerHTML = '';
      }, 5000);
    }
    
    /**
     * 打開確認刪除文章彈窗
     */
    function openDeleteModal() {
      deleteModal.style.display = 'flex';
      adminPasswordInput.value = ''; // 清空密碼輸入
      adminPasswordInput.focus(); // 聚焦到密碼輸入框
    }
    
    /**
     * 關閉確認刪除文章彈窗
     */
    function closeDeleteModal() {
      deleteModal.style.display = 'none';
    }
    
    /**
     * 打開確認刪除影片彈窗
     */
    function openDeleteVideoModal() {
      deleteVideoModal.style.display = 'flex';
      videoAdminPasswordInput.value = ''; // 清空密碼輸入
      videoAdminPasswordInput.focus(); // 聚焦到密碼輸入框
    }
    
    /**
     * 關閉確認刪除影片彈窗
     */
    function closeDeleteVideoModal() {
      deleteVideoModal.style.display = 'none';
    }
    
    /**
     * 打開上傳文章彈窗
     */
    function openUploadModal() {
      uploadModal.style.display = 'flex';
      uploadPasswordInput.value = ''; // 清空密碼輸入
      uploadPasswordInput.focus(); // 聚焦到密碼輸入框
    }
    
    /**
     * 關閉上傳文章彈窗
     */
    function closeUploadModal() {
      uploadModal.style.display = 'none';
    }
    
    /**
     * 打開新增影片彈窗
     */
    function openAddVideoModal() {
      addVideoModal.style.display = 'flex';
      addVideoPasswordInput.value = ''; // 清空密碼輸入
      addVideoPasswordInput.focus(); // 聚焦到密碼輸入框
    }
    
    /**
     * 關閉新增影片彈窗
     */
    function closeAddVideoModal() {
      addVideoModal.style.display = 'none';
    }
  });
</script>
<script src="/assets/js/navbar.js"></script><script src="/assets/js/navbar-loader.js"></script>
</body>
</html>