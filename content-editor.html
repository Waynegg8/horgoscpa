<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>內容管理 - 霍爾果斯會計師事務所</title>
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32x32.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="assets/css/internal-system.css">
    <style>
        .content-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .content-tab-btn {
            padding: 12px 24px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .content-tab-btn:hover {
            background: var(--light-bg);
        }

        .content-tab-btn.active {
            background: linear-gradient(135deg, var(--primary-color), #5a9ee5);
            color: white;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
    </style>
</head>
<body>
    <nav class="internal-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <span class="logo-text">霍爾果斯 CPA</span>
                <span class="logo-sub">內部管理系統</span>
            </div>
            <button class="mobile-toggle" id="mobileToggle">
                <span class="material-symbols-outlined">menu</span>
            </button>
            <div class="nav-menu" id="navMenu">
                <a href="timesheet.html" class="nav-item">
                    <span class="material-symbols-outlined">schedule</span>
                    <span>工時系統</span>
                </a>
                <a href="reports.html" class="nav-item">
                    <span class="material-symbols-outlined">analytics</span>
                    <span>報表中心</span>
                </a>
                <a href="sop.html" class="nav-item">
                    <span class="material-symbols-outlined">description</span>
                    <span>SOP 管理</span>
                </a>
                <a href="projects.html" class="nav-item">
                    <span class="material-symbols-outlined">account_tree</span>
                    <span>專案管理</span>
                </a>
                <a href="content-editor.html" class="nav-item active">
                    <span class="material-symbols-outlined">article</span>
                    <span>內容管理</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <span class="material-symbols-outlined">settings</span>
                    <span>系統設定</span>
                </a>
            </div>
            <div class="nav-user">
                <span class="user-name" id="userName">載入中...</span>
                <span class="user-role" id="userRole">...</span>
                <button class="logout-btn" id="logoutBtn">
                    <span class="material-symbols-outlined">logout</span>
                    登出
                </button>
            </div>
        </div>
    </nav>

    <main class="internal-main">
        <div class="internal-container">
            <div class="content-tabs">
                <button class="content-tab-btn active" onclick="switchContentTab('posts')">
                    <span class="material-symbols-outlined">article</span>
                    文章管理
                </button>
                <button class="content-tab-btn" onclick="switchContentTab('resources')">
                    <span class="material-symbols-outlined">folder</span>
                    資源管理
                </button>
                <button class="content-tab-btn" onclick="switchContentTab('media')">
                    <span class="material-symbols-outlined">photo_library</span>
                    媒體庫
                </button>
            </div>

            <!-- 文章管理 -->
            <div id="posts-section" class="content-section active">
                <!-- 文章列表視圖 -->
                <div id="posts-list-view">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>文章管理</h2>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary" id="selectAllBtn" onclick="toggleSelectAll()">全選</button>
                            <button class="btn btn-primary" onclick="showPostEditor(null)">
                                <span class="material-symbols-outlined">add</span>
                                新增文章
                            </button>
                        </div>
                    </div>
                    
                    <div class="search-box" style="margin-bottom: 20px;">
                        <input type="text" id="postSearch" placeholder="搜尋文章標題..." onkeyup="filterPosts()">
                        <span class="material-symbols-outlined search-icon">search</span>
                    </div>
                    
                    <div id="posts-list">
                        <div class="loading"><div class="loading-spinner"></div> 載入中...</div>
                    </div>
                </div>
                
                <!-- 文章編輯器視圖 -->
                <div id="post-editor-view" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div>
                            <h2 id="post-editor-title">新增文章</h2>
                            <span id="autoSaveIndicator" style="font-size: 13px; color: var(--text-secondary);"></span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary" onclick="togglePreview()">
                                <span class="material-symbols-outlined">visibility</span>
                                預覽
                            </button>
                            <button class="btn btn-secondary" onclick="closePostEditor()">
                                <span class="material-symbols-outlined">close</span>
                                返回列表
                            </button>
                        </div>
                    </div>
                    
                    <div class="editor-container">
                        <input type="hidden" id="postId">
                        
                        <div class="form-group">
                            <label>文章標題 *</label>
                            <input type="text" id="postTitle" placeholder="輸入文章標題..." required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>URL 代稱（Slug）*</label>
                                <input type="text" id="postSlug" placeholder="article-url-slug" required>
                                <small>將用於文章網址，只能包含小寫字母、數字和連字號</small>
                            </div>
                            <div class="form-group">
                                <label>分類</label>
                                <input type="text" id="postCategory" placeholder="例：稅務、會計、創業">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>摘要</label>
                            <textarea id="postSummary" rows="2" placeholder="簡短描述文章內容..."></textarea>
                        </div>
                        
                            <div class="form-group">
                                <label>內容 * (支援 Markdown)</label>
                                <div style="display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('**', '**', '粗體文字')">
                                        <strong>B</strong> 粗體
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('*', '*', '斜體文字')">
                                        <em>I</em> 斜體
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('## ', '', '標題')">
                                        H2 標題
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('[', '](url)', '連結文字')">
                                        🔗 連結
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('- ', '', '列表項目')">
                                        • 列表
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('![', '](url)', '圖片說明')">
                                        🖼️ 圖片
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="insertMarkdown('\n```\n', '\n```\n', '程式碼')">
                                        💻 程式碼
                                    </button>
                                </div>
                                <textarea id="postContent" rows="15" placeholder="使用 Markdown 格式撰寫文章內容..." style="font-family: 'Consolas', 'Monaco', 'Courier New', monospace;"></textarea>
                                <div id="markdownPreview" style="display: none; border: 2px solid var(--border-color); border-radius: 8px; padding: 20px; background: white; min-height: 400px; max-height: 600px; overflow-y: auto;"></div>
                            </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>SEO 標題</label>
                                <input type="text" id="postMetaTitle" placeholder="搜尋引擎顯示的標題">
                            </div>
                            <div class="form-group">
                                <label>SEO 描述</label>
                                <input type="text" id="postMetaDescription" placeholder="搜尋引擎顯示的描述">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>狀態</label>
                                <select id="postStatus">
                                    <option value="draft">草稿</option>
                                    <option value="published">已發布</option>
                                    <option value="archived">已封存</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>發布時間</label>
                                <input type="datetime-local" id="postPublishedAt">
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button class="btn btn-primary" onclick="savePost()">
                                <span class="material-symbols-outlined">save</span>
                                儲存文章
                            </button>
                            <button class="btn btn-secondary" onclick="closePostEditor()">
                                取消
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 資源管理 -->
            <div id="resources-section" class="content-section">
                <div style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center;">
                    <span class="material-symbols-outlined" style="font-size: 80px; opacity: 0.3; color: var(--primary-color);">folder</span>
                    <h2 style="margin: 20px 0 10px;">資源管理系統</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        資源管理功能已整合到資料庫<br>
                        可透過 API 端點進行管理
                    </p>
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; text-align: left; max-width: 600px; margin: 0 auto;">
                        <strong>可用 API：</strong><br>
                        <code style="display: block; margin: 5px 0;">GET /api/public/resources</code>
                        <code style="display: block; margin: 5px 0;">前台資源頁面已就緒</code>
                    </div>
                </div>
            </div>

            <!-- 媒體庫 -->
            <div id="media-section" class="content-section">
                <div style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center;">
                    <span class="material-symbols-outlined" style="font-size: 80px; opacity: 0.3; color: var(--primary-color);">photo_library</span>
                    <h2 style="margin: 20px 0 10px;">媒體庫</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        統一媒體管理系統<br>
                        已整合到 SOP 編輯器（圖片上傳）
                    </p>
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; text-align: left; max-width: 600px; margin: 0 auto;">
                        <strong>功能：</strong><br>
                        • 圖片上傳（5MB 限制）<br>
                        • R2 儲存整合<br>
                        • 資料庫記錄追蹤<br>
                        • 已在 SOP 編輯器中使用
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="internal-footer">
        &copy; 2025 霍爾果斯會計師事務所 內部管理系統
    </footer>

    <script src="assets/js/content-management.js"></script>
</body>
</html>

