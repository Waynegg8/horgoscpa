{
  "version": 3,
  "sources": ["../../../src/index.js", "../../../../../../../AppData/Local/npm-cache/_npx/d77349f55c2be1c0/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../../../../AppData/Local/npm-cache/_npx/d77349f55c2be1c0/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-baIFTX/middleware-insertion-facade.js", "../../../../../../../AppData/Local/npm-cache/_npx/d77349f55c2be1c0/node_modules/wrangler/templates/middleware/common.ts", "../bundle-baIFTX/middleware-loader.entry.ts"],
  "sourceRoot": "C:\\Users\\miama\\Desktop\\horgoscpa\\cloudflare\\worker-router\\.wrangler\\tmp\\dev-Qc8CuR",
  "sourcesContent": ["// \u5DE5\u5177\uFF1AJSON \u56DE\u61C9\uFF08\u7B26\u5408 Envelope\uFF09\r\nfunction jsonResponse(status, body, extraHeaders = {}) {\r\n\treturn new Response(JSON.stringify(body), {\r\n\t\tstatus,\r\n\t\theaders: {\r\n\t\t\t\"Content-Type\": \"application/json; charset=utf-8\",\r\n\t\t\t...extraHeaders,\r\n\t\t},\r\n\t});\r\n}\r\n\r\n// \u5DE5\u5177\uFF1A\u751F\u6210 Request Id\uFF08\u7C21\u6613\uFF09\r\nfunction generateRequestId() {\r\n\tconst random = crypto.getRandomValues(new Uint8Array(8));\r\n\treturn (\r\n\t\t\"req_\" + Array.from(random).map((b) => b.toString(16).padStart(2, \"0\")).join(\"\")\r\n\t);\r\n}\r\n\r\n// \u5DE5\u5177\uFF1APBKDF2-SHA256 \u9A57\u8B49\uFF08\u5132\u5B58\u683C\u5F0F\uFF1Apbkdf2$<iterations>$<saltBase64>$<hashBase64>\uFF09\r\nasync function verifyPasswordPBKDF2(password, stored) {\r\n\tif (!stored || typeof stored !== \"string\") return false;\r\n\tconst parts = stored.split(\"$\");\r\n\tif (parts.length !== 4 || parts[0] !== \"pbkdf2\") return false;\r\n\tconst iterations = parseInt(parts[1], 10);\r\n\t// Cloudflare Workers \u9650\u5236\uFF1A\u8FED\u4EE3\u4E0A\u9650\u8F03\u4F4E\uFF1B\u653E\u5BEC\u4E0B\u9650\u81F3 100k\r\n\tif (!Number.isFinite(iterations) || iterations < 100000) return false;\r\n\tconst salt = Uint8Array.from(atob(parts[2]), (c) => c.charCodeAt(0));\r\n\tconst expected = Uint8Array.from(atob(parts[3]), (c) => c.charCodeAt(0));\r\n\r\n\tconst enc = new TextEncoder();\r\n\tconst keyMaterial = await crypto.subtle.importKey(\r\n\t\t\"raw\",\r\n\t\tenc.encode(password),\r\n\t\t{ name: \"PBKDF2\" },\r\n\t\tfalse,\r\n\t\t[\"deriveBits\"]\r\n\t);\r\n\tconst derivedBits = await crypto.subtle.deriveBits(\r\n\t\t{\r\n\t\t\tname: \"PBKDF2\",\r\n\t\t\thash: \"SHA-256\",\r\n\t\t\tsalt,\r\n\t\t\titerations,\r\n\t\t},\r\n\t\tkeyMaterial,\r\n\t\texpected.byteLength * 8\r\n\t);\r\n\tconst derived = new Uint8Array(derivedBits);\r\n\tif (derived.byteLength !== expected.byteLength) return false;\r\n\tlet diff = 0;\r\n\tfor (let i = 0; i < derived.byteLength; i++) diff |= derived[i] ^ expected[i];\r\n\treturn diff === 0;\r\n}\r\n\r\n// \u5DE5\u5177\uFF1A\u96A8\u6A5F Session Id\uFF0832 bytes base64\uFF09\r\nfunction generateSessionId() {\r\n\tconst bytes = crypto.getRandomValues(new Uint8Array(32));\r\n\treturn btoa(String.fromCharCode(...bytes)).replaceAll(\"=\", \"\").replaceAll(\"+\", \"-\").replaceAll(\"/\", \"_\");\r\n}\r\n\r\n// CORS\uFF1A\u5141\u8A31\u7279\u5B9A\u4F86\u6E90\uFF08pages.dev \u8207\u4E3B\u7AD9\uFF09\uFF0C\u56DE\u50B3\u6A19\u982D\r\nfunction getCorsHeadersForRequest(request, env) {\r\n\tconst origin = request.headers.get(\"Origin\") || \"\";\r\n\tif (!origin) return {};\r\n\ttry {\r\n\t\tconst o = new URL(origin);\r\n\t\tconst host = o.hostname || \"\";\r\n\t\tif (host.endsWith(\".pages.dev\") || host.endsWith(\"horgoscpa.com\")) {\r\n\t\t\treturn {\r\n\t\t\t\t\"Access-Control-Allow-Origin\": origin,\r\n\t\t\t\t\"Access-Control-Allow-Credentials\": \"true\",\r\n\t\t\t\t\"Vary\": \"Origin\",\r\n\t\t\t};\r\n\t\t}\r\n\t} catch (_) {}\r\n\treturn {};\r\n}\r\n\r\nfunction corsPreflightResponse(request, env) {\r\n\tconst headers = {\r\n\t\t...getCorsHeadersForRequest(request, env),\r\n\t\t\"Access-Control-Allow-Methods\": \"GET,POST,OPTIONS\",\r\n\t\t\"Access-Control-Allow-Headers\": request.headers.get(\"Access-Control-Request-Headers\") || \"Content-Type, X-Request-Id\",\r\n\t\t\"Access-Control-Max-Age\": \"600\",\r\n\t};\r\n\treturn new Response(null, { status: 204, headers });\r\n}\r\n\r\n// Cookie \u8B80\u53D6\r\nfunction getCookie(request, name) {\r\n\tconst raw = request.headers.get(\"Cookie\") || \"\";\r\n\tconst parts = raw.split(\";\");\r\n\tfor (const p of parts) {\r\n\t\tconst [k, ...v] = p.trim().split(\"=\");\r\n\t\tif (k === name) return v.join(\"=\");\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n// \u53D6\u5F97\u76EE\u524D\u6703\u8A71\u7684\u4F7F\u7528\u8005\uFF08\u82E5\u7121\u6216\u904E\u671F\uFF0C\u56DE null\uFF09\r\nasync function getSessionUser(request, env) {\r\n\tconst cookieName = String(env.SESSION_COOKIE_NAME || \"session\");\r\n\tconst sessionId = getCookie(request, cookieName);\r\n\tif (!sessionId || !env.DATABASE) return null;\r\n\tconst row = await env.DATABASE.prepare(\r\n\t\t\"SELECT s.id as session_id, s.user_id, s.expires_at, u.username, u.name, u.email, u.is_admin FROM sessions s JOIN Users u ON u.user_id = s.user_id WHERE s.id = ? LIMIT 1\"\r\n\t).bind(sessionId).first();\r\n\tif (!row) return null;\r\n\tconst exp = Date.parse(row.expires_at);\r\n\tif (Number.isNaN(exp) || exp <= Date.now()) return null;\r\n\treturn row;\r\n}\r\n\r\n// \u5DE5\u5177\uFF1APBKDF2-SHA256 \u7522\u751F\u96DC\u6E4A\uFF08\u5132\u5B58\u683C\u5F0F\uFF1Apbkdf2$<iterations>$<saltBase64>$<hashBase64>\uFF09\r\nasync function hashPasswordPBKDF2(password, iterations = 100000, keyLen = 32) {\r\n\tconst salt = crypto.getRandomValues(new Uint8Array(16));\r\n\tconst enc = new TextEncoder();\r\n\tconst keyMaterial = await crypto.subtle.importKey(\r\n\t\t\"raw\",\r\n\t\tenc.encode(password),\r\n\t\t{ name: \"PBKDF2\" },\r\n\t\tfalse,\r\n\t\t[\"deriveBits\"]\r\n\t);\r\n\tconst derivedBits = await crypto.subtle.deriveBits(\r\n\t\t{ name: \"PBKDF2\", hash: \"SHA-256\", salt, iterations },\r\n\t\tkeyMaterial,\r\n\t\tkeyLen * 8\r\n\t);\r\n\tconst derived = new Uint8Array(derivedBits);\r\n\tconst b64 = (u8) => btoa(String.fromCharCode(...u8));\r\n\treturn `pbkdf2${\"$\"}${iterations}${\"$\"}${b64(salt)}${\"$\"}${b64(derived)}`;\r\n}\r\n\r\nexport default {\r\n\tasync fetch(request, env) {\r\n\t\tconst url = new URL(request.url);\r\n\t\tconst path = url.pathname;\r\n\t\tconst method = request.method.toUpperCase();\r\n\t\tconst requestId = request.headers.get(\"X-Request-Id\") || generateRequestId();\r\n\r\n\t\tconst proxy = (host, newPath) => {\r\n\t\t\tconst target = new URL(request.url);\r\n\t\t\ttarget.protocol = \"https:\";\r\n\t\t\ttarget.hostname = host;\r\n\t\t\ttarget.pathname = newPath;\r\n\t\t\treturn fetch(new Request(target.toString(), request));\r\n\t\t};\r\n\r\n\t\t// CORS Preflight\uFF1A\u8655\u7406 /internal/api/* \u7684 OPTIONS\r\n\t\tif (path.startsWith(\"/internal/api/\") && method === \"OPTIONS\") {\r\n\t\t\treturn corsPreflightResponse(request, env);\r\n\t\t}\r\n\r\n\t\t// \u767B\u5165 API\uFF08\u672C Worker \u76F4\u8655\u7406\uFF09\uFF1A/internal/api/v1/auth/login\r\n\t\tif (path === \"/internal/api/v1/auth/login\") {\r\n\t\t\tif (method !== \"POST\") {\r\n\t\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tlet payload;\r\n\t\t\ttry {\r\n\t\t\t\tpayload = await request.json();\r\n\t\t\t} catch (_) {\r\n\t\t\t\treturn jsonResponse(400, { ok: false, code: \"BAD_REQUEST\", message: \"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst username = (payload?.username || \"\").trim().toLowerCase();\r\n\t\t\tconst password = payload?.password || \"\";\r\n\t\t\tconst errors = [];\r\n\t\t\tif (!username) errors.push({ field: \"username\", message: \"\u5FC5\u586B\" });\r\n\t\t\tif (!password) errors.push({ field: \"password\", message: \"\u5FC5\u586B\" });\r\n\t\t\tif (errors.length > 0) {\r\n\t\t\t\treturn jsonResponse(422, { ok: false, code: \"VALIDATION_ERROR\", message: \"\u8F38\u5165\u6709\u8AA4\", errors, meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\r\n\t\t\tif (!env.DATABASE) {\r\n\t\t\t\treturn jsonResponse(500, { ok: false, code: \"INTERNAL_ERROR\", message: \"\u8CC7\u6599\u5EAB\u672A\u7D81\u5B9A\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// \u8B80\u53D6\u4F7F\u7528\u8005\r\n\t\t\t\tconst userRow = await env.DATABASE.prepare(\r\n\t\t\t\t\t\"SELECT user_id, username, password_hash, name, email, is_admin, login_attempts, last_failed_login, is_deleted FROM Users WHERE LOWER(username) = ? LIMIT 1\"\r\n\t\t\t\t).bind(username).first();\r\n\r\n\t\t\t\t// \u907F\u514D\u6D29\u6F0F\u5E33\u865F\u5B58\u5728\u8207\u5426\r\n\t\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\t\tconst unauthorized = () => jsonResponse(401, { ok: false, code: \"UNAUTHORIZED\", message: \"\u5E33\u865F\u6216\u5BC6\u78BC\u932F\u8AA4\", meta: { requestId } }, corsHeaders);\r\n\r\n\t\t\t\tif (!userRow || userRow.is_deleted === 1) {\r\n\t\t\t\t\treturn unauthorized();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// \u9396\u5B9A\u6AA2\u67E5\uFF08\u9023\u7E8C\u5931\u6557 >=5 \u4E14 15 \u5206\u9418\u5167\uFF09\r\n\t\t\t\tconst attempts = Number(userRow.login_attempts || 0);\r\n\t\t\t\tif (attempts >= 5 && userRow.last_failed_login) {\r\n\t\t\t\t\tconst lastFailedAt = Date.parse(userRow.last_failed_login);\r\n\t\t\t\t\tif (!Number.isNaN(lastFailedAt)) {\r\n\t\t\t\t\t\tconst fifteenMinAgo = Date.now() - 15 * 60 * 1000;\r\n\t\t\t\t\t\tif (lastFailedAt > fifteenMinAgo) {\r\n\t\t\t\t\t\t\treturn jsonResponse(401, { ok: false, code: \"ACCOUNT_LOCKED\", message: \"\u5617\u8A66\u904E\u591A\uFF0C\u7A0D\u5F8C\u518D\u8A66\", meta: { requestId } }, corsHeaders);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// \u5BC6\u78BC\u9A57\u8B49\r\n\t\t\t\tconst hash = userRow.password_hash || \"\";\r\n\t\t\t\tconst passOk = await verifyPasswordPBKDF2(password, hash);\r\n\t\t\t\tif (!passOk) {\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"UPDATE Users SET login_attempts = COALESCE(login_attempts,0) + 1, last_failed_login = ? WHERE user_id = ?\"\r\n\t\t\t\t\t).bind(new Date().toISOString(), userRow.user_id).run();\r\n\t\t\t\t\treturn unauthorized();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// \u6210\u529F\uFF1A\u91CD\u7F6E\u5617\u8A66\u6B21\u6578\u3001\u66F4\u65B0 last_login\r\n\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\"UPDATE Users SET login_attempts = 0, last_login = ? WHERE user_id = ?\"\r\n\t\t\t\t).bind(new Date().toISOString(), userRow.user_id).run();\r\n\r\n\t\t\t\t// \u5EFA\u7ACB\u6703\u8A71\r\n\t\t\t\tconst sessionId = generateSessionId();\r\n\t\t\t\tconst ttlSec = parseInt(env.SESSION_TTL_SECONDS || \"2592000\", 10);\r\n\t\t\t\tconst createdAt = new Date();\r\n\t\t\t\tconst expiresAt = new Date(createdAt.getTime() + ttlSec * 1000);\r\n\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\"INSERT INTO sessions (id, user_id, created_at, expires_at, meta_json) VALUES (?, ?, ?, ?, ?)\"\r\n\t\t\t\t).bind(sessionId, String(userRow.user_id), createdAt.toISOString(), expiresAt.toISOString(), JSON.stringify({ ua: request.headers.get(\"User-Agent\") || \"\" })).run();\r\n\r\n\t\t\t\t// \u8A2D\u5B9A Cookie\r\n\t\t\t\tconst cookieName = String(env.SESSION_COOKIE_NAME || \"session\");\r\n\t\t\t\tconst cookie = [\r\n\t\t\t\t\t`${cookieName}=${sessionId}`,\r\n\t\t\t\t\t\"Path=/\",\r\n\t\t\t\t\t\"HttpOnly\",\r\n\t\t\t\t\t\"Secure\",\r\n\t\t\t\t\t\"SameSite=Lax\",\r\n\t\t\t\t\t`Max-Age=${ttlSec}`,\r\n\t\t\t\t].join(\"; \");\r\n\r\n\t\t\t\tconst data = {\r\n\t\t\t\t\tuserId: String(userRow.user_id),\r\n\t\t\t\t\tusername: userRow.username,\r\n\t\t\t\t\tname: userRow.name,\r\n\t\t\t\t\temail: userRow.email,\r\n\t\t\t\t\tisAdmin: userRow.is_admin === 1,\r\n\t\t\t\t};\r\n\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u6210\u529F\", data, meta: { requestId } }, { \"Set-Cookie\": cookie, ...corsHeaders });\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// \u6703\u8A71\u67E5\u8A62\uFF1A/internal/api/v1/auth/me\r\n\t\tif (path === \"/internal/api/v1/auth/me\") {\r\n\t\t\tif (method !== \"GET\") {\r\n\t\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst row = await getSessionUser(request, env);\r\n\t\t\t\tif (!row) {\r\n\t\t\t\t\treturn jsonResponse(401, { ok: false, code: \"UNAUTHORIZED\", message: \"\u672A\u767B\u5165\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t\tconst data = {\r\n\t\t\t\t\tuserId: String(row.user_id),\r\n\t\t\t\t\tusername: row.username,\r\n\t\t\t\t\tname: row.name,\r\n\t\t\t\t\temail: row.email,\r\n\t\t\t\t\tisAdmin: row.is_admin === 1,\r\n\t\t\t\t};\r\n\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u6210\u529F\", data, meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// DEV\uFF1A\u6AA2\u67E5 Cookie \u8207\u6703\u8A71\r\n\t\tif (path === \"/internal/api/v1/admin/dev-debug-cookie\") {\r\n\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\treturn jsonResponse(404, { ok: false, code: \"NOT_FOUND\", message: \"\u4E0D\u5B58\u5728\", meta: { requestId } });\r\n\t\t\t}\r\n\t\t\tconst cookieName = String(env.SESSION_COOKIE_NAME || \"session\");\r\n\t\t\tconst sid = getCookie(request, cookieName);\r\n\t\t\tlet exists = null; let exp = null;\r\n\t\t\tif (sid && env.DATABASE) {\r\n\t\t\t\tconst row = await env.DATABASE.prepare(\"SELECT id, expires_at FROM sessions WHERE id = ? LIMIT 1\").bind(sid).first();\r\n\t\t\t\texists = !!row;\r\n\t\t\t\texp = row?.expires_at || null;\r\n\t\t\t}\r\n\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u6210\u529F\", data: { cookieName, sid, exists, exp }, meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t}\r\n\r\n\t\t// \u5BA2\u6236\u5217\u8868\uFF1A/internal/api/v1/clients\r\n\t\tif (path === \"/internal/api/v1/clients\") {\r\n\t\t\t// \u9700\u8981\u767B\u5165\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok: false, code: \"UNAUTHORIZED\", message: \"\u672A\u767B\u5165\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method === \"GET\") {\r\n\t\t\t\tconst params = url.searchParams;\r\n\t\t\t\tconst page = Math.max(1, parseInt(params.get(\"page\") || \"1\", 10));\r\n\t\t\t\tconst perPage = Math.min(100, Math.max(1, parseInt(params.get(\"perPage\") || \"50\", 10)));\r\n\t\t\t\tconst offset = (page - 1) * perPage;\r\n\t\t\t\tconst companyName = (params.get(\"company_name\") || params.get(\"q\") || \"\").trim();\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst where = [\"c.is_deleted = 0\"];\r\n\t\t\t\t\tconst binds = [];\r\n\t\t\t\t\tif (companyName) {\r\n\t\t\t\t\t\twhere.push(\"c.company_name LIKE ?\");\r\n\t\t\t\t\t\tbinds.push(`%${companyName}%`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst whereSql = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\r\n\t\t\t\t\tconst countRow = await env.DATABASE.prepare(\r\n\t\t\t\t\t\t`SELECT COUNT(1) as total FROM Clients c ${whereSql}`\r\n\t\t\t\t\t).bind(...binds).first();\r\n\t\t\t\t\tconst total = Number(countRow?.total || 0);\r\n\t\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t\t`SELECT c.client_id, c.company_name, c.tax_registration_number, c.phone, c.email, c.created_at, \r\n\t\t\t\t\t\t        u.name as assignee_name,\r\n\t\t\t\t\t\t        GROUP_CONCAT(t.tag_name, ',') as tags\r\n\t\t\t\t\t\t FROM Clients c\r\n\t\t\t\t\t\t LEFT JOIN Users u ON u.user_id = c.assignee_user_id\r\n\t\t\t\t\t\t LEFT JOIN ClientTagAssignments a ON a.client_id = c.client_id\r\n\t\t\t\t\t\t LEFT JOIN CustomerTags t ON t.tag_id = a.tag_id\r\n\t\t\t\t\t\t ${whereSql}\r\n\t\t\t\t\t\t GROUP BY c.client_id\r\n\t\t\t\t\t\t ORDER BY c.created_at DESC\r\n\t\t\t\t\t\t LIMIT ? OFFSET ?`\r\n\t\t\t\t\t).bind(...binds, perPage, offset).all();\r\n\t\t\t\t\tconst data = (rows?.results || []).map((r) => ({\r\n\t\t\t\t\t\tclientId: r.client_id,\r\n\t\t\t\t\t\tcompanyName: r.company_name,\r\n\t\t\t\t\t\ttaxId: r.tax_registration_number,\r\n\t\t\t\t\t\tassigneeName: r.assignee_name || \"\",\r\n\t\t\t\t\t\ttags: (r.tags ? String(r.tags).split(\",\").filter(Boolean) : []),\r\n\t\t\t\t\t\tphone: r.phone || \"\",\r\n\t\t\t\t\t\temail: r.email || \"\",\r\n\t\t\t\t\t\tcreatedAt: r.created_at,\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tconst meta = { requestId, page, perPage, total, hasNext: offset + perPage < total };\r\n\t\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u6210\u529F\", data, meta }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (method === \"POST\") {\r\n\t\t\t\tlet body;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tbody = await request.json();\r\n\t\t\t\t} catch (_) {\r\n\t\t\t\t\treturn jsonResponse(400, { ok: false, code: \"BAD_REQUEST\", message: \"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta: { requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t\tconst errors = [];\r\n\t\t\t\tconst clientId = String(body?.client_id || \"\").trim();\r\n\t\t\t\tconst companyName = String(body?.company_name || \"\").trim();\r\n\t\t\t\tconst assigneeUserId = Number(body?.assignee_user_id || 0);\r\n\t\t\t\tconst phone = (body?.phone || \"\").trim();\r\n\t\t\t\tconst email = (body?.email || \"\").trim();\r\n\t\t\t\tconst clientNotes = (body?.client_notes || \"\").trim();\r\n\t\t\t\tconst paymentNotes = (body?.payment_notes || \"\").trim();\r\n\t\t\t\tconst tagIds = Array.isArray(body?.tag_ids) ? body.tag_ids.map((x) => Number(x)).filter((n) => Number.isFinite(n)) : [];\r\n\r\n\t\t\t\tif (!/^\\d{8}$/.test(clientId)) errors.push({ field: \"client_id\", message: \"\u5FC5\u586B\u4E14\u9808\u70BA8\u4F4D\u6578\u5B57\" });\r\n\t\t\t\tif (companyName.length < 1 || companyName.length > 100) errors.push({ field: \"company_name\", message: \"\u9577\u5EA6\u9700 1\u2013100\" });\r\n\t\t\t\tif (!Number.isInteger(assigneeUserId) || assigneeUserId <= 0) errors.push({ field: \"assignee_user_id\", message: \"\u5FC5\u586B\" });\r\n\t\t\t\tif (email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) errors.push({ field: \"email\", message: \"Email \u683C\u5F0F\u932F\u8AA4\" });\r\n\t\t\t\tif (phone && !/^[-+()\\s0-9]{6,}$/.test(phone)) errors.push({ field: \"phone\", message: \"\u96FB\u8A71\u683C\u5F0F\u932F\u8AA4\" });\r\n\t\t\t\tif (errors.length) {\r\n\t\t\t\t\treturn jsonResponse(422, { ok: false, code: \"VALIDATION_ERROR\", message: \"\u8F38\u5165\u6709\u8AA4\", errors, meta: { requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// \u6AA2\u67E5\u552F\u4E00/\u5B58\u5728\r\n\t\t\t\t\tconst dup = await env.DATABASE.prepare(\"SELECT 1 FROM Clients WHERE client_id = ? AND is_deleted = 0 LIMIT 1\").bind(clientId).first();\r\n\t\t\t\t\tif (dup) {\r\n\t\t\t\t\t\treturn jsonResponse(409, { ok: false, code: \"CONFLICT\", message: \"\u5BA2\u6236\u5DF2\u5B58\u5728\", meta: { requestId } }, corsHeaders);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst assExist = await env.DATABASE.prepare(\"SELECT 1 FROM Users WHERE user_id = ? AND is_deleted = 0 LIMIT 1\").bind(assigneeUserId).first();\r\n\t\t\t\t\tif (!assExist) {\r\n\t\t\t\t\t\treturn jsonResponse(422, { ok: false, code: \"VALIDATION_ERROR\", message: \"\u8CA0\u8CAC\u4EBA\u4E0D\u5B58\u5728\", errors: [{ field: \"assignee_user_id\", message: \"\u4E0D\u5B58\u5728\" }], meta: { requestId } }, corsHeaders);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (tagIds.length > 0) {\r\n\t\t\t\t\t\tconst placeholders = tagIds.map(() => \"?\").join(\",\");\r\n\t\t\t\t\t\tconst row = await env.DATABASE.prepare(`SELECT COUNT(1) as cnt FROM CustomerTags WHERE tag_id IN (${placeholders})`).bind(...tagIds).first();\r\n\t\t\t\t\t\tif (Number(row?.cnt || 0) !== tagIds.length) {\r\n\t\t\t\t\t\t\treturn jsonResponse(422, { ok: false, code: \"VALIDATION_ERROR\", message: \"\u6A19\u7C64\u4E0D\u5B58\u5728\", meta: { requestId } }, corsHeaders);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst now = new Date().toISOString();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO Clients (client_id, company_name, assignee_user_id, phone, email, client_notes, payment_notes, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\"\r\n\t\t\t\t\t).bind(clientId, companyName, assigneeUserId, phone, email, clientNotes, paymentNotes, now, now).run();\r\n\t\t\t\t\tfor (const tagId of tagIds) {\r\n\t\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT OR IGNORE INTO ClientTagAssignments (client_id, tag_id, assigned_at) VALUES (?, ?, ?)\").bind(clientId, tagId, now).run();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst data = { clientId, companyName, assigneeUserId, phone, email, clientNotes, paymentNotes, tags: tagIds };\r\n\t\t\t\t\treturn jsonResponse(201, { ok: true, code: \"CREATED\", message: \"\u5DF2\u5EFA\u7ACB\", data, meta: { requestId } }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } }, corsHeaders);\r\n\t\t}\r\n\r\n\t\t// \u4EFB\u52D9\u5217\u8868\uFF1A/internal/api/v1/tasks\r\n\t\tif (path === \"/internal/api/v1/tasks\") {\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok: false, code: \"UNAUTHORIZED\", message: \"\u672A\u767B\u5165\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method === \"GET\") {\r\n\t\t\t\ttry {\r\n\t\t\t\tconst params = url.searchParams;\r\n\t\t\t\tconst page = Math.max(1, parseInt(params.get(\"page\") || \"1\", 10));\r\n\t\t\t\tconst perPage = Math.min(100, Math.max(1, parseInt(params.get(\"perPage\") || \"20\", 10)));\r\n\t\t\t\tconst offset = (page - 1) * perPage;\r\n\t\t\t\tconst q = (params.get(\"q\") || \"\").trim();\r\n\t\t\t\tconst status = (params.get(\"status\") || \"\").trim();\r\n\t\t\t\tconst due = (params.get(\"due\") || \"\").trim();\r\n\t\t\t\tconst where = [\"t.is_deleted = 0\"];\r\n\t\t\t\tconst binds = [];\r\n\t\t\t\tif (!me.is_admin) {\r\n\t\t\t\t\twhere.push(\"t.assignee_user_id = ?\");\r\n\t\t\t\t\tbinds.push(String(me.user_id));\r\n\t\t\t\t}\r\n\t\t\t\tif (q) {\r\n\t\t\t\t\twhere.push(\"(t.task_name LIKE ? OR c.company_name LIKE ?)\");\r\n\t\t\t\t\tbinds.push(`%${q}%`, `%${q}%`);\r\n\t\t\t\t}\r\n\t\t\t\tif (status && [\"pending\",\"in_progress\",\"completed\",\"cancelled\"].includes(status)) {\r\n\t\t\t\t\twhere.push(\"t.status = ?\");\r\n\t\t\t\t\tbinds.push(status);\r\n\t\t\t\t}\r\n\t\t\t\tif (due === \"overdue\") {\r\n\t\t\t\t\twhere.push(\"date(t.due_date) < date('now') AND t.status != 'completed'\");\r\n\t\t\t\t}\r\n\t\t\t\tif (due === \"soon\") {\r\n\t\t\t\t\twhere.push(\"date(t.due_date) BETWEEN date('now') AND date('now','+3 days')\");\r\n\t\t\t\t}\r\n\t\t\t\tconst whereSql = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\r\n\t\t\t\tconst countRow = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT COUNT(1) as total\r\n\t\t\t\t\t FROM ActiveTasks t\r\n\t\t\t\t\t LEFT JOIN ClientServices cs ON cs.client_service_id = t.client_service_id\r\n\t\t\t\t\t LEFT JOIN Clients c ON c.client_id = cs.client_id\r\n\t\t\t\t\t ${whereSql}`\r\n\t\t\t\t).bind(...binds).first();\r\n\t\t\t\tconst total = Number(countRow?.total || 0);\r\n\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT t.task_id, t.task_name, t.due_date, t.status, t.assignee_user_id,\r\n\t\t\t\t\t        c.company_name AS client_name,\r\n\t\t\t\t\t        (SELECT COUNT(1) FROM ActiveTaskStages s WHERE s.task_id = t.task_id) AS total_stages,\r\n\t\t\t\t\t        (SELECT COUNT(1) FROM ActiveTaskStages s WHERE s.task_id = t.task_id AND s.status = 'completed') AS completed_stages,\r\n\t\t\t\t\t        (CASE WHEN t.related_sop_id IS NOT NULL OR t.client_specific_sop_id IS NOT NULL THEN 1 ELSE 0 END) AS has_sop,\r\n\t\t\t\t\t        u.name AS assignee_name\r\n\t\t\t\t\t FROM ActiveTasks t\r\n\t\t\t\t\t LEFT JOIN ClientServices cs ON cs.client_service_id = t.client_service_id\r\n\t\t\t\t\t LEFT JOIN Clients c ON c.client_id = cs.client_id\r\n\t\t\t\t\t LEFT JOIN Users u ON u.user_id = t.assignee_user_id\r\n\t\t\t\t\t ${whereSql}\r\n\t\t\t\t\t ORDER BY date(t.due_date) ASC NULLS LAST, t.task_id DESC\r\n\t\t\t\t\t LIMIT ? OFFSET ?`\r\n\t\t\t\t).bind(...binds, perPage, offset).all();\r\n\t\t\t\tconst data = (rows?.results || []).map((r) => ({\r\n\t\t\t\t\ttaskId: String(r.task_id),\r\n\t\t\t\t\ttaskName: r.task_name,\r\n\t\t\t\t\tclientName: r.client_name || \"\",\r\n\t\t\t\t\tassigneeName: r.assignee_name || \"\",\r\n\t\t\t\t\tprogress: { completed: Number(r.completed_stages || 0), total: Number(r.total_stages || 0) },\r\n\t\t\t\t\tdueDate: r.due_date || null,\r\n\t\t\t\t\tstatus: r.status,\r\n\t\t\t\t\thasSop: Number(r.has_sop || 0) === 1,\r\n\t\t\t\t}));\r\n\t\t\t\tconst meta = { requestId, page, perPage, total, hasNext: offset + perPage < total };\r\n\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u6210\u529F\", data, meta }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (method === \"POST\") {\r\n\t\t\t\tlet body;\r\n\t\t\t\ttry { body = await request.json(); } catch (_) {\r\n\t\t\t\t\treturn jsonResponse(400, { ok:false, code:\"BAD_REQUEST\", message:\"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t\tconst clientServiceId = Number(body?.client_service_id || 0);\r\n\t\t\t\tconst taskName = String(body?.task_name || \"\").trim();\r\n\t\t\t\tconst dueDate = body?.due_date ? String(body.due_date) : null;\r\n\t\t\t\tconst assigneeUserId = body?.assignee_user_id ? Number(body.assignee_user_id) : null;\r\n\t\t\t\tconst stageNames = Array.isArray(body?.stage_names) ? body.stage_names.filter(s => typeof s === 'string' && s.trim().length > 0).map(s => s.trim()) : [];\r\n\t\t\t\tconst errors = [];\r\n\t\t\t\tif (!Number.isInteger(clientServiceId) || clientServiceId <= 0) errors.push({ field:\"client_service_id\", message:\"\u5FC5\u586B\" });\r\n\t\t\t\tif (taskName.length < 1 || taskName.length > 200) errors.push({ field:\"task_name\", message:\"\u9577\u5EA6\u9700 1\u2013200\" });\r\n\t\t\t\tif (dueDate && !/^\\d{4}-\\d{2}-\\d{2}$/.test(dueDate)) errors.push({ field:\"due_date\", message:\"\u65E5\u671F\u683C\u5F0F YYYY-MM-DD\" });\r\n\t\t\t\tif (assigneeUserId !== null && (!Number.isInteger(assigneeUserId) || assigneeUserId <= 0)) errors.push({ field:\"assignee_user_id\", message:\"\u683C\u5F0F\u932F\u8AA4\" });\r\n\t\t\t\tif (errors.length) return jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u8F38\u5165\u6709\u8AA4\", errors, meta:{ requestId } }, corsHeaders);\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst cs = await env.DATABASE.prepare(\"SELECT client_service_id FROM ClientServices WHERE client_service_id = ? LIMIT 1\").bind(clientServiceId).first();\r\n\t\t\t\t\tif (!cs) return jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u5BA2\u6236\u670D\u52D9\u4E0D\u5B58\u5728\", errors:[{ field:\"client_service_id\", message:\"\u4E0D\u5B58\u5728\" }], meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t\tif (assigneeUserId) {\r\n\t\t\t\t\t\tconst u = await env.DATABASE.prepare(\"SELECT 1 FROM Users WHERE user_id = ? AND is_deleted = 0 LIMIT 1\").bind(assigneeUserId).first();\r\n\t\t\t\t\t\tif (!u) return jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u8CA0\u8CAC\u4EBA\u4E0D\u5B58\u5728\", errors:[{ field:\"assignee_user_id\", message:\"\u4E0D\u5B58\u5728\" }], meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst now = new Date().toISOString();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT INTO ActiveTasks (client_service_id, template_id, task_name, start_date, due_date, status, assignee_user_id, created_at) VALUES (?, NULL, ?, NULL, ?, 'pending', ?, ?)\").bind(clientServiceId, taskName, dueDate, assigneeUserId, now).run();\r\n\t\t\t\t\tconst idRow = await env.DATABASE.prepare(\"SELECT last_insert_rowid() AS id\").first();\r\n\t\t\t\t\tconst taskId = String(idRow?.id);\r\n\t\t\t\t\tif (stageNames.length > 0) {\r\n\t\t\t\t\t\tlet order = 1;\r\n\t\t\t\t\t\tfor (const s of stageNames) {\r\n\t\t\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT INTO ActiveTaskStages (task_id, stage_name, stage_order, status) VALUES (?, ?, ?, 'pending')\").bind(taskId, s, order++).run();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn jsonResponse(201, { ok:true, code:\"CREATED\", message:\"\u5DF2\u5EFA\u7ACB\", data:{ taskId, taskName, clientServiceId, dueDate, assigneeUserId }, meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\tconst body = { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } }, corsHeaders);\r\n\t\t}\r\n\r\n\t\t// \u6536\u64DA\u5217\u8868\uFF1A/internal/api/v1/receipts\r\n\t\tif (path === \"/internal/api/v1/receipts\") {\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok:false, code:\"UNAUTHORIZED\", message:\"\u672A\u767B\u5165\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method !== \"GET\") {\r\n\t\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst params = url.searchParams;\r\n\t\t\t\tconst page = Math.max(1, parseInt(params.get(\"page\") || \"1\", 10));\r\n\t\t\t\tconst perPage = Math.min(100, Math.max(1, parseInt(params.get(\"perPage\") || \"20\", 10)));\r\n\t\t\t\tconst offset = (page - 1) * perPage;\r\n\t\t\t\tconst q = (params.get(\"q\") || \"\").trim();\r\n\t\t\t\tconst status = (params.get(\"status\") || \"\").trim();\r\n\t\t\t\tconst dateFrom = (params.get(\"dateFrom\") || \"\").trim();\r\n\t\t\t\tconst dateTo = (params.get(\"dateTo\") || \"\").trim();\r\n\t\t\t\tconst where = [\"r.is_deleted = 0\"];\r\n\t\t\t\tconst binds = [];\r\n\t\t\t\tif (q) { where.push(\"(r.receipt_id LIKE ? OR c.company_name LIKE ?)\"); binds.push(`%${q}%`, `%${q}%`); }\r\n\t\t\t\tif (status && [\"unpaid\",\"partial\",\"paid\",\"cancelled\"].includes(status)) { where.push(\"r.status = ?\"); binds.push(status); }\r\n\t\t\t\tif (dateFrom) { where.push(\"r.receipt_date >= ?\"); binds.push(dateFrom); }\r\n\t\t\t\tif (dateTo) { where.push(\"r.receipt_date <= ?\"); binds.push(dateTo); }\r\n\t\t\t\tconst whereSql = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\r\n\t\t\t\tconst countRow = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT COUNT(1) AS total FROM Receipts r LEFT JOIN Clients c ON c.client_id = r.client_id ${whereSql}`\r\n\t\t\t\t).bind(...binds).first();\r\n\t\t\t\tconst total = Number(countRow?.total || 0);\r\n\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT r.receipt_id, r.client_id, c.company_name AS client_name, r.total_amount, r.receipt_date, r.due_date, r.status\r\n\t\t\t\t\t FROM Receipts r LEFT JOIN Clients c ON c.client_id = r.client_id\r\n\t\t\t\t\t ${whereSql}\r\n\t\t\t\t\t ORDER BY r.receipt_date DESC, r.receipt_id DESC\r\n\t\t\t\t\t LIMIT ? OFFSET ?`\r\n\t\t\t\t).bind(...binds, perPage, offset).all();\r\n\t\t\t\tconst data = (rows?.results || []).map(r => ({\r\n\t\t\t\t\treceiptId: r.receipt_id,\r\n\t\t\t\t\tclientId: r.client_id,\r\n\t\t\t\t\tclientName: r.client_name || \"\",\r\n\t\t\t\t\ttotalAmount: Number(r.total_amount || 0),\r\n\t\t\t\t\treceiptDate: r.receipt_date,\r\n\t\t\t\t\tdueDate: r.due_date || null,\r\n\t\t\t\t\tstatus: r.status,\r\n\t\t\t\t}));\r\n\t\t\t\tconst meta = { requestId, page, perPage, total, hasNext: offset + perPage < total };\r\n\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u6210\u529F\", data, meta }, corsHeaders);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// \u5DE5\u6642\u5217\u8868\uFF1A/internal/api/v1/timesheets\r\n\t\tif (path === \"/internal/api/v1/timesheets\") {\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok:false, code:\"UNAUTHORIZED\", message:\"\u672A\u767B\u5165\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method === \"GET\") {\r\n\t\t\t\ttry {\r\n\t\t\t\tconst params = url.searchParams;\r\n\t\t\t\tconst page = Math.max(1, parseInt(params.get(\"page\") || \"1\", 10));\r\n\t\t\t\tconst perPage = Math.min(100, Math.max(1, parseInt(params.get(\"perPage\") || \"50\", 10)));\r\n\t\t\t\tconst offset = (page - 1) * perPage;\r\n\t\t\t\tconst dateFrom = (params.get(\"dateFrom\") || \"\").trim();\r\n\t\t\t\tconst dateTo = (params.get(\"dateTo\") || \"\").trim();\r\n\t\t\t\tconst q = (params.get(\"q\") || \"\").trim();\r\n\t\t\t\tconst type = (params.get(\"type\") || \"\").trim();\r\n\t\t\t\tconst where = [\"t.is_deleted = 0\"];\r\n\t\t\t\tconst binds = [];\r\n\t\t\t\tif (!me.is_admin) { where.push(\"t.user_id = ?\"); binds.push(String(me.user_id)); }\r\n\t\t\t\tif (dateFrom) { where.push(\"t.work_date >= ?\"); binds.push(dateFrom); }\r\n\t\t\t\tif (dateTo) { where.push(\"t.work_date <= ?\"); binds.push(dateTo); }\r\n\t\t\t\tif (q) { where.push(\"(c.company_name LIKE ? OR t.service_name LIKE ? OR t.note LIKE ?)\"); binds.push(`%${q}%`, `%${q}%`, `%${q}%`); }\r\n\t\t\t\tif (type) { where.push(\"t.work_type = ?\"); binds.push(type); }\r\n\t\t\t\tconst whereSql = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\r\n\t\t\t\tconst countRow = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT COUNT(1) AS total FROM Timesheets t LEFT JOIN Clients c ON c.client_id = t.client_id ${whereSql}`\r\n\t\t\t\t).bind(...binds).first();\r\n\t\t\t\tconst total = Number(countRow?.total || 0);\r\n\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT t.timesheet_id, t.work_date, t.client_id, c.company_name AS client_name, t.service_name, t.work_type, t.hours, t.note\r\n\t\t\t\t\t FROM Timesheets t LEFT JOIN Clients c ON c.client_id = t.client_id\r\n\t\t\t\t\t ${whereSql}\r\n\t\t\t\t\t ORDER BY t.work_date DESC, t.timesheet_id DESC\r\n\t\t\t\t\t LIMIT ? OFFSET ?`\r\n\t\t\t\t).bind(...binds, perPage, offset).all();\r\n\t\t\t\tconst data = (rows?.results || []).map(r => ({\r\n\t\t\t\t\tid: String(r.timesheet_id),\r\n\t\t\t\t\tdate: r.work_date,\r\n\t\t\t\t\tclientId: r.client_id || null,\r\n\t\t\t\t\tclientName: r.client_name || \"\",\r\n\t\t\t\t\tservice: r.service_name || \"\",\r\n\t\t\t\t\ttype: r.work_type,\r\n\t\t\t\t\thours: Number(r.hours || 0),\r\n\t\t\t\t\tnote: r.note || \"\",\r\n\t\t\t\t}));\r\n\t\t\t\tconst meta = { requestId, page, perPage, total, hasNext: offset + perPage < total };\r\n\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u6210\u529F\", data, meta }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\tconst body = { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } };\r\n\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (method === \"POST\") {\r\n\t\t\t\tlet body;\r\n\t\t\t\ttry { body = await request.json(); } catch (_) {\r\n\t\t\t\t\treturn jsonResponse(400, { ok:false, code:\"BAD_REQUEST\", message:\"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t\tconst work_date = String(body?.work_date || \"\").trim();\r\n\t\t\t\tconst client_id = (body?.client_id || \"\").trim();\r\n\t\t\t\tconst service_name = String(body?.service_name || \"\").trim();\r\n\t\t\t\tconst work_type = String(body?.work_type || \"\").trim();\r\n\t\t\t\tconst hours = Number(body?.hours);\r\n\t\t\t\tconst note = (body?.note || \"\").trim();\r\n\t\t\t\tconst errors = [];\r\n\t\t\t\tif (!/^\\d{4}-\\d{2}-\\d{2}$/.test(work_date)) errors.push({ field:\"work_date\", message:\"\u65E5\u671F\u683C\u5F0F YYYY-MM-DD\" });\r\n\t\t\t\tif (!client_id) errors.push({ field:\"client_id\", message:\"\u5FC5\u586B\" });\r\n\t\t\t\tif (!service_name) errors.push({ field:\"service_name\", message:\"\u5FC5\u586B\" });\r\n\t\t\t\tif (!work_type) errors.push({ field:\"work_type\", message:\"\u5FC5\u586B\" });\r\n\t\t\t\tif (!Number.isFinite(hours) || hours <= 0) errors.push({ field:\"hours\", message:\"\u5FC5\u9808\u5927\u65BC 0\" });\r\n\t\t\t\tif (Math.abs(hours * 2 - Math.round(hours * 2)) > 1e-9) errors.push({ field:\"hours\", message:\"\u5FC5\u9808\u662F 0.5 \u7684\u500D\u6578\" });\r\n\t\t\t\tif (hours > 12) errors.push({ field:\"hours\", message:\"\u4E0D\u53EF\u8D85\u904E 12 \u5C0F\u6642\" });\r\n\t\t\t\tif (errors.length) return jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u8F38\u5165\u6709\u8AA4\", errors, meta:{ requestId } }, corsHeaders);\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// \u55AE\u65E5\u5408\u8A08\u4E0D\u5F97\u8D85\u904E 12\r\n\t\t\t\t\tconst sumRow = await env.DATABASE.prepare(\"SELECT COALESCE(SUM(hours),0) AS s FROM Timesheets WHERE user_id = ? AND work_date = ? AND is_deleted = 0\").bind(String(me.user_id), work_date).first();\r\n\t\t\t\t\tconst current = Number(sumRow?.s || 0);\r\n\t\t\t\t\tif (current + hours > 12 + 1e-9) {\r\n\t\t\t\t\t\treturn jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u6BCF\u65E5\u5DE5\u6642\u5408\u8A08\u4E0D\u53EF\u8D85\u904E 12 \u5C0F\u6642\", errors:[{ field:\"hours\", message:\"\u8D85\u904E\u4E0A\u9650\" }], meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO Timesheets (user_id, work_date, client_id, service_name, work_type, hours, note, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\"\r\n\t\t\t\t\t).bind(String(me.user_id), work_date, client_id, service_name, work_type, hours, note, new Date().toISOString(), new Date().toISOString()).run();\r\n\t\t\t\t\tconst idRow = await env.DATABASE.prepare(\"SELECT last_insert_rowid() AS id\").first();\r\n\t\t\t\t\tconst data = { id:String(idRow?.id), date:work_date, clientId:client_id, service:service_name, type:work_type, hours, note };\r\n\t\t\t\t\treturn jsonResponse(201, { ok:true, code:\"CREATED\", message:\"\u5DF2\u5EFA\u7ACB\", data, meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\tconst body = { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } }, corsHeaders);\r\n\t\t}\r\n\r\n\t\t// \u8ACB\u5047\u5217\u8868\uFF1A/internal/api/v1/leaves\r\n\t\tif (path === \"/internal/api/v1/leaves\") {\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok:false, code:\"UNAUTHORIZED\", message:\"\u672A\u767B\u5165\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method === \"GET\") {\r\n\t\t\t\ttry {\r\n\t\t\t\tconst params = url.searchParams;\r\n\t\t\t\tconst page = Math.max(1, parseInt(params.get(\"page\") || \"1\", 10));\r\n\t\t\t\tconst perPage = Math.min(100, Math.max(1, parseInt(params.get(\"perPage\") || \"20\", 10)));\r\n\t\t\t\tconst offset = (page - 1) * perPage;\r\n\t\t\t\tconst q = (params.get(\"q\") || \"\").trim();\r\n\t\t\t\tconst status = (params.get(\"status\") || \"\").trim();\r\n\t\t\t\tconst type = (params.get(\"type\") || \"\").trim();\r\n\t\t\t\tconst dateFrom = (params.get(\"dateFrom\") || \"\").trim();\r\n\t\t\t\tconst dateTo = (params.get(\"dateTo\") || \"\").trim();\r\n\t\t\t\tconst where = [\"l.is_deleted = 0\"];\r\n\t\t\t\tconst binds = [];\r\n\t\t\t\tif (!me.is_admin) { where.push(\"l.user_id = ?\"); binds.push(String(me.user_id)); }\r\n\t\t\t\tif (q) { where.push(\"(l.reason LIKE ? OR l.leave_type LIKE ?)\"); binds.push(`%${q}%`, `%${q}%`); }\r\n\t\t\t\tif (status && [\"pending\",\"approved\",\"rejected\"].includes(status)) { where.push(\"l.status = ?\"); binds.push(status); }\r\n\t\t\t\tif (type) { where.push(\"l.leave_type = ?\"); binds.push(type); }\r\n\t\t\t\tif (dateFrom) { where.push(\"l.start_date >= ?\"); binds.push(dateFrom); }\r\n\t\t\t\tif (dateTo) { where.push(\"l.end_date <= ?\"); binds.push(dateTo); }\r\n\t\t\t\tconst whereSql = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\r\n\t\t\t\tconst countRow = await env.DATABASE.prepare(`SELECT COUNT(1) AS total FROM LeaveRequests l ${whereSql}`).bind(...binds).first();\r\n\t\t\t\tconst total = Number(countRow?.total || 0);\r\n\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t`SELECT l.leave_id, l.leave_type, l.start_date, l.end_date, l.unit, l.amount, l.reason, l.status, l.submitted_at\r\n\t\t\t\t\t FROM LeaveRequests l\r\n\t\t\t\t\t ${whereSql}\r\n\t\t\t\t\t ORDER BY l.submitted_at DESC, l.leave_id DESC\r\n\t\t\t\t\t LIMIT ? OFFSET ?`\r\n\t\t\t\t).bind(...binds, perPage, offset).all();\r\n\t\t\t\tconst data = (rows?.results || []).map(r => ({\r\n\t\t\t\t\tleaveId: String(r.leave_id),\r\n\t\t\t\t\ttype: r.leave_type,\r\n\t\t\t\t\tstart: r.start_date,\r\n\t\t\t\t\tend: r.end_date,\r\n\t\t\t\t\tunit: r.unit,\r\n\t\t\t\t\tamount: Number(r.amount || 0),\r\n\t\t\t\t\treason: r.reason || \"\",\r\n\t\t\t\t\tstatus: r.status,\r\n\t\t\t\t\tsubmittedAt: r.submitted_at,\r\n\t\t\t\t}));\r\n\t\t\t\tconst meta = { requestId, page, perPage, total, hasNext: offset + perPage < total };\r\n\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u6210\u529F\", data, meta }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\tconst body = { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } };\r\n\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (method === \"POST\") {\r\n\t\t\t\tlet body;\r\n\t\t\t\ttry { body = await request.json(); } catch (_) {\r\n\t\t\t\t\treturn jsonResponse(400, { ok:false, code:\"BAD_REQUEST\", message:\"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t\tconst leave_type = String(body?.leave_type || \"\").trim();\r\n\t\t\t\tconst start_date = String(body?.start_date || \"\").trim();\r\n\t\t\t\tconst end_date = String(body?.end_date || \"\").trim();\r\n\t\t\t\tconst unit = String(body?.unit || \"day\").trim();\r\n\t\t\t\tconst amount = Number(body?.amount);\r\n\t\t\t\tconst reason = (body?.reason || \"\").trim();\r\n\t\t\t\tconst errors = [];\r\n\t\t\t\tif (!leave_type) errors.push({ field:\"leave_type\", message:\"\u5FC5\u9078\u5047\u5225\" });\r\n\t\t\t\tif (!/^\\d{4}-\\d{2}-\\d{2}$/.test(start_date)) errors.push({ field:\"start_date\", message:\"\u65E5\u671F\u683C\u5F0F YYYY-MM-DD\" });\r\n\t\t\t\tif (!/^\\d{4}-\\d{2}-\\d{2}$/.test(end_date)) errors.push({ field:\"end_date\", message:\"\u65E5\u671F\u683C\u5F0F YYYY-MM-DD\" });\r\n\t\t\t\tif (start_date && end_date && end_date < start_date) errors.push({ field:\"end_date\", message:\"\u7D50\u675F\u65E5\u671F\u4E0D\u53EF\u65E9\u65BC\u958B\u59CB\u65E5\u671F\" });\r\n\t\t\t\tif (![\"day\",\"half\",\"hour\"].includes(unit)) errors.push({ field:\"unit\", message:\"\u55AE\u4F4D\u932F\u8AA4\" });\r\n\t\t\t\tif (!Number.isFinite(amount) || amount <= 0) errors.push({ field:\"amount\", message:\"\u9700\u5927\u65BC 0\" });\r\n\t\t\t\tif (reason.length > 200) errors.push({ field:\"reason\", message:\"\u8ACB\u52FF\u8D85\u904E 200 \u5B57\" });\r\n\t\t\t\t// \u6027\u5225\u9650\u5236\uFF08\u793A\u610F\uFF09\r\n\t\t\t\tif ([\"maternity\",\"menstrual\"].includes(leave_type) && me.gender === 'M') errors.push({ field:\"leave_type\", message:\"\u6B64\u5047\u5225\u50C5\u9650\u5973\u6027\" });\r\n\t\t\t\tif (leave_type === 'paternity' && me.gender === 'F') errors.push({ field:\"leave_type\", message:\"\u6B64\u5047\u5225\u50C5\u9650\u7537\u6027\" });\r\n\t\t\t\tif (errors.length) return jsonResponse(422, { ok:false, code:\"VALIDATION_ERROR\", message:\"\u8F38\u5165\u6709\u8AA4\", errors, meta:{ requestId } }, corsHeaders);\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO LeaveRequests (user_id, leave_type, start_date, end_date, unit, amount, reason, status, submitted_at) VALUES (?, ?, ?, ?, ?, ?, ?, 'pending', datetime('now'))\"\r\n\t\t\t\t\t).bind(String(me.user_id), leave_type, start_date, end_date, unit, amount, reason).run();\r\n\t\t\t\t\tconst idRow = await env.DATABASE.prepare(\"SELECT last_insert_rowid() AS id\").first();\r\n\t\t\t\t\treturn jsonResponse(201, { ok:true, code:\"CREATED\", message:\"\u5DF2\u9001\u51FA\u5BE9\u6838\", data:{ leaveId:String(idRow?.id) }, meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } }, corsHeaders);\r\n\t\t}\r\n\r\n\t\t// \u5047\u671F\u9918\u984D\uFF1A/internal/api/v1/leaves/balances?year=YYYY\r\n\t\tif (path === \"/internal/api/v1/leaves/balances\") {\r\n\t\t\tconst me = await getSessionUser(request, env);\r\n\t\t\tif (!me) {\r\n\t\t\t\treturn jsonResponse(401, { ok:false, code:\"UNAUTHORIZED\", message:\"\u672A\u767B\u5165\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t\tconst corsHeaders = getCorsHeadersForRequest(request, env);\r\n\t\t\tif (method !== \"GET\") {\r\n\t\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } }, corsHeaders);\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst params = url.searchParams; const year = parseInt(params.get(\"year\") || String(new Date().getFullYear()), 10);\r\n\t\t\t\tconst rows = await env.DATABASE.prepare(\r\n\t\t\t\t\t\"SELECT leave_type, year, total, used, remain FROM LeaveBalances WHERE user_id = ? AND year = ?\"\r\n\t\t\t\t).bind(String(me.user_id), year).all();\r\n\t\t\t\tconst data = (rows?.results || []).map(r => ({ type: r.leave_type, year: Number(r.year), total: Number(r.total), used: Number(r.used), remain: Number(r.remain) }));\r\n\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u6210\u529F\", data, meta:{ requestId, year } }, corsHeaders);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u7528\u6236\uFF08\u50C5\u975E prod \u74B0\u5883\u53EF\u7528\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-user\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok: false, code: \"NOT_FOUND\", message: \"\u4E0D\u5B58\u5728\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tlet body;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tbody = await request.json();\r\n\t\t\t\t} catch (_) {\r\n\t\t\t\t\treturn jsonResponse(400, { ok: false, code: \"BAD_REQUEST\", message: \"\u8ACB\u6C42\u683C\u5F0F\u932F\u8AA4\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t\tconst username = (body?.username || \"\").trim().toLowerCase();\r\n\t\t\t\tconst name = (body?.name || \"\u6E2C\u8A66\u7528\u6236\").trim();\r\n\t\t\t\tconst password = body?.password || \"changeme\";\r\n\t\t\t\tlet email = (body?.email || \"\").trim();\r\n\t\t\t\tif (!username || !password) {\r\n\t\t\t\t\treturn jsonResponse(422, { ok: false, code: \"VALIDATION_ERROR\", message: \"username/password \u5FC5\u586B\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t\tif (!env.DATABASE) {\r\n\t\t\t\t\treturn jsonResponse(500, { ok: false, code: \"INTERNAL_ERROR\", message: \"\u8CC7\u6599\u5EAB\u672A\u7D81\u5B9A\", meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst exists = await env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"SELECT user_id FROM Users WHERE LOWER(username) = ? LIMIT 1\"\r\n\t\t\t\t\t).bind(username).first();\r\n\t\t\t\t\tif (!email) email = `${username}@example.com`;\r\n\t\t\t\t\tconst passwordHash = await hashPasswordPBKDF2(password);\r\n\t\t\t\t\tif (exists) {\r\n\t\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\t\"UPDATE Users SET username = ?, name = ?, email = ?, password_hash = ?, updated_at = ? WHERE user_id = ?\"\r\n\t\t\t\t\t\t).bind(username, name, email, passwordHash, new Date().toISOString(), exists.user_id).run();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\t\"INSERT INTO Users (username, password_hash, name, email, gender, start_date, created_at, updated_at) VALUES (?, ?, ?, ?, 'M', date('now'), datetime('now'), datetime('now'))\"\r\n\t\t\t\t\t\t).bind(username, passwordHash, name, email).run();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u5DF2\u5EFA\u7ACB/\u66F4\u65B0\u6E2C\u8A66\u7528\u6236\", data: { username, email }, meta: { requestId } }, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body, getCorsHeadersForRequest(request, env));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u7528 Clients \u8207 Tags\uFF08\u50C5\u975E prod\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-clients\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok: false, code: \"NOT_FOUND\", message: \"\u4E0D\u5B58\u5728\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// \u5169\u500B\u57FA\u672C\u6A19\u7C64\r\n\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT OR IGNORE INTO CustomerTags(tag_id, tag_name, tag_color) VALUES (1,'\u4E00\u822C','#3b5bdb'),(2,'VIP','#ef4444')\").run();\r\n\t\t\t\t\t// \u4E09\u7B46\u5BA2\u6236\uFF08\u82E5\u4E0D\u5B58\u5728\uFF09\r\n\t\t\t\t\tconst now = new Date().toISOString();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT OR IGNORE INTO Clients(client_id, company_name, tax_registration_number, assignee_user_id, phone, email, created_at, updated_at) VALUES \" +\r\n\t\t\t\t\t\t\"('c_001','\u661F\u6CB3\u8CC7\u8A0A\u80A1\u4EFD\u6709\u9650\u516C\u53F8','12345678',1,'02-1234-5678','contact@galaxy.com',?,?),\" +\r\n\t\t\t\t\t\t\"('c_002','\u677E\u67CF\u6709\u9650\u516C\u53F8','87654321',1,'02-8765-4321','service@pine.com',?,?),\" +\r\n\t\t\t\t\t\t\"('c_003','\u5B89\u548C\u9867\u554F\u80A1\u4EFD\u6709\u9650\u516C\u53F8','11223344',1,'02-5566-7788','info@anhe.com',?,?)\"\r\n\t\t\t\t\t).bind(now, now, now, now, now, now).run();\r\n\t\t\t\t\t// \u6307\u6D3E\u6A19\u7C64\r\n\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT OR IGNORE INTO ClientTagAssignments(client_id, tag_id) VALUES ('c_001',1),('c_001',2),('c_002',2),('c_003',1)\").run();\r\n\t\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u5DF2\u5EFA\u7ACB\u6E2C\u8A66\u5BA2\u6236/\u6A19\u7C64\", meta: { requestId } });\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u4EFB\u52D9\uFF08\u50C5\u975E prod\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-tasks\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok: false, code: \"NOT_FOUND\", message: \"\u4E0D\u5B58\u5728\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok: false, code: \"METHOD_NOT_ALLOWED\", message: \"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta: { requestId } });\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// \u5EFA\u7ACB\u5C0D\u61C9\u7684 ClientServices\r\n\t\t\t\t\tawait env.DATABASE.prepare(\"INSERT OR IGNORE INTO ClientServices(client_id, service_id, status) VALUES ('c_001',1,'active'),('c_002',1,'active'),('c_003',1,'active')\").run();\r\n\t\t\t\t\t// \u53D6\u56DE id\r\n\t\t\t\t\tconst cs1 = await env.DATABASE.prepare(\"SELECT client_service_id FROM ClientServices WHERE client_id='c_001' LIMIT 1\").first();\r\n\t\t\t\t\tconst cs2 = await env.DATABASE.prepare(\"SELECT client_service_id FROM ClientServices WHERE client_id='c_002' LIMIT 1\").first();\r\n\t\t\t\t\tconst cs3 = await env.DATABASE.prepare(\"SELECT client_service_id FROM ClientServices WHERE client_id='c_003' LIMIT 1\").first();\r\n\t\t\t\t\tconst today = new Date();\r\n\t\t\t\t\tconst fmt = (d)=> new Date(today.getTime()+d*86400000).toISOString().slice(0,10);\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO ActiveTasks (client_service_id, task_name, due_date, status, assignee_user_id, created_at) VALUES (?,?,?,?,?,datetime('now'))\"\r\n\t\t\t\t\t).bind(cs1.client_service_id, '\u661F\u6CB3\u8CC7\u8A0A \u2212 12 \u6708\u8A18\u5E33', fmt(2), 'pending', 1).run();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO ActiveTasks (client_service_id, task_name, due_date, status, assignee_user_id, created_at) VALUES (?,?,?,?,?,datetime('now'))\"\r\n\t\t\t\t\t).bind(cs2.client_service_id, '\u677E\u67CF \u2212 12 \u6708\u71DF\u696D\u7A05', fmt(-1), 'in_progress', 1).run();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO ActiveTasks (client_service_id, task_name, due_date, status, assignee_user_id, created_at) VALUES (?,?,?,?,?,datetime('now'))\"\r\n\t\t\t\t\t).bind(cs3.client_service_id, '\u5B89\u548C \u2212 \u5E74\u5EA6\u7D50\u7B97', fmt(10), 'completed', 1).run();\r\n\t\t\t\t\treturn jsonResponse(200, { ok: true, code: \"OK\", message: \"\u5DF2\u5EFA\u7ACB\u6E2C\u8A66\u4EFB\u52D9\", meta: { requestId } });\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level: \"error\", requestId, path, err: String(err) }));\r\n\t\t\t\t\tconst body = { ok: false, code: \"INTERNAL_ERROR\", message: \"\u4F3A\u670D\u5668\u932F\u8AA4\", meta: { requestId } };\r\n\t\t\t\t\tif (env.APP_ENV && env.APP_ENV !== \"prod\") body.error = String(err);\r\n\t\t\t\t\treturn jsonResponse(500, body);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u5DE5\u6642\uFF08\u50C5\u975E prod\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-timesheets\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok:false, code:\"NOT_FOUND\", message:\"\u4E0D\u5B58\u5728\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst today = new Date();\r\n\t\t\t\t\tconst d = (off)=> new Date(today.getTime()+off*86400000).toISOString().slice(0,10);\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO Timesheets (user_id, work_date, client_id, service_name, work_type, hours, note) VALUES \"+\r\n\t\t\t\t\t\t\"(1, ?, 'c_001', '\u8A18\u5E33', 'normal', 2.5, ''),\"+\r\n\t\t\t\t\t\t\"(1, ?, 'c_002', '\u71DF\u696D\u7A05', 'ot-weekday', 1.0, '\u52A0\u73ED'),\"+\r\n\t\t\t\t\t\t\"(1, ?, 'c_003', '\u7D50\u7B97', 'normal', 3.0, '\u6574\u7406')\"\r\n\t\t\t\t\t).bind(d(-2), d(-1), d(0)).run();\r\n\t\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u5DF2\u5EFA\u7ACB\u6E2C\u8A66\u5DE5\u6642\", meta:{ requestId } });\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u8ACB\u5047\u8207\u9918\u984D\uFF08\u50C5\u975E prod\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-leaves\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok:false, code:\"NOT_FOUND\", message:\"\u4E0D\u5B58\u5728\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst y = new Date().getFullYear();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT OR REPLACE INTO LeaveBalances(user_id, leave_type, year, total, used, remain, updated_at) VALUES \"+\r\n\t\t\t\t\t\t\"(1,'annual',?,30,3,27,datetime('now')),\"+\r\n\t\t\t\t\t\t\"(1,'sick',?,30,1,29,datetime('now')),\"+\r\n\t\t\t\t\t\t\"(1,'comp',?,24,16,8,datetime('now'))\"\r\n\t\t\t\t\t).bind(y, y, y).run();\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT INTO LeaveRequests (user_id, leave_type, start_date, end_date, unit, amount, reason, status, submitted_at) VALUES \"+\r\n\t\t\t\t\t\t\"(1,'annual',date('now','-10 day'),date('now','-10 day'),'day',1,'', 'approved', datetime('now','-10 day')),\"+\r\n\t\t\t\t\t\t\"(1,'sick',date('now','-25 day'),date('now','-25 day'),'half',0.5,'\u770B\u91AB\u751F','approved', datetime('now','-25 day')),\"+\r\n\t\t\t\t\t\t\"(1,'comp',date('now','-5 day'),date('now','-5 day'),'hour',2,'\u52A0\u73ED\u88DC\u4F11','pending', datetime('now','-5 day'))\"\r\n\t\t\t\t\t).run();\r\n\t\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u5DF2\u5EFA\u7ACB\u5047\u671F\u9918\u984D\u8207\u7533\u8ACB\u8CC7\u6599\", meta:{ requestId, year:y } });\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// DEV \u5C08\u7528\uFF1A\u5EFA\u7ACB\u6E2C\u8A66\u6536\u64DA\uFF08\u50C5\u975E prod\uFF09\r\n\t\t\tif (path === \"/internal/api/v1/admin/dev-seed-receipts\") {\r\n\t\t\t\tif (env.APP_ENV === \"prod\") {\r\n\t\t\t\t\treturn jsonResponse(404, { ok:false, code:\"NOT_FOUND\", message:\"\u4E0D\u5B58\u5728\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\tif (method !== \"POST\") {\r\n\t\t\t\t\treturn jsonResponse(405, { ok:false, code:\"METHOD_NOT_ALLOWED\", message:\"\u65B9\u6CD5\u4E0D\u5141\u8A31\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait env.DATABASE.prepare(\r\n\t\t\t\t\t\t\"INSERT OR IGNORE INTO Receipts (receipt_id, client_id, receipt_date, due_date, total_amount, status, is_auto_generated, created_by) VALUES \"+\r\n\t\t\t\t\t\t\"('202510-001','c_001','2025-10-01','2025-10-31',12000,'paid',1,1),\"+\r\n\t\t\t\t\t\t\"('202510-002','c_002','2025-10-10','2025-10-30',8000,'unpaid',1,1),\"+\r\n\t\t\t\t\t\t\"('202509-003','c_003','2025-09-20','2025-10-05',5000,'unpaid',1,1)\"\r\n\t\t\t\t\t).run();\r\n\t\t\t\t\treturn jsonResponse(200, { ok:true, code:\"OK\", message:\"\u5DF2\u5EFA\u7ACB\u6E2C\u8A66\u6536\u64DA\", meta:{ requestId } });\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(JSON.stringify({ level:\"error\", requestId, path, err:String(err) }));\r\n\t\t\t\t\treturn jsonResponse(500, { ok:false, code:\"INTERNAL_ERROR\", message:\"\u4F3A\u670D\u5668\u932F\u8AA4\", meta:{ requestId } });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t// API \u4EE3\u7406\uFF1A/internal/api/* \u2192 <INTERNAL_API_HOST>/api/*\r\n\t\tif (path.startsWith(\"/internal/api/\")) {\r\n\t\t\treturn proxy(env.INTERNAL_API_HOST, path.replace(\"/internal\", \"\"));\r\n\t\t}\r\n\r\n\t\t// \u767B\u5165\u9801\uFF1A/login \u2192 <INTERNAL_BASE_HOST>/login\r\n\t\tif (path === \"/login\" || path.startsWith(\"/login/\")) {\r\n\t\t\treturn proxy(env.INTERNAL_BASE_HOST, \"/login\");\r\n\t\t}\r\n\r\n\t\t// \u5176\u4ED6\u5167\u90E8\u9801\u9762\uFF1A/internal/* \u2192 \u9700\u8981\u767B\u5165\uFF0C\u5426\u5247\u5C0E\u5411 /login\r\n\t\tif (path.startsWith(\"/internal/\")) {\r\n\t\t\tconst row = await getSessionUser(request, env);\r\n\t\t\tif (!row) {\r\n\t\t\t\tconst location = `/login?redirect=${encodeURIComponent(path)}`;\r\n\t\t\t\treturn new Response(null, { status: 302, headers: { Location: location } });\r\n\t\t\t}\r\n\t\t\treturn proxy(env.INTERNAL_BASE_HOST, path.replace(\"/internal\", \"\"));\r\n\t\t}\r\n\r\n\t\t// \u672A\u5339\u914D\u8DEF\u5F91\uFF08\u7406\u8AD6\u4E0A\u4E0D\u6703\u56E0\u70BA routes \u53EA\u7D81\u5B9A\u7279\u5B9A\u8DEF\u5F91\uFF09\r\n\t\treturn fetch(request);\r\n\t},\r\n};\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"C:\\\\Users\\\\miama\\\\Desktop\\\\horgoscpa\\\\cloudflare\\\\worker-router\\\\src\\\\index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\miama\\\\AppData\\\\Local\\\\npm-cache\\\\_npx\\\\d77349f55c2be1c0\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\miama\\\\AppData\\\\Local\\\\npm-cache\\\\_npx\\\\d77349f55c2be1c0\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"C:\\\\Users\\\\miama\\\\Desktop\\\\horgoscpa\\\\cloudflare\\\\worker-router\\\\src\\\\index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"C:\\\\Users\\\\miama\\\\Desktop\\\\horgoscpa\\\\cloudflare\\\\worker-router\\\\.wrangler\\\\tmp\\\\bundle-baIFTX\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\miama\\\\AppData\\\\Local\\\\npm-cache\\\\_npx\\\\d77349f55c2be1c0\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"C:\\\\Users\\\\miama\\\\Desktop\\\\horgoscpa\\\\cloudflare\\\\worker-router\\\\.wrangler\\\\tmp\\\\bundle-baIFTX\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"C:\\\\Users\\\\miama\\\\Desktop\\\\horgoscpa\\\\cloudflare\\\\worker-router\\\\.wrangler\\\\tmp\\\\bundle-baIFTX\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["body"]
}
